/*!
 * jQuery UI 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
(function(c,j){function k(a){return!c(a).parents().andSelf().filter(function(){return c.curCSS(this,"visibility")==="hidden"||c.expr.filters.hidden(this)}).length}c.ui=c.ui||{};if(!c.ui.version){c.extend(c.ui,{version:"1.8.11",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,
NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}});c.fn.extend({_focus:c.fn.focus,focus:function(a,b){return typeof a==="number"?this.each(function(){var d=this;setTimeout(function(){c(d).focus();b&&b.call(d)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;a=c.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(c.curCSS(this,
"position",1))&&/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(c.curCSS(this,"overflow",1)+c.curCSS(this,"overflow-y",1)+c.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!a.length?c(document):a},zIndex:function(a){if(a!==j)return this.css("zIndex",a);if(this.length){a=c(this[0]);for(var b;a.length&&a[0]!==document;){b=a.css("position");
if(b==="absolute"||b==="relative"||b==="fixed"){b=parseInt(a.css("zIndex"),10);if(!isNaN(b)&&b!==0)return b}a=a.parent()}}return 0},disableSelection:function(){return this.bind((c.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});c.each(["Width","Height"],function(a,b){function d(f,g,l,m){c.each(e,function(){g-=parseFloat(c.curCSS(f,"padding"+this,true))||0;if(l)g-=parseFloat(c.curCSS(f,
"border"+this+"Width",true))||0;if(m)g-=parseFloat(c.curCSS(f,"margin"+this,true))||0});return g}var e=b==="Width"?["Left","Right"]:["Top","Bottom"],h=b.toLowerCase(),i={innerWidth:c.fn.innerWidth,innerHeight:c.fn.innerHeight,outerWidth:c.fn.outerWidth,outerHeight:c.fn.outerHeight};c.fn["inner"+b]=function(f){if(f===j)return i["inner"+b].call(this);return this.each(function(){c(this).css(h,d(this,f)+"px")})};c.fn["outer"+b]=function(f,g){if(typeof f!=="number")return i["outer"+b].call(this,f);return this.each(function(){c(this).css(h,
d(this,f,true,g)+"px")})}});c.extend(c.expr[":"],{data:function(a,b,d){return!!c.data(a,d[3])},focusable:function(a){var b=a.nodeName.toLowerCase(),d=c.attr(a,"tabindex");if("area"===b){b=a.parentNode;d=b.name;if(!a.href||!d||b.nodeName.toLowerCase()!=="map")return false;a=c("img[usemap=#"+d+"]")[0];return!!a&&k(a)}return(/input|select|textarea|button|object/.test(b)?!a.disabled:"a"==b?a.href||!isNaN(d):!isNaN(d))&&k(a)},tabbable:function(a){var b=c.attr(a,"tabindex");return(isNaN(b)||b>=0)&&c(a).is(":focusable")}});
c(function(){var a=document.body,b=a.appendChild(b=document.createElement("div"));c.extend(b.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0});c.support.minHeight=b.offsetHeight===100;c.support.selectstart="onselectstart"in b;a.removeChild(b).style.display="none"});c.extend(c.ui,{plugin:{add:function(a,b,d){a=c.ui[a].prototype;for(var e in d){a.plugins[e]=a.plugins[e]||[];a.plugins[e].push([b,d[e]])}},call:function(a,b,d){if((b=a.plugins[b])&&a.element[0].parentNode)for(var e=0;e<b.length;e++)a.options[b[e][0]]&&
b[e][1].apply(a.element,d)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(a,b){if(c(a).css("overflow")==="hidden")return false;b=b&&b==="left"?"scrollLeft":"scrollTop";var d=false;if(a[b]>0)return true;a[b]=1;d=a[b]>0;a[b]=0;return d},isOverAxis:function(a,b,d){return a>b&&a<b+d},isOver:function(a,b,d,e,h,i){return c.ui.isOverAxis(a,d,h)&&c.ui.isOverAxis(b,e,i)}})}})(jQuery);
;/*!
 * jQuery UI Widget 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(b,j){if(b.cleanData){var k=b.cleanData;b.cleanData=function(a){for(var c=0,d;(d=a[c])!=null;c++)b(d).triggerHandler("remove");k(a)}}else{var l=b.fn.remove;b.fn.remove=function(a,c){return this.each(function(){if(!c)if(!a||b.filter(a,[this]).length)b("*",this).add([this]).each(function(){b(this).triggerHandler("remove")});return l.call(b(this),a,c)})}}b.widget=function(a,c,d){var e=a.split(".")[0],f;a=a.split(".")[1];f=e+"-"+a;if(!d){d=c;c=b.Widget}b.expr[":"][f]=function(h){return!!b.data(h,
a)};b[e]=b[e]||{};b[e][a]=function(h,g){arguments.length&&this._createWidget(h,g)};c=new c;c.options=b.extend(true,{},c.options);b[e][a].prototype=b.extend(true,c,{namespace:e,widgetName:a,widgetEventPrefix:b[e][a].prototype.widgetEventPrefix||a,widgetBaseClass:f},d);b.widget.bridge(a,b[e][a])};b.widget.bridge=function(a,c){b.fn[a]=function(d){var e=typeof d==="string",f=Array.prototype.slice.call(arguments,1),h=this;d=!e&&f.length?b.extend.apply(null,[true,d].concat(f)):d;if(e&&d.charAt(0)==="_")return h;
e?this.each(function(){var g=b.data(this,a),i=g&&b.isFunction(g[d])?g[d].apply(g,f):g;if(i!==g&&i!==j){h=i;return false}}):this.each(function(){var g=b.data(this,a);g?g.option(d||{})._init():b.data(this,a,new c(d,this))});return h}};b.Widget=function(a,c){arguments.length&&this._createWidget(a,c)};b.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:false},_createWidget:function(a,c){b.data(c,this.widgetName,this);this.element=b(c);this.options=b.extend(true,{},this.options,
this._getCreateOptions(),a);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()});this._create();this._trigger("create");this._init()},_getCreateOptions:function(){return b.metadata&&b.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName);this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},
widget:function(){return this.element},option:function(a,c){var d=a;if(arguments.length===0)return b.extend({},this.options);if(typeof a==="string"){if(c===j)return this.options[a];d={};d[a]=c}this._setOptions(d);return this},_setOptions:function(a){var c=this;b.each(a,function(d,e){c._setOption(d,e)});return this},_setOption:function(a,c){this.options[a]=c;if(a==="disabled")this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",c);return this},
enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_trigger:function(a,c,d){var e=this.options[a];c=b.Event(c);c.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase();d=d||{};if(c.originalEvent){a=b.event.props.length;for(var f;a;){f=b.event.props[--a];c[f]=c.originalEvent[f]}}this.element.trigger(c,d);return!(b.isFunction(e)&&e.call(this.element[0],c,d)===false||c.isDefaultPrevented())}}})(jQuery);
;/*!
 * jQuery UI Mouse 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */
(function(b){b.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(c){return a._mouseDown(c)}).bind("click."+this.widgetName,function(c){if(true===b.data(c.target,a.widgetName+".preventClickEvent")){b.removeData(c.target,a.widgetName+".preventClickEvent");c.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(a){a.originalEvent=
a.originalEvent||{};if(!a.originalEvent.mouseHandled){this._mouseStarted&&this._mouseUp(a);this._mouseDownEvent=a;var c=this,e=a.which==1,f=typeof this.options.cancel=="string"?b(a.target).parents().add(a.target).filter(this.options.cancel).length:false;if(!e||f||!this._mouseCapture(a))return true;this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet)this._mouseDelayTimer=setTimeout(function(){c.mouseDelayMet=true},this.options.delay);if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=
this._mouseStart(a)!==false;if(!this._mouseStarted){a.preventDefault();return true}}true===b.data(a.target,this.widgetName+".preventClickEvent")&&b.removeData(a.target,this.widgetName+".preventClickEvent");this._mouseMoveDelegate=function(d){return c._mouseMove(d)};this._mouseUpDelegate=function(d){return c._mouseUp(d)};b(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);a.preventDefault();return a.originalEvent.mouseHandled=
true}},_mouseMove:function(a){if(b.browser.msie&&!(document.documentMode>=9)&&!a.button)return this._mouseUp(a);if(this._mouseStarted){this._mouseDrag(a);return a.preventDefault()}if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a))(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==false)?this._mouseDrag(a):this._mouseUp(a);return!this._mouseStarted},_mouseUp:function(a){b(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);
if(this._mouseStarted){this._mouseStarted=false;a.target==this._mouseDownEvent.target&&b.data(a.target,this.widgetName+".preventClickEvent",true);this._mouseStop(a)}return false},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);
;/*
 * jQuery UI Position 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */
(function(c){c.ui=c.ui||{};var n=/left|center|right/,o=/top|center|bottom/,t=c.fn.position,u=c.fn.offset;c.fn.position=function(b){if(!b||!b.of)return t.apply(this,arguments);b=c.extend({},b);var a=c(b.of),d=a[0],g=(b.collision||"flip").split(" "),e=b.offset?b.offset.split(" "):[0,0],h,k,j;if(d.nodeType===9){h=a.width();k=a.height();j={top:0,left:0}}else if(d.setTimeout){h=a.width();k=a.height();j={top:a.scrollTop(),left:a.scrollLeft()}}else if(d.preventDefault){b.at="left top";h=k=0;j={top:b.of.pageY,
left:b.of.pageX}}else{h=a.outerWidth();k=a.outerHeight();j=a.offset()}c.each(["my","at"],function(){var f=(b[this]||"").split(" ");if(f.length===1)f=n.test(f[0])?f.concat(["center"]):o.test(f[0])?["center"].concat(f):["center","center"];f[0]=n.test(f[0])?f[0]:"center";f[1]=o.test(f[1])?f[1]:"center";b[this]=f});if(g.length===1)g[1]=g[0];e[0]=parseInt(e[0],10)||0;if(e.length===1)e[1]=e[0];e[1]=parseInt(e[1],10)||0;if(b.at[0]==="right")j.left+=h;else if(b.at[0]==="center")j.left+=h/2;if(b.at[1]==="bottom")j.top+=
k;else if(b.at[1]==="center")j.top+=k/2;j.left+=e[0];j.top+=e[1];return this.each(function(){var f=c(this),l=f.outerWidth(),m=f.outerHeight(),p=parseInt(c.curCSS(this,"marginLeft",true))||0,q=parseInt(c.curCSS(this,"marginTop",true))||0,v=l+p+(parseInt(c.curCSS(this,"marginRight",true))||0),w=m+q+(parseInt(c.curCSS(this,"marginBottom",true))||0),i=c.extend({},j),r;if(b.my[0]==="right")i.left-=l;else if(b.my[0]==="center")i.left-=l/2;if(b.my[1]==="bottom")i.top-=m;else if(b.my[1]==="center")i.top-=
m/2;i.left=Math.round(i.left);i.top=Math.round(i.top);r={left:i.left-p,top:i.top-q};c.each(["left","top"],function(s,x){c.ui.position[g[s]]&&c.ui.position[g[s]][x](i,{targetWidth:h,targetHeight:k,elemWidth:l,elemHeight:m,collisionPosition:r,collisionWidth:v,collisionHeight:w,offset:e,my:b.my,at:b.at})});c.fn.bgiframe&&f.bgiframe();f.offset(c.extend(i,{using:b.using}))})};c.ui.position={fit:{left:function(b,a){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();b.left=
d>0?b.left-d:Math.max(b.left-a.collisionPosition.left,b.left)},top:function(b,a){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();b.top=d>0?b.top-d:Math.max(b.top-a.collisionPosition.top,b.top)}},flip:{left:function(b,a){if(a.at[0]!=="center"){var d=c(window);d=a.collisionPosition.left+a.collisionWidth-d.width()-d.scrollLeft();var g=a.my[0]==="left"?-a.elemWidth:a.my[0]==="right"?a.elemWidth:0,e=a.at[0]==="left"?a.targetWidth:-a.targetWidth,h=-2*a.offset[0];b.left+=
a.collisionPosition.left<0?g+e+h:d>0?g+e+h:0}},top:function(b,a){if(a.at[1]!=="center"){var d=c(window);d=a.collisionPosition.top+a.collisionHeight-d.height()-d.scrollTop();var g=a.my[1]==="top"?-a.elemHeight:a.my[1]==="bottom"?a.elemHeight:0,e=a.at[1]==="top"?a.targetHeight:-a.targetHeight,h=-2*a.offset[1];b.top+=a.collisionPosition.top<0?g+e+h:d>0?g+e+h:0}}}};if(!c.offset.setOffset){c.offset.setOffset=function(b,a){if(/static/.test(c.curCSS(b,"position")))b.style.position="relative";var d=c(b),
g=d.offset(),e=parseInt(c.curCSS(b,"top",true),10)||0,h=parseInt(c.curCSS(b,"left",true),10)||0;g={top:a.top-g.top+e,left:a.left-g.left+h};"using"in a?a.using.call(b,g):d.css(g)};c.fn.offset=function(b){var a=this[0];if(!a||!a.ownerDocument)return null;if(b)return this.each(function(){c.offset.setOffset(this,b)});return u.call(this)}}})(jQuery);
;/*
 * jQuery UI Draggable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(d){d.widget("ui.draggable",d.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false},_create:function(){if(this.options.helper==
"original"&&!/^(?:r|a|f)/.test(this.element.css("position")))this.element[0].style.position="relative";this.options.addClasses&&this.element.addClass("ui-draggable");this.options.disabled&&this.element.addClass("ui-draggable-disabled");this._mouseInit()},destroy:function(){if(this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy();return this}},_mouseCapture:function(a){var b=
this.options;if(this.helper||b.disabled||d(a.target).is(".ui-resizable-handle"))return false;this.handle=this._getHandle(a);if(!this.handle)return false;return true},_mouseStart:function(a){var b=this.options;this.helper=this._createHelper(a);this._cacheHelperProportions();if(d.ui.ddmanager)d.ui.ddmanager.current=this;this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-
this.margins.top,left:this.offset.left-this.margins.left};d.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(a);this.originalPageX=a.pageX;this.originalPageY=a.pageY;b.cursorAt&&this._adjustOffsetFromHelper(b.cursorAt);b.containment&&this._setContainment();if(this._trigger("start",a)===false){this._clear();return false}this._cacheHelperProportions();
d.ui.ddmanager&&!b.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a);this.helper.addClass("ui-draggable-dragging");this._mouseDrag(a,true);return true},_mouseDrag:function(a,b){this.position=this._generatePosition(a);this.positionAbs=this._convertPositionTo("absolute");if(!b){b=this._uiHash();if(this._trigger("drag",a,b)===false){this._mouseUp({});return false}this.position=b.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||
this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";d.ui.ddmanager&&d.ui.ddmanager.drag(this,a);return false},_mouseStop:function(a){var b=false;if(d.ui.ddmanager&&!this.options.dropBehaviour)b=d.ui.ddmanager.drop(this,a);if(this.dropped){b=this.dropped;this.dropped=false}if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return false;if(this.options.revert=="invalid"&&!b||this.options.revert=="valid"&&b||this.options.revert===true||d.isFunction(this.options.revert)&&
this.options.revert.call(this.element,b)){var c=this;d(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",a)!==false&&c._clear()})}else this._trigger("stop",a)!==false&&this._clear();return false},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(a){var b=!this.options.handle||!d(this.options.handle,this.element).length?true:false;d(this.options.handle,this.element).find("*").andSelf().each(function(){if(this==
a.target)b=true});return b},_createHelper:function(a){var b=this.options;a=d.isFunction(b.helper)?d(b.helper.apply(this.element[0],[a])):b.helper=="clone"?this.element.clone():this.element;a.parents("body").length||a.appendTo(b.appendTo=="parent"?this.element[0].parentNode:b.appendTo);a[0]!=this.element[0]&&!/(fixed|absolute)/.test(a.css("position"))&&a.css("position","absolute");return a},_adjustOffsetFromHelper:function(a){if(typeof a=="string")a=a.split(" ");if(d.isArray(a))a={left:+a[0],top:+a[1]||
0};if("left"in a)this.offset.click.left=a.left+this.margins.left;if("right"in a)this.offset.click.left=this.helperProportions.width-a.right+this.margins.left;if("top"in a)this.offset.click.top=a.top+this.margins.top;if("bottom"in a)this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();if(this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],
this.offsetParent[0])){a.left+=this.scrollParent.scrollLeft();a.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&d.browser.msie)a={top:0,left:0};return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-
(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;if(a.containment=="parent")a.containment=this.helper[0].parentNode;if(a.containment=="document"||a.containment=="window")this.containment=[(a.containment=="document"?0:d(window).scrollLeft())-this.offset.relative.left-this.offset.parent.left,(a.containment=="document"?0:d(window).scrollTop())-this.offset.relative.top-this.offset.parent.top,(a.containment=="document"?0:d(window).scrollLeft())+d(a.containment=="document"?
document:window).width()-this.helperProportions.width-this.margins.left,(a.containment=="document"?0:d(window).scrollTop())+(d(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(a.containment)&&a.containment.constructor!=Array){var b=d(a.containment)[0];if(b){a=d(a.containment).offset();var c=d(b).css("overflow")!="hidden";this.containment=[a.left+(parseInt(d(b).css("borderLeftWidth"),
10)||0)+(parseInt(d(b).css("paddingLeft"),10)||0),a.top+(parseInt(d(b).css("borderTopWidth"),10)||0)+(parseInt(d(b).css("paddingTop"),10)||0),a.left+(c?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(d(b).css("borderLeftWidth"),10)||0)-(parseInt(d(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,a.top+(c?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(d(b).css("borderTopWidth"),10)||0)-(parseInt(d(b).css("paddingBottom"),
10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom]}}else if(a.containment.constructor==Array)this.containment=a.containment},_convertPositionTo:function(a,b){if(!b)b=this.position;a=a=="absolute"?1:-1;var c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName);return{top:b.top+this.offset.relative.top*a+this.offset.parent.top*a-(d.browser.safari&&
d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop())*a),left:b.left+this.offset.relative.left*a+this.offset.parent.left*a-(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():f?0:c.scrollLeft())*a)}},_generatePosition:function(a){var b=this.options,c=this.cssPosition=="absolute"&&!(this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],
this.offsetParent[0]))?this.offsetParent:this.scrollParent,f=/(html|body)/i.test(c[0].tagName),e=a.pageX,g=a.pageY;if(this.originalPosition){if(this.containment){if(a.pageX-this.offset.click.left<this.containment[0])e=this.containment[0]+this.offset.click.left;if(a.pageY-this.offset.click.top<this.containment[1])g=this.containment[1]+this.offset.click.top;if(a.pageX-this.offset.click.left>this.containment[2])e=this.containment[2]+this.offset.click.left;if(a.pageY-this.offset.click.top>this.containment[3])g=
this.containment[3]+this.offset.click.top}if(b.grid){g=this.originalPageY+Math.round((g-this.originalPageY)/b.grid[1])*b.grid[1];g=this.containment?!(g-this.offset.click.top<this.containment[1]||g-this.offset.click.top>this.containment[3])?g:!(g-this.offset.click.top<this.containment[1])?g-b.grid[1]:g+b.grid[1]:g;e=this.originalPageX+Math.round((e-this.originalPageX)/b.grid[0])*b.grid[0];e=this.containment?!(e-this.offset.click.left<this.containment[0]||e-this.offset.click.left>this.containment[2])?
e:!(e-this.offset.click.left<this.containment[0])?e-b.grid[0]:e+b.grid[0]:e}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():f?0:c.scrollTop()),left:e-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(d.browser.safari&&d.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():
f?0:c.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove();this.helper=null;this.cancelHelperRemoval=false},_trigger:function(a,b,c){c=c||this._uiHash();d.ui.plugin.call(this,a,[b,c]);if(a=="drag")this.positionAbs=this._convertPositionTo("absolute");return d.Widget.prototype._trigger.call(this,a,b,c)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,
offset:this.positionAbs}}});d.extend(d.ui.draggable,{version:"1.8.11"});d.ui.plugin.add("draggable","connectToSortable",{start:function(a,b){var c=d(this).data("draggable"),f=c.options,e=d.extend({},b,{item:c.element});c.sortables=[];d(f.connectToSortable).each(function(){var g=d.data(this,"sortable");if(g&&!g.options.disabled){c.sortables.push({instance:g,shouldRevert:g.options.revert});g.refreshPositions();g._trigger("activate",a,e)}})},stop:function(a,b){var c=d(this).data("draggable"),f=d.extend({},
b,{item:c.element});d.each(c.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;c.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert)this.instance.options.revert=true;this.instance._mouseStop(a);this.instance.options.helper=this.instance.options._helper;c.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",a,f)}})},drag:function(a,b){var c=
d(this).data("draggable"),f=this;d.each(c.sortables,function(){this.instance.positionAbs=c.positionAbs;this.instance.helperProportions=c.helperProportions;this.instance.offset.click=c.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=d(f).clone().appendTo(this.instance.element).data("sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return b.helper[0]};
a.target=this.instance.currentItem[0];this.instance._mouseCapture(a,true);this.instance._mouseStart(a,true,true);this.instance.offset.click.top=c.offset.click.top;this.instance.offset.click.left=c.offset.click.left;this.instance.offset.parent.left-=c.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=c.offset.parent.top-this.instance.offset.parent.top;c._trigger("toSortable",a);c.dropped=this.instance.element;c.currentItem=c.element;this.instance.fromOutside=c}this.instance.currentItem&&
this.instance._mouseDrag(a)}else if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",a,this.instance._uiHash(this.instance));this.instance._mouseStop(a,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();this.instance.placeholder&&this.instance.placeholder.remove();c._trigger("fromSortable",a);c.dropped=false}})}});d.ui.plugin.add("draggable","cursor",
{start:function(){var a=d("body"),b=d(this).data("draggable").options;if(a.css("cursor"))b._cursor=a.css("cursor");a.css("cursor",b.cursor)},stop:function(){var a=d(this).data("draggable").options;a._cursor&&d("body").css("cursor",a._cursor)}});d.ui.plugin.add("draggable","iframeFix",{start:function(){var a=d(this).data("draggable").options;d(a.iframeFix===true?"iframe":a.iframeFix).each(function(){d('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+
"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css(d(this).offset()).appendTo("body")})},stop:function(){d("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)})}});d.ui.plugin.add("draggable","opacity",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("opacity"))b._opacity=a.css("opacity");a.css("opacity",b.opacity)},stop:function(a,b){a=d(this).data("draggable").options;a._opacity&&d(b.helper).css("opacity",
a._opacity)}});d.ui.plugin.add("draggable","scroll",{start:function(){var a=d(this).data("draggable");if(a.scrollParent[0]!=document&&a.scrollParent[0].tagName!="HTML")a.overflowOffset=a.scrollParent.offset()},drag:function(a){var b=d(this).data("draggable"),c=b.options,f=false;if(b.scrollParent[0]!=document&&b.scrollParent[0].tagName!="HTML"){if(!c.axis||c.axis!="x")if(b.overflowOffset.top+b.scrollParent[0].offsetHeight-a.pageY<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop+
c.scrollSpeed;else if(a.pageY-b.overflowOffset.top<c.scrollSensitivity)b.scrollParent[0].scrollTop=f=b.scrollParent[0].scrollTop-c.scrollSpeed;if(!c.axis||c.axis!="y")if(b.overflowOffset.left+b.scrollParent[0].offsetWidth-a.pageX<c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft+c.scrollSpeed;else if(a.pageX-b.overflowOffset.left<c.scrollSensitivity)b.scrollParent[0].scrollLeft=f=b.scrollParent[0].scrollLeft-c.scrollSpeed}else{if(!c.axis||c.axis!="x")if(a.pageY-d(document).scrollTop()<
c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()-c.scrollSpeed);else if(d(window).height()-(a.pageY-d(document).scrollTop())<c.scrollSensitivity)f=d(document).scrollTop(d(document).scrollTop()+c.scrollSpeed);if(!c.axis||c.axis!="y")if(a.pageX-d(document).scrollLeft()<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()-c.scrollSpeed);else if(d(window).width()-(a.pageX-d(document).scrollLeft())<c.scrollSensitivity)f=d(document).scrollLeft(d(document).scrollLeft()+
c.scrollSpeed)}f!==false&&d.ui.ddmanager&&!c.dropBehaviour&&d.ui.ddmanager.prepareOffsets(b,a)}});d.ui.plugin.add("draggable","snap",{start:function(){var a=d(this).data("draggable"),b=a.options;a.snapElements=[];d(b.snap.constructor!=String?b.snap.items||":data(draggable)":b.snap).each(function(){var c=d(this),f=c.offset();this!=a.element[0]&&a.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:f.top,left:f.left})})},drag:function(a,b){for(var c=d(this).data("draggable"),
f=c.options,e=f.snapTolerance,g=b.offset.left,n=g+c.helperProportions.width,m=b.offset.top,o=m+c.helperProportions.height,h=c.snapElements.length-1;h>=0;h--){var i=c.snapElements[h].left,k=i+c.snapElements[h].width,j=c.snapElements[h].top,l=j+c.snapElements[h].height;if(i-e<g&&g<k+e&&j-e<m&&m<l+e||i-e<g&&g<k+e&&j-e<o&&o<l+e||i-e<n&&n<k+e&&j-e<m&&m<l+e||i-e<n&&n<k+e&&j-e<o&&o<l+e){if(f.snapMode!="inner"){var p=Math.abs(j-o)<=e,q=Math.abs(l-m)<=e,r=Math.abs(i-n)<=e,s=Math.abs(k-g)<=e;if(p)b.position.top=
c._convertPositionTo("relative",{top:j-c.helperProportions.height,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:l,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:i-c.helperProportions.width}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:k}).left-c.margins.left}var t=p||q||r||s;if(f.snapMode!="outer"){p=Math.abs(j-m)<=e;q=Math.abs(l-o)<=e;r=Math.abs(i-g)<=e;s=Math.abs(k-n)<=e;if(p)b.position.top=
c._convertPositionTo("relative",{top:j,left:0}).top-c.margins.top;if(q)b.position.top=c._convertPositionTo("relative",{top:l-c.helperProportions.height,left:0}).top-c.margins.top;if(r)b.position.left=c._convertPositionTo("relative",{top:0,left:i}).left-c.margins.left;if(s)b.position.left=c._convertPositionTo("relative",{top:0,left:k-c.helperProportions.width}).left-c.margins.left}if(!c.snapElements[h].snapping&&(p||q||r||s||t))c.options.snap.snap&&c.options.snap.snap.call(c.element,a,d.extend(c._uiHash(),
{snapItem:c.snapElements[h].item}));c.snapElements[h].snapping=p||q||r||s||t}else{c.snapElements[h].snapping&&c.options.snap.release&&c.options.snap.release.call(c.element,a,d.extend(c._uiHash(),{snapItem:c.snapElements[h].item}));c.snapElements[h].snapping=false}}}});d.ui.plugin.add("draggable","stack",{start:function(){var a=d(this).data("draggable").options;a=d.makeArray(d(a.stack)).sort(function(c,f){return(parseInt(d(c).css("zIndex"),10)||0)-(parseInt(d(f).css("zIndex"),10)||0)});if(a.length){var b=
parseInt(a[0].style.zIndex)||0;d(a).each(function(c){this.style.zIndex=b+c});this[0].style.zIndex=b+a.length}}});d.ui.plugin.add("draggable","zIndex",{start:function(a,b){a=d(b.helper);b=d(this).data("draggable").options;if(a.css("zIndex"))b._zIndex=a.css("zIndex");a.css("zIndex",b.zIndex)},stop:function(a,b){a=d(this).data("draggable").options;a._zIndex&&d(b.helper).css("zIndex",a._zIndex)}})})(jQuery);
;/*
 * jQuery UI Resizable 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(e){e.widget("ui.resizable",e.ui.mouse,{widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1E3},_create:function(){var b=this,a=this.options;this.element.addClass("ui-resizable");e.extend(this,{_aspectRatio:!!a.aspectRatio,aspectRatio:a.aspectRatio,originalElement:this.element,
_proportionallyResizeElements:[],_helper:a.helper||a.ghost||a.animate?a.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){/relative/.test(this.element.css("position"))&&e.browser.opera&&this.element.css({position:"relative",top:"auto",left:"auto"});this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),
top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("resizable",this.element.data("resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=
this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=a.handles||(!e(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",
nw:".ui-resizable-nw"});if(this.handles.constructor==String){if(this.handles=="all")this.handles="n,e,s,w,se,sw,ne,nw";var c=this.handles.split(",");this.handles={};for(var d=0;d<c.length;d++){var f=e.trim(c[d]),g=e('<div class="ui-resizable-handle '+("ui-resizable-"+f)+'"></div>');/sw|se|ne|nw/.test(f)&&g.css({zIndex:++a.zIndex});"se"==f&&g.addClass("ui-icon ui-icon-gripsmall-diagonal-se");this.handles[f]=".ui-resizable-"+f;this.element.append(g)}}this._renderAxis=function(h){h=h||this.element;for(var i in this.handles){if(this.handles[i].constructor==
String)this.handles[i]=e(this.handles[i],this.element).show();if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var j=e(this.handles[i],this.element),k=0;k=/sw|ne|nw|se|n|s/.test(i)?j.outerHeight():j.outerWidth();j=["padding",/ne|nw|n/.test(i)?"Top":/se|sw|s/.test(i)?"Bottom":/^e$/.test(i)?"Right":"Left"].join("");h.css(j,k);this._proportionallyResize()}e(this.handles[i])}};this._renderAxis(this.element);this._handles=e(".ui-resizable-handle",this.element).disableSelection();
this._handles.mouseover(function(){if(!b.resizing){if(this.className)var h=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);b.axis=h&&h[1]?h[1]:"se"}});if(a.autoHide){this._handles.hide();e(this.element).addClass("ui-resizable-autohide").hover(function(){e(this).removeClass("ui-resizable-autohide");b._handles.show()},function(){if(!b.resizing){e(this).addClass("ui-resizable-autohide");b._handles.hide()}})}this._mouseInit()},destroy:function(){this._mouseDestroy();var b=function(c){e(c).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};
if(this.elementIsWrapper){b(this.element);var a=this.element;a.after(this.originalElement.css({position:a.css("position"),width:a.outerWidth(),height:a.outerHeight(),top:a.css("top"),left:a.css("left")})).remove()}this.originalElement.css("resize",this.originalResizeStyle);b(this.originalElement);return this},_mouseCapture:function(b){var a=false;for(var c in this.handles)if(e(this.handles[c])[0]==b.target)a=true;return!this.options.disabled&&a},_mouseStart:function(b){var a=this.options,c=this.element.position(),
d=this.element;this.resizing=true;this.documentScroll={top:e(document).scrollTop(),left:e(document).scrollLeft()};if(d.is(".ui-draggable")||/absolute/.test(d.css("position")))d.css({position:"absolute",top:c.top,left:c.left});e.browser.opera&&/relative/.test(d.css("position"))&&d.css({position:"relative",top:"auto",left:"auto"});this._renderProxy();c=m(this.helper.css("left"));var f=m(this.helper.css("top"));if(a.containment){c+=e(a.containment).scrollLeft()||0;f+=e(a.containment).scrollTop()||0}this.offset=
this.helper.offset();this.position={left:c,top:f};this.size=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalSize=this._helper?{width:d.outerWidth(),height:d.outerHeight()}:{width:d.width(),height:d.height()};this.originalPosition={left:c,top:f};this.sizeDiff={width:d.outerWidth()-d.width(),height:d.outerHeight()-d.height()};this.originalMousePosition={left:b.pageX,top:b.pageY};this.aspectRatio=typeof a.aspectRatio=="number"?a.aspectRatio:
this.originalSize.width/this.originalSize.height||1;a=e(".ui-resizable-"+this.axis).css("cursor");e("body").css("cursor",a=="auto"?this.axis+"-resize":a);d.addClass("ui-resizable-resizing");this._propagate("start",b);return true},_mouseDrag:function(b){var a=this.helper,c=this.originalMousePosition,d=this._change[this.axis];if(!d)return false;c=d.apply(this,[b,b.pageX-c.left||0,b.pageY-c.top||0]);if(this._aspectRatio||b.shiftKey)c=this._updateRatio(c,b);c=this._respectSize(c,b);this._propagate("resize",
b);a.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"});!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize();this._updateCache(c);this._trigger("resize",b,this.ui());return false},_mouseStop:function(b){this.resizing=false;var a=this.options,c=this;if(this._helper){var d=this._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName);d=f&&e.ui.hasScroll(d[0],"left")?0:c.sizeDiff.height;
f=f?0:c.sizeDiff.width;f={width:c.helper.width()-f,height:c.helper.height()-d};d=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null;var g=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;a.animate||this.element.css(e.extend(f,{top:g,left:d}));c.helper.height(c.size.height);c.helper.width(c.size.width);this._helper&&!a.animate&&this._proportionallyResize()}e("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");
this._propagate("stop",b);this._helper&&this.helper.remove();return false},_updateCache:function(b){this.offset=this.helper.offset();if(l(b.left))this.position.left=b.left;if(l(b.top))this.position.top=b.top;if(l(b.height))this.size.height=b.height;if(l(b.width))this.size.width=b.width},_updateRatio:function(b){var a=this.position,c=this.size,d=this.axis;if(b.height)b.width=c.height*this.aspectRatio;else if(b.width)b.height=c.width/this.aspectRatio;if(d=="sw"){b.left=a.left+(c.width-b.width);b.top=
null}if(d=="nw"){b.top=a.top+(c.height-b.height);b.left=a.left+(c.width-b.width)}return b},_respectSize:function(b){var a=this.options,c=this.axis,d=l(b.width)&&a.maxWidth&&a.maxWidth<b.width,f=l(b.height)&&a.maxHeight&&a.maxHeight<b.height,g=l(b.width)&&a.minWidth&&a.minWidth>b.width,h=l(b.height)&&a.minHeight&&a.minHeight>b.height;if(g)b.width=a.minWidth;if(h)b.height=a.minHeight;if(d)b.width=a.maxWidth;if(f)b.height=a.maxHeight;var i=this.originalPosition.left+this.originalSize.width,j=this.position.top+
this.size.height,k=/sw|nw|w/.test(c);c=/nw|ne|n/.test(c);if(g&&k)b.left=i-a.minWidth;if(d&&k)b.left=i-a.maxWidth;if(h&&c)b.top=j-a.minHeight;if(f&&c)b.top=j-a.maxHeight;if((a=!b.width&&!b.height)&&!b.left&&b.top)b.top=null;else if(a&&!b.top&&b.left)b.left=null;return b},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var b=this.helper||this.element,a=0;a<this._proportionallyResizeElements.length;a++){var c=this._proportionallyResizeElements[a];if(!this.borderDif){var d=
[c.css("borderTopWidth"),c.css("borderRightWidth"),c.css("borderBottomWidth"),c.css("borderLeftWidth")],f=[c.css("paddingTop"),c.css("paddingRight"),c.css("paddingBottom"),c.css("paddingLeft")];this.borderDif=e.map(d,function(g,h){g=parseInt(g,10)||0;h=parseInt(f[h],10)||0;return g+h})}e.browser.msie&&(e(b).is(":hidden")||e(b).parents(":hidden").length)||c.css({height:b.height()-this.borderDif[0]-this.borderDif[2]||0,width:b.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var b=
this.options;this.elementOffset=this.element.offset();if(this._helper){this.helper=this.helper||e('<div style="overflow:hidden;"></div>');var a=e.browser.msie&&e.browser.version<7,c=a?1:0;a=a?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+a,height:this.element.outerHeight()+a,position:"absolute",left:this.elementOffset.left-c+"px",top:this.elementOffset.top-c+"px",zIndex:++b.zIndex});this.helper.appendTo("body").disableSelection()}else this.helper=this.element},_change:{e:function(b,
a){return{width:this.originalSize.width+a}},w:function(b,a){return{left:this.originalPosition.left+a,width:this.originalSize.width-a}},n:function(b,a,c){return{top:this.originalPosition.top+c,height:this.originalSize.height-c}},s:function(b,a,c){return{height:this.originalSize.height+c}},se:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},sw:function(b,a,c){return e.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,a,
c]))},ne:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,a,c]))},nw:function(b,a,c){return e.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,a,c]))}},_propagate:function(b,a){e.ui.plugin.call(this,b,[a,this.ui()]);b!="resize"&&this._trigger(b,a,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,
originalPosition:this.originalPosition}}});e.extend(e.ui.resizable,{version:"1.8.11"});e.ui.plugin.add("resizable","alsoResize",{start:function(){var b=e(this).data("resizable").options,a=function(c){e(c).each(function(){var d=e(this);d.data("resizable-alsoresize",{width:parseInt(d.width(),10),height:parseInt(d.height(),10),left:parseInt(d.css("left"),10),top:parseInt(d.css("top"),10),position:d.css("position")})})};if(typeof b.alsoResize=="object"&&!b.alsoResize.parentNode)if(b.alsoResize.length){b.alsoResize=
b.alsoResize[0];a(b.alsoResize)}else e.each(b.alsoResize,function(c){a(c)});else a(b.alsoResize)},resize:function(b,a){var c=e(this).data("resizable");b=c.options;var d=c.originalSize,f=c.originalPosition,g={height:c.size.height-d.height||0,width:c.size.width-d.width||0,top:c.position.top-f.top||0,left:c.position.left-f.left||0},h=function(i,j){e(i).each(function(){var k=e(this),q=e(this).data("resizable-alsoresize"),p={},r=j&&j.length?j:k.parents(a.originalElement[0]).length?["width","height"]:["width",
"height","top","left"];e.each(r,function(n,o){if((n=(q[o]||0)+(g[o]||0))&&n>=0)p[o]=n||null});if(e.browser.opera&&/relative/.test(k.css("position"))){c._revertToRelativePosition=true;k.css({position:"absolute",top:"auto",left:"auto"})}k.css(p)})};typeof b.alsoResize=="object"&&!b.alsoResize.nodeType?e.each(b.alsoResize,function(i,j){h(i,j)}):h(b.alsoResize)},stop:function(){var b=e(this).data("resizable"),a=b.options,c=function(d){e(d).each(function(){var f=e(this);f.css({position:f.data("resizable-alsoresize").position})})};
if(b._revertToRelativePosition){b._revertToRelativePosition=false;typeof a.alsoResize=="object"&&!a.alsoResize.nodeType?e.each(a.alsoResize,function(d){c(d)}):c(a.alsoResize)}e(this).removeData("resizable-alsoresize")}});e.ui.plugin.add("resizable","animate",{stop:function(b){var a=e(this).data("resizable"),c=a.options,d=a._proportionallyResizeElements,f=d.length&&/textarea/i.test(d[0].nodeName),g=f&&e.ui.hasScroll(d[0],"left")?0:a.sizeDiff.height;f={width:a.size.width-(f?0:a.sizeDiff.width),height:a.size.height-
g};g=parseInt(a.element.css("left"),10)+(a.position.left-a.originalPosition.left)||null;var h=parseInt(a.element.css("top"),10)+(a.position.top-a.originalPosition.top)||null;a.element.animate(e.extend(f,h&&g?{top:h,left:g}:{}),{duration:c.animateDuration,easing:c.animateEasing,step:function(){var i={width:parseInt(a.element.css("width"),10),height:parseInt(a.element.css("height"),10),top:parseInt(a.element.css("top"),10),left:parseInt(a.element.css("left"),10)};d&&d.length&&e(d[0]).css({width:i.width,
height:i.height});a._updateCache(i);a._propagate("resize",b)}})}});e.ui.plugin.add("resizable","containment",{start:function(){var b=e(this).data("resizable"),a=b.element,c=b.options.containment;if(a=c instanceof e?c.get(0):/parent/.test(c)?a.parent().get(0):c){b.containerElement=e(a);if(/document/.test(c)||c==document){b.containerOffset={left:0,top:0};b.containerPosition={left:0,top:0};b.parentData={element:e(document),left:0,top:0,width:e(document).width(),height:e(document).height()||document.body.parentNode.scrollHeight}}else{var d=
e(a),f=[];e(["Top","Right","Left","Bottom"]).each(function(i,j){f[i]=m(d.css("padding"+j))});b.containerOffset=d.offset();b.containerPosition=d.position();b.containerSize={height:d.innerHeight()-f[3],width:d.innerWidth()-f[1]};c=b.containerOffset;var g=b.containerSize.height,h=b.containerSize.width;h=e.ui.hasScroll(a,"left")?a.scrollWidth:h;g=e.ui.hasScroll(a)?a.scrollHeight:g;b.parentData={element:a,left:c.left,top:c.top,width:h,height:g}}}},resize:function(b){var a=e(this).data("resizable"),c=a.options,
d=a.containerOffset,f=a.position;b=a._aspectRatio||b.shiftKey;var g={top:0,left:0},h=a.containerElement;if(h[0]!=document&&/static/.test(h.css("position")))g=d;if(f.left<(a._helper?d.left:0)){a.size.width+=a._helper?a.position.left-d.left:a.position.left-g.left;if(b)a.size.height=a.size.width/c.aspectRatio;a.position.left=c.helper?d.left:0}if(f.top<(a._helper?d.top:0)){a.size.height+=a._helper?a.position.top-d.top:a.position.top;if(b)a.size.width=a.size.height*c.aspectRatio;a.position.top=a._helper?
d.top:0}a.offset.left=a.parentData.left+a.position.left;a.offset.top=a.parentData.top+a.position.top;c=Math.abs((a._helper?a.offset.left-g.left:a.offset.left-g.left)+a.sizeDiff.width);d=Math.abs((a._helper?a.offset.top-g.top:a.offset.top-d.top)+a.sizeDiff.height);f=a.containerElement.get(0)==a.element.parent().get(0);g=/relative|absolute/.test(a.containerElement.css("position"));if(f&&g)c-=a.parentData.left;if(c+a.size.width>=a.parentData.width){a.size.width=a.parentData.width-c;if(b)a.size.height=
a.size.width/a.aspectRatio}if(d+a.size.height>=a.parentData.height){a.size.height=a.parentData.height-d;if(b)a.size.width=a.size.height*a.aspectRatio}},stop:function(){var b=e(this).data("resizable"),a=b.options,c=b.containerOffset,d=b.containerPosition,f=b.containerElement,g=e(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width;g=g.outerHeight()-b.sizeDiff.height;b._helper&&!a.animate&&/relative/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g});b._helper&&!a.animate&&
/static/.test(f.css("position"))&&e(this).css({left:h.left-d.left-c.left,width:i,height:g})}});e.ui.plugin.add("resizable","ghost",{start:function(){var b=e(this).data("resizable"),a=b.options,c=b.size;b.ghost=b.originalElement.clone();b.ghost.css({opacity:0.25,display:"block",position:"relative",height:c.height,width:c.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof a.ghost=="string"?a.ghost:"");b.ghost.appendTo(b.helper)},resize:function(){var b=e(this).data("resizable");
b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=e(this).data("resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}});e.ui.plugin.add("resizable","grid",{resize:function(){var b=e(this).data("resizable"),a=b.options,c=b.size,d=b.originalSize,f=b.originalPosition,g=b.axis;a.grid=typeof a.grid=="number"?[a.grid,a.grid]:a.grid;var h=Math.round((c.width-d.width)/(a.grid[0]||1))*(a.grid[0]||1);a=Math.round((c.height-d.height)/
(a.grid[1]||1))*(a.grid[1]||1);if(/^(se|s|e)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a}else if(/^(ne)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}else{if(/^(sw)$/.test(g)){b.size.width=d.width+h;b.size.height=d.height+a}else{b.size.width=d.width+h;b.size.height=d.height+a;b.position.top=f.top-a}b.position.left=f.left-h}}});var m=function(b){return parseInt(b,10)||0},l=function(b){return!isNaN(parseInt(b,10))}})(jQuery);
;/*
 * jQuery UI Button 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */
(function(a){var g,i=function(b){a(":ui-button",b.target.form).each(function(){var c=a(this).data("button");setTimeout(function(){c.refresh()},1)})},h=function(b){var c=b.name,d=b.form,f=a([]);if(c)f=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form});return f};a.widget("ui.button",{options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",
i);if(typeof this.options.disabled!=="boolean")this.options.disabled=this.element.attr("disabled");this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var b=this,c=this.options,d=this.type==="checkbox"||this.type==="radio",f="ui-state-hover"+(!d?" ui-state-active":"");if(c.label===null)c.label=this.buttonElement.html();if(this.element.is(":disabled"))c.disabled=true;this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role","button").bind("mouseenter.button",
function(){if(!c.disabled){a(this).addClass("ui-state-hover");this===g&&a(this).addClass("ui-state-active")}}).bind("mouseleave.button",function(){c.disabled||a(this).removeClass(f)}).bind("focus.button",function(){a(this).addClass("ui-state-focus")}).bind("blur.button",function(){a(this).removeClass("ui-state-focus")});d&&this.element.bind("change.button",function(){b.refresh()});if(this.type==="checkbox")this.buttonElement.bind("click.button",function(){if(c.disabled)return false;a(this).toggleClass("ui-state-active");
b.buttonElement.attr("aria-pressed",b.element[0].checked)});else if(this.type==="radio")this.buttonElement.bind("click.button",function(){if(c.disabled)return false;a(this).addClass("ui-state-active");b.buttonElement.attr("aria-pressed",true);var e=b.element[0];h(e).not(e).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed",false)});else{this.buttonElement.bind("mousedown.button",function(){if(c.disabled)return false;a(this).addClass("ui-state-active");
g=this;a(document).one("mouseup",function(){g=null})}).bind("mouseup.button",function(){if(c.disabled)return false;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(e){if(c.disabled)return false;if(e.keyCode==a.ui.keyCode.SPACE||e.keyCode==a.ui.keyCode.ENTER)a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")});this.buttonElement.is("a")&&this.buttonElement.keyup(function(e){e.keyCode===a.ui.keyCode.SPACE&&a(this).click()})}this._setOption("disabled",
c.disabled)},_determineButtonType:function(){this.type=this.element.is(":checkbox")?"checkbox":this.element.is(":radio")?"radio":this.element.is("input")?"input":"button";if(this.type==="checkbox"||this.type==="radio"){var b=this.element.parents().filter(":last"),c="label[for="+this.element.attr("id")+"]";this.buttonElement=b.find(c);if(!this.buttonElement.length){b=b.length?b.siblings():this.element.siblings();this.buttonElement=b.filter(c);if(!this.buttonElement.length)this.buttonElement=b.find(c)}this.element.addClass("ui-helper-hidden-accessible");
(b=this.element.is(":checked"))&&this.buttonElement.addClass("ui-state-active");this.buttonElement.attr("aria-pressed",b)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());
this.hasTitle||this.buttonElement.removeAttr("title");a.Widget.prototype.destroy.call(this)},_setOption:function(b,c){a.Widget.prototype._setOption.apply(this,arguments);if(b==="disabled")c?this.element.attr("disabled",true):this.element.removeAttr("disabled");this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b);if(this.type==="radio")h(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed",
true):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed",false)});else if(this.type==="checkbox")this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed",true):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed",false)},_resetButton:function(){if(this.type==="input")this.options.label&&this.element.val(this.options.label);else{var b=this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"),
c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,f=d.primary&&d.secondary,e=[];if(d.primary||d.secondary){if(this.options.text)e.push("ui-button-text-icon"+(f?"s":d.primary?"-primary":"-secondary"));d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>");d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>");if(!this.options.text){e.push(f?"ui-button-icons-only":
"ui-button-icon-only");this.hasTitle||b.attr("title",c)}}else e.push("ui-button-text-only");b.addClass(e.join(" "))}}});a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(b,c){b==="disabled"&&this.buttons.button("option",b,c);a.Widget.prototype._setOption.apply(this,arguments)},refresh:function(){this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass("ui-corner-left").end().filter(":last").addClass("ui-corner-right").end().end()},
destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy");a.Widget.prototype.destroy.call(this)}})})(jQuery);
;/*
 * jQuery UI Dialog 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */
(function(c,j){var k={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},l={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};c.widget("ui.dialog",{options:{autoOpen:true,buttons:{},closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:false,maxWidth:false,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",collision:"fit",using:function(a){var b=c(this).css(a).offset().top;b<0&&
c(this).css("top",a.top-b)}},resizable:true,show:null,stack:true,title:"",width:300,zIndex:1E3},_create:function(){this.originalTitle=this.element.attr("title");if(typeof this.originalTitle!=="string")this.originalTitle="";this.options.title=this.options.title||this.originalTitle;var a=this,b=a.options,d=b.title||"&#160;",e=c.ui.dialog.getTitleId(a.element),g=(a.uiDialog=c("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b.dialogClass).css({zIndex:b.zIndex}).attr("tabIndex",
-1).css("outline",0).keydown(function(i){if(b.closeOnEscape&&i.keyCode&&i.keyCode===c.ui.keyCode.ESCAPE){a.close(i);i.preventDefault()}}).attr({role:"dialog","aria-labelledby":e}).mousedown(function(i){a.moveToTop(false,i)});a.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(g);var f=(a.uiDialogTitlebar=c("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(g),h=c('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role",
"button").hover(function(){h.addClass("ui-state-hover")},function(){h.removeClass("ui-state-hover")}).focus(function(){h.addClass("ui-state-focus")}).blur(function(){h.removeClass("ui-state-focus")}).click(function(i){a.close(i);return false}).appendTo(f);(a.uiDialogTitlebarCloseText=c("<span></span>")).addClass("ui-icon ui-icon-closethick").text(b.closeText).appendTo(h);c("<span></span>").addClass("ui-dialog-title").attr("id",e).html(d).prependTo(f);if(c.isFunction(b.beforeclose)&&!c.isFunction(b.beforeClose))b.beforeClose=
b.beforeclose;f.find("*").add(f).disableSelection();b.draggable&&c.fn.draggable&&a._makeDraggable();b.resizable&&c.fn.resizable&&a._makeResizable();a._createButtons(b.buttons);a._isOpen=false;c.fn.bgiframe&&g.bgiframe()},_init:function(){this.options.autoOpen&&this.open()},destroy:function(){var a=this;a.overlay&&a.overlay.destroy();a.uiDialog.hide();a.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body");a.uiDialog.remove();a.originalTitle&&
a.element.attr("title",a.originalTitle);return a},widget:function(){return this.uiDialog},close:function(a){var b=this,d,e;if(false!==b._trigger("beforeClose",a)){b.overlay&&b.overlay.destroy();b.uiDialog.unbind("keypress.ui-dialog");b._isOpen=false;if(b.options.hide)b.uiDialog.hide(b.options.hide,function(){b._trigger("close",a)});else{b.uiDialog.hide();b._trigger("close",a)}c.ui.dialog.overlay.resize();if(b.options.modal){d=0;c(".ui-dialog").each(function(){if(this!==b.uiDialog[0]){e=c(this).css("z-index");
isNaN(e)||(d=Math.max(d,e))}});c.ui.dialog.maxZ=d}return b}},isOpen:function(){return this._isOpen},moveToTop:function(a,b){var d=this,e=d.options;if(e.modal&&!a||!e.stack&&!e.modal)return d._trigger("focus",b);if(e.zIndex>c.ui.dialog.maxZ)c.ui.dialog.maxZ=e.zIndex;if(d.overlay){c.ui.dialog.maxZ+=1;d.overlay.$el.css("z-index",c.ui.dialog.overlay.maxZ=c.ui.dialog.maxZ)}a={scrollTop:d.element.attr("scrollTop"),scrollLeft:d.element.attr("scrollLeft")};c.ui.dialog.maxZ+=1;d.uiDialog.css("z-index",c.ui.dialog.maxZ);
d.element.attr(a);d._trigger("focus",b);return d},open:function(){if(!this._isOpen){var a=this,b=a.options,d=a.uiDialog;a.overlay=b.modal?new c.ui.dialog.overlay(a):null;a._size();a._position(b.position);d.show(b.show);a.moveToTop(true);b.modal&&d.bind("keypress.ui-dialog",function(e){if(e.keyCode===c.ui.keyCode.TAB){var g=c(":tabbable",this),f=g.filter(":first");g=g.filter(":last");if(e.target===g[0]&&!e.shiftKey){f.focus(1);return false}else if(e.target===f[0]&&e.shiftKey){g.focus(1);return false}}});
c(a.element.find(":tabbable").get().concat(d.find(".ui-dialog-buttonpane :tabbable").get().concat(d.get()))).eq(0).focus();a._isOpen=true;a._trigger("open");return a}},_createButtons:function(a){var b=this,d=false,e=c("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),g=c("<div></div>").addClass("ui-dialog-buttonset").appendTo(e);b.uiDialog.find(".ui-dialog-buttonpane").remove();typeof a==="object"&&a!==null&&c.each(a,function(){return!(d=true)});if(d){c.each(a,function(f,
h){h=c.isFunction(h)?{click:h,text:f}:h;f=c('<button type="button"></button>').attr(h,true).unbind("click").click(function(){h.click.apply(b.element[0],arguments)}).appendTo(g);c.fn.button&&f.button()});e.appendTo(b.uiDialog)}},_makeDraggable:function(){function a(f){return{position:f.position,offset:f.offset}}var b=this,d=b.options,e=c(document),g;b.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(f,h){g=
d.height==="auto"?"auto":c(this).height();c(this).height(c(this).height()).addClass("ui-dialog-dragging");b._trigger("dragStart",f,a(h))},drag:function(f,h){b._trigger("drag",f,a(h))},stop:function(f,h){d.position=[h.position.left-e.scrollLeft(),h.position.top-e.scrollTop()];c(this).removeClass("ui-dialog-dragging").height(g);b._trigger("dragStop",f,a(h));c.ui.dialog.overlay.resize()}})},_makeResizable:function(a){function b(f){return{originalPosition:f.originalPosition,originalSize:f.originalSize,
position:f.position,size:f.size}}a=a===j?this.options.resizable:a;var d=this,e=d.options,g=d.uiDialog.css("position");a=typeof a==="string"?a:"n,e,s,w,se,sw,ne,nw";d.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:d.element,maxWidth:e.maxWidth,maxHeight:e.maxHeight,minWidth:e.minWidth,minHeight:d._minHeight(),handles:a,start:function(f,h){c(this).addClass("ui-dialog-resizing");d._trigger("resizeStart",f,b(h))},resize:function(f,h){d._trigger("resize",f,b(h))},stop:function(f,
h){c(this).removeClass("ui-dialog-resizing");e.height=c(this).height();e.width=c(this).width();d._trigger("resizeStop",f,b(h));c.ui.dialog.overlay.resize()}}).css("position",g).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var a=this.options;return a.height==="auto"?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(a){var b=[],d=[0,0],e;if(a){if(typeof a==="string"||typeof a==="object"&&"0"in a){b=a.split?a.split(" "):[a[0],a[1]];if(b.length===
1)b[1]=b[0];c.each(["left","top"],function(g,f){if(+b[g]===b[g]){d[g]=b[g];b[g]=f}});a={my:b.join(" "),at:b.join(" "),offset:d.join(" ")}}a=c.extend({},c.ui.dialog.prototype.options.position,a)}else a=c.ui.dialog.prototype.options.position;(e=this.uiDialog.is(":visible"))||this.uiDialog.show();this.uiDialog.css({top:0,left:0}).position(c.extend({of:window},a));e||this.uiDialog.hide()},_setOptions:function(a){var b=this,d={},e=false;c.each(a,function(g,f){b._setOption(g,f);if(g in k)e=true;if(g in
l)d[g]=f});e&&this._size();this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",d)},_setOption:function(a,b){var d=this,e=d.uiDialog;switch(a){case "beforeclose":a="beforeClose";break;case "buttons":d._createButtons(b);break;case "closeText":d.uiDialogTitlebarCloseText.text(""+b);break;case "dialogClass":e.removeClass(d.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all "+b);break;case "disabled":b?e.addClass("ui-dialog-disabled"):e.removeClass("ui-dialog-disabled");
break;case "draggable":var g=e.is(":data(draggable)");g&&!b&&e.draggable("destroy");!g&&b&&d._makeDraggable();break;case "position":d._position(b);break;case "resizable":(g=e.is(":data(resizable)"))&&!b&&e.resizable("destroy");g&&typeof b==="string"&&e.resizable("option","handles",b);!g&&b!==false&&d._makeResizable(b);break;case "title":c(".ui-dialog-title",d.uiDialogTitlebar).html(""+(b||"&#160;"));break}c.Widget.prototype._setOption.apply(d,arguments)},_size:function(){var a=this.options,b,d,e=
this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0});if(a.minWidth>a.width)a.width=a.minWidth;b=this.uiDialog.css({height:"auto",width:a.width}).height();d=Math.max(0,a.minHeight-b);if(a.height==="auto")if(c.support.minHeight)this.element.css({minHeight:d,height:"auto"});else{this.uiDialog.show();a=this.element.css("height","auto").height();e||this.uiDialog.hide();this.element.height(Math.max(a,d))}else this.element.height(Math.max(a.height-b,0));this.uiDialog.is(":data(resizable)")&&
this.uiDialog.resizable("option","minHeight",this._minHeight())}});c.extend(c.ui.dialog,{version:"1.8.11",uuid:0,maxZ:0,getTitleId:function(a){a=a.attr("id");if(!a){this.uuid+=1;a=this.uuid}return"ui-dialog-title-"+a},overlay:function(a){this.$el=c.ui.dialog.overlay.create(a)}});c.extend(c.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:c.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(a){return a+".dialog-overlay"}).join(" "),create:function(a){if(this.instances.length===
0){setTimeout(function(){c.ui.dialog.overlay.instances.length&&c(document).bind(c.ui.dialog.overlay.events,function(d){if(c(d.target).zIndex()<c.ui.dialog.overlay.maxZ)return false})},1);c(document).bind("keydown.dialog-overlay",function(d){if(a.options.closeOnEscape&&d.keyCode&&d.keyCode===c.ui.keyCode.ESCAPE){a.close(d);d.preventDefault()}});c(window).bind("resize.dialog-overlay",c.ui.dialog.overlay.resize)}var b=(this.oldInstances.pop()||c("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width:this.width(),
height:this.height()});c.fn.bgiframe&&b.bgiframe();this.instances.push(b);return b},destroy:function(a){var b=c.inArray(a,this.instances);b!=-1&&this.oldInstances.push(this.instances.splice(b,1)[0]);this.instances.length===0&&c([document,window]).unbind(".dialog-overlay");a.remove();var d=0;c.each(this.instances,function(){d=Math.max(d,this.css("z-index"))});this.maxZ=d},height:function(){var a,b;if(c.browser.msie&&c.browser.version<7){a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight);
b=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight);return a<b?c(window).height()+"px":a+"px"}else return c(document).height()+"px"},width:function(){var a,b;if(c.browser.msie&&c.browser.version<7){a=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth);b=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth);return a<b?c(window).width()+"px":a+"px"}else return c(document).width()+"px"},resize:function(){var a=c([]);c.each(c.ui.dialog.overlay.instances,
function(){a=a.add(this)});a.css({width:0,height:0}).css({width:c.ui.dialog.overlay.width(),height:c.ui.dialog.overlay.height()})}});c.extend(c.ui.dialog.overlay.prototype,{destroy:function(){c.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);
;/*
 * jQuery UI Slider 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */
(function(d){d.widget("ui.slider",d.ui.mouse,{widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null},_create:function(){var b=this,a=this.options;this._mouseSliding=this._keySliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");a.disabled&&this.element.addClass("ui-slider-disabled ui-disabled");
this.range=d([]);if(a.range){if(a.range===true){this.range=d("<div></div>");if(!a.values)a.values=[this._valueMin(),this._valueMin()];if(a.values.length&&a.values.length!==2)a.values=[a.values[0],a.values[0]]}else this.range=d("<div></div>");this.range.appendTo(this.element).addClass("ui-slider-range");if(a.range==="min"||a.range==="max")this.range.addClass("ui-slider-range-"+a.range);this.range.addClass("ui-widget-header")}d(".ui-slider-handle",this.element).length===0&&d("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");
if(a.values&&a.values.length)for(;d(".ui-slider-handle",this.element).length<a.values.length;)d("<a href='#'></a>").appendTo(this.element).addClass("ui-slider-handle");this.handles=d(".ui-slider-handle",this.element).addClass("ui-state-default ui-corner-all");this.handle=this.handles.eq(0);this.handles.add(this.range).filter("a").click(function(c){c.preventDefault()}).hover(function(){a.disabled||d(this).addClass("ui-state-hover")},function(){d(this).removeClass("ui-state-hover")}).focus(function(){if(a.disabled)d(this).blur();
else{d(".ui-slider .ui-state-focus").removeClass("ui-state-focus");d(this).addClass("ui-state-focus")}}).blur(function(){d(this).removeClass("ui-state-focus")});this.handles.each(function(c){d(this).data("index.ui-slider-handle",c)});this.handles.keydown(function(c){var e=true,f=d(this).data("index.ui-slider-handle"),h,g,i;if(!b.options.disabled){switch(c.keyCode){case d.ui.keyCode.HOME:case d.ui.keyCode.END:case d.ui.keyCode.PAGE_UP:case d.ui.keyCode.PAGE_DOWN:case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:e=
false;if(!b._keySliding){b._keySliding=true;d(this).addClass("ui-state-active");h=b._start(c,f);if(h===false)return}break}i=b.options.step;h=b.options.values&&b.options.values.length?(g=b.values(f)):(g=b.value());switch(c.keyCode){case d.ui.keyCode.HOME:g=b._valueMin();break;case d.ui.keyCode.END:g=b._valueMax();break;case d.ui.keyCode.PAGE_UP:g=b._trimAlignValue(h+(b._valueMax()-b._valueMin())/5);break;case d.ui.keyCode.PAGE_DOWN:g=b._trimAlignValue(h-(b._valueMax()-b._valueMin())/5);break;case d.ui.keyCode.UP:case d.ui.keyCode.RIGHT:if(h===
b._valueMax())return;g=b._trimAlignValue(h+i);break;case d.ui.keyCode.DOWN:case d.ui.keyCode.LEFT:if(h===b._valueMin())return;g=b._trimAlignValue(h-i);break}b._slide(c,f,g);return e}}).keyup(function(c){var e=d(this).data("index.ui-slider-handle");if(b._keySliding){b._keySliding=false;b._stop(c,e);b._change(c,e);d(this).removeClass("ui-state-active")}});this._refreshValue();this._animateOff=false},destroy:function(){this.handles.remove();this.range.remove();this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider");
this._mouseDestroy();return this},_mouseCapture:function(b){var a=this.options,c,e,f,h,g;if(a.disabled)return false;this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();c=this._normValueFromMouse({x:b.pageX,y:b.pageY});e=this._valueMax()-this._valueMin()+1;h=this;this.handles.each(function(i){var j=Math.abs(c-h.values(i));if(e>j){e=j;f=d(this);g=i}});if(a.range===true&&this.values(1)===a.min){g+=1;f=d(this.handles[g])}if(this._start(b,
g)===false)return false;this._mouseSliding=true;h._handleIndex=g;f.addClass("ui-state-active").focus();a=f.offset();this._clickOffset=!d(b.target).parents().andSelf().is(".ui-slider-handle")?{left:0,top:0}:{left:b.pageX-a.left-f.width()/2,top:b.pageY-a.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)};this.handles.hasClass("ui-state-hover")||this._slide(b,g,c);return this._animateOff=true},_mouseStart:function(){return true},
_mouseDrag:function(b){var a=this._normValueFromMouse({x:b.pageX,y:b.pageY});this._slide(b,this._handleIndex,a);return false},_mouseStop:function(b){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(b,this._handleIndex);this._change(b,this._handleIndex);this._clickOffset=this._handleIndex=null;return this._animateOff=false},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(b){var a;
if(this.orientation==="horizontal"){a=this.elementSize.width;b=b.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{a=this.elementSize.height;b=b.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}a=b/a;if(a>1)a=1;if(a<0)a=0;if(this.orientation==="vertical")a=1-a;b=this._valueMax()-this._valueMin();return this._trimAlignValue(this._valueMin()+a*b)},_start:function(b,a){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=
this.values(a);c.values=this.values()}return this._trigger("start",b,c)},_slide:function(b,a,c){var e;if(this.options.values&&this.options.values.length){e=this.values(a?0:1);if(this.options.values.length===2&&this.options.range===true&&(a===0&&c>e||a===1&&c<e))c=e;if(c!==this.values(a)){e=this.values();e[a]=c;b=this._trigger("slide",b,{handle:this.handles[a],value:c,values:e});this.values(a?0:1);b!==false&&this.values(a,c,true)}}else if(c!==this.value()){b=this._trigger("slide",b,{handle:this.handles[a],
value:c});b!==false&&this.value(c)}},_stop:function(b,a){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(a);c.values=this.values()}this._trigger("stop",b,c)},_change:function(b,a){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[a],value:this.value()};if(this.options.values&&this.options.values.length){c.value=this.values(a);c.values=this.values()}this._trigger("change",b,c)}},value:function(b){if(arguments.length){this.options.value=
this._trimAlignValue(b);this._refreshValue();this._change(null,0)}return this._value()},values:function(b,a){var c,e,f;if(arguments.length>1){this.options.values[b]=this._trimAlignValue(a);this._refreshValue();this._change(null,b)}if(arguments.length)if(d.isArray(arguments[0])){c=this.options.values;e=arguments[0];for(f=0;f<c.length;f+=1){c[f]=this._trimAlignValue(e[f]);this._change(null,f)}this._refreshValue()}else return this.options.values&&this.options.values.length?this._values(b):this.value();
else return this._values()},_setOption:function(b,a){var c,e=0;if(d.isArray(this.options.values))e=this.options.values.length;d.Widget.prototype._setOption.apply(this,arguments);switch(b){case "disabled":if(a){this.handles.filter(".ui-state-focus").blur();this.handles.removeClass("ui-state-hover");this.handles.attr("disabled","disabled");this.element.addClass("ui-disabled")}else{this.handles.removeAttr("disabled");this.element.removeClass("ui-disabled")}break;case "orientation":this._detectOrientation();
this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case "value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case "values":this._animateOff=true;this._refreshValue();for(c=0;c<e;c+=1)this._change(null,c);this._animateOff=false;break}},_value:function(){var b=this.options.value;return b=this._trimAlignValue(b)},_values:function(b){var a,c;if(arguments.length){a=this.options.values[b];
return a=this._trimAlignValue(a)}else{a=this.options.values.slice();for(c=0;c<a.length;c+=1)a[c]=this._trimAlignValue(a[c]);return a}},_trimAlignValue:function(b){if(b<=this._valueMin())return this._valueMin();if(b>=this._valueMax())return this._valueMax();var a=this.options.step>0?this.options.step:1,c=(b-this._valueMin())%a;alignValue=b-c;if(Math.abs(c)*2>=a)alignValue+=c>0?a:-a;return parseFloat(alignValue.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},
_refreshValue:function(){var b=this.options.range,a=this.options,c=this,e=!this._animateOff?a.animate:false,f,h={},g,i,j,l;if(this.options.values&&this.options.values.length)this.handles.each(function(k){f=(c.values(k)-c._valueMin())/(c._valueMax()-c._valueMin())*100;h[c.orientation==="horizontal"?"left":"bottom"]=f+"%";d(this).stop(1,1)[e?"animate":"css"](h,a.animate);if(c.options.range===true)if(c.orientation==="horizontal"){if(k===0)c.range.stop(1,1)[e?"animate":"css"]({left:f+"%"},a.animate);
if(k===1)c.range[e?"animate":"css"]({width:f-g+"%"},{queue:false,duration:a.animate})}else{if(k===0)c.range.stop(1,1)[e?"animate":"css"]({bottom:f+"%"},a.animate);if(k===1)c.range[e?"animate":"css"]({height:f-g+"%"},{queue:false,duration:a.animate})}g=f});else{i=this.value();j=this._valueMin();l=this._valueMax();f=l!==j?(i-j)/(l-j)*100:0;h[c.orientation==="horizontal"?"left":"bottom"]=f+"%";this.handle.stop(1,1)[e?"animate":"css"](h,a.animate);if(b==="min"&&this.orientation==="horizontal")this.range.stop(1,
1)[e?"animate":"css"]({width:f+"%"},a.animate);if(b==="max"&&this.orientation==="horizontal")this.range[e?"animate":"css"]({width:100-f+"%"},{queue:false,duration:a.animate});if(b==="min"&&this.orientation==="vertical")this.range.stop(1,1)[e?"animate":"css"]({height:f+"%"},a.animate);if(b==="max"&&this.orientation==="vertical")this.range[e?"animate":"css"]({height:100-f+"%"},{queue:false,duration:a.animate})}}});d.extend(d.ui.slider,{version:"1.8.11"})})(jQuery);
;/*
 * jQuery UI Effects 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */
jQuery.effects||function(f,j){function n(c){var a;if(c&&c.constructor==Array&&c.length==3)return c;if(a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(c))return[parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)];if(a=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(c))return[parseFloat(a[1])*2.55,parseFloat(a[2])*2.55,parseFloat(a[3])*2.55];if(a=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(c))return[parseInt(a[1],
16),parseInt(a[2],16),parseInt(a[3],16)];if(a=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(c))return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)];if(/rgba\(0, 0, 0, 0\)/.exec(c))return o.transparent;return o[f.trim(c).toLowerCase()]}function s(c,a){var b;do{b=f.curCSS(c,a);if(b!=""&&b!="transparent"||f.nodeName(c,"body"))break;a="backgroundColor"}while(c=c.parentNode);return n(b)}function p(){var c=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,
a={},b,d;if(c&&c.length&&c[0]&&c[c[0]])for(var e=c.length;e--;){b=c[e];if(typeof c[b]=="string"){d=b.replace(/\-(\w)/g,function(g,h){return h.toUpperCase()});a[d]=c[b]}}else for(b in c)if(typeof c[b]==="string")a[b]=c[b];return a}function q(c){var a,b;for(a in c){b=c[a];if(b==null||f.isFunction(b)||a in t||/scrollbar/.test(a)||!/color/i.test(a)&&isNaN(parseFloat(b)))delete c[a]}return c}function u(c,a){var b={_:0},d;for(d in a)if(c[d]!=a[d])b[d]=a[d];return b}function k(c,a,b,d){if(typeof c=="object"){d=
a;b=null;a=c;c=a.effect}if(f.isFunction(a)){d=a;b=null;a={}}if(typeof a=="number"||f.fx.speeds[a]){d=b;b=a;a={}}if(f.isFunction(b)){d=b;b=null}a=a||{};b=b||a.duration;b=f.fx.off?0:typeof b=="number"?b:b in f.fx.speeds?f.fx.speeds[b]:f.fx.speeds._default;d=d||a.complete;return[c,a,b,d]}function m(c){if(!c||typeof c==="number"||f.fx.speeds[c])return true;if(typeof c==="string"&&!f.effects[c])return true;return false}f.effects={};f.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor",
"borderTopColor","borderColor","color","outlineColor"],function(c,a){f.fx.step[a]=function(b){if(!b.colorInit){b.start=s(b.elem,a);b.end=n(b.end);b.colorInit=true}b.elem.style[a]="rgb("+Math.max(Math.min(parseInt(b.pos*(b.end[0]-b.start[0])+b.start[0],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[1]-b.start[1])+b.start[1],10),255),0)+","+Math.max(Math.min(parseInt(b.pos*(b.end[2]-b.start[2])+b.start[2],10),255),0)+")"}});var o={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,
0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,
211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]},r=["add","remove","toggle"],t={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};f.effects.animateClass=function(c,a,b,
d){if(f.isFunction(b)){d=b;b=null}return this.queue("fx",function(){var e=f(this),g=e.attr("style")||" ",h=q(p.call(this)),l,v=e.attr("className");f.each(r,function(w,i){c[i]&&e[i+"Class"](c[i])});l=q(p.call(this));e.attr("className",v);e.animate(u(h,l),a,b,function(){f.each(r,function(w,i){c[i]&&e[i+"Class"](c[i])});if(typeof e.attr("style")=="object"){e.attr("style").cssText="";e.attr("style").cssText=g}else e.attr("style",g);d&&d.apply(this,arguments)});h=f.queue(this);l=h.splice(h.length-1,1)[0];
h.splice(1,0,l);f.dequeue(this)})};f.fn.extend({_addClass:f.fn.addClass,addClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{add:c},a,b,d]):this._addClass(c)},_removeClass:f.fn.removeClass,removeClass:function(c,a,b,d){return a?f.effects.animateClass.apply(this,[{remove:c},a,b,d]):this._removeClass(c)},_toggleClass:f.fn.toggleClass,toggleClass:function(c,a,b,d,e){return typeof a=="boolean"||a===j?b?f.effects.animateClass.apply(this,[a?{add:c}:{remove:c},b,d,e]):this._toggleClass(c,
a):f.effects.animateClass.apply(this,[{toggle:c},a,b,d])},switchClass:function(c,a,b,d,e){return f.effects.animateClass.apply(this,[{add:a,remove:c},b,d,e])}});f.extend(f.effects,{version:"1.8.11",save:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.data("ec.storage."+a[b],c[0].style[a[b]])},restore:function(c,a){for(var b=0;b<a.length;b++)a[b]!==null&&c.css(a[b],c.data("ec.storage."+a[b]))},setMode:function(c,a){if(a=="toggle")a=c.is(":hidden")?"show":"hide";return a},getBaseline:function(c,
a){var b;switch(c[0]){case "top":b=0;break;case "middle":b=0.5;break;case "bottom":b=1;break;default:b=c[0]/a.height}switch(c[1]){case "left":c=0;break;case "center":c=0.5;break;case "right":c=1;break;default:c=c[1]/a.width}return{x:c,y:b}},createWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent();var a={width:c.outerWidth(true),height:c.outerHeight(true),"float":c.css("float")},b=f("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",
border:"none",margin:0,padding:0});c.wrap(b);b=c.parent();if(c.css("position")=="static"){b.css({position:"relative"});c.css({position:"relative"})}else{f.extend(a,{position:c.css("position"),zIndex:c.css("z-index")});f.each(["top","left","bottom","right"],function(d,e){a[e]=c.css(e);if(isNaN(parseInt(a[e],10)))a[e]="auto"});c.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}return b.css(a).show()},removeWrapper:function(c){if(c.parent().is(".ui-effects-wrapper"))return c.parent().replaceWith(c);
return c},setTransition:function(c,a,b,d){d=d||{};f.each(a,function(e,g){unit=c.cssUnit(g);if(unit[0]>0)d[g]=unit[0]*b+unit[1]});return d}});f.fn.extend({effect:function(c){var a=k.apply(this,arguments),b={options:a[1],duration:a[2],callback:a[3]};a=b.options.mode;var d=f.effects[c];if(f.fx.off||!d)return a?this[a](b.duration,b.callback):this.each(function(){b.callback&&b.callback.call(this)});return d.call(this,b)},_show:f.fn.show,show:function(c){if(m(c))return this._show.apply(this,arguments);
else{var a=k.apply(this,arguments);a[1].mode="show";return this.effect.apply(this,a)}},_hide:f.fn.hide,hide:function(c){if(m(c))return this._hide.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="hide";return this.effect.apply(this,a)}},__toggle:f.fn.toggle,toggle:function(c){if(m(c)||typeof c==="boolean"||f.isFunction(c))return this.__toggle.apply(this,arguments);else{var a=k.apply(this,arguments);a[1].mode="toggle";return this.effect.apply(this,a)}},cssUnit:function(c){var a=this.css(c),
b=[];f.each(["em","px","%","pt"],function(d,e){if(a.indexOf(e)>0)b=[parseFloat(a),e]});return b}});f.easing.jswing=f.easing.swing;f.extend(f.easing,{def:"easeOutQuad",swing:function(c,a,b,d,e){return f.easing[f.easing.def](c,a,b,d,e)},easeInQuad:function(c,a,b,d,e){return d*(a/=e)*a+b},easeOutQuad:function(c,a,b,d,e){return-d*(a/=e)*(a-2)+b},easeInOutQuad:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a+b;return-d/2*(--a*(a-2)-1)+b},easeInCubic:function(c,a,b,d,e){return d*(a/=e)*a*a+b},easeOutCubic:function(c,
a,b,d,e){return d*((a=a/e-1)*a*a+1)+b},easeInOutCubic:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a+b;return d/2*((a-=2)*a*a+2)+b},easeInQuart:function(c,a,b,d,e){return d*(a/=e)*a*a*a+b},easeOutQuart:function(c,a,b,d,e){return-d*((a=a/e-1)*a*a*a-1)+b},easeInOutQuart:function(c,a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a+b;return-d/2*((a-=2)*a*a*a-2)+b},easeInQuint:function(c,a,b,d,e){return d*(a/=e)*a*a*a*a+b},easeOutQuint:function(c,a,b,d,e){return d*((a=a/e-1)*a*a*a*a+1)+b},easeInOutQuint:function(c,
a,b,d,e){if((a/=e/2)<1)return d/2*a*a*a*a*a+b;return d/2*((a-=2)*a*a*a*a+2)+b},easeInSine:function(c,a,b,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+b},easeOutSine:function(c,a,b,d,e){return d*Math.sin(a/e*(Math.PI/2))+b},easeInOutSine:function(c,a,b,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+b},easeInExpo:function(c,a,b,d,e){return a==0?b:d*Math.pow(2,10*(a/e-1))+b},easeOutExpo:function(c,a,b,d,e){return a==e?b+d:d*(-Math.pow(2,-10*a/e)+1)+b},easeInOutExpo:function(c,a,b,d,e){if(a==0)return b;if(a==
e)return b+d;if((a/=e/2)<1)return d/2*Math.pow(2,10*(a-1))+b;return d/2*(-Math.pow(2,-10*--a)+2)+b},easeInCirc:function(c,a,b,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+b},easeOutCirc:function(c,a,b,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+b},easeInOutCirc:function(c,a,b,d,e){if((a/=e/2)<1)return-d/2*(Math.sqrt(1-a*a)-1)+b;return d/2*(Math.sqrt(1-(a-=2)*a)+1)+b},easeInElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=
g/(2*Math.PI)*Math.asin(d/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g))+b},easeOutElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e)==1)return b+d;g||(g=e*0.3);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/h);return h*Math.pow(2,-10*a)*Math.sin((a*e-c)*2*Math.PI/g)+d+b},easeInOutElastic:function(c,a,b,d,e){c=1.70158;var g=0,h=d;if(a==0)return b;if((a/=e/2)==2)return b+d;g||(g=e*0.3*1.5);if(h<Math.abs(d)){h=d;c=g/4}else c=g/(2*Math.PI)*Math.asin(d/
h);if(a<1)return-0.5*h*Math.pow(2,10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)+b;return h*Math.pow(2,-10*(a-=1))*Math.sin((a*e-c)*2*Math.PI/g)*0.5+d+b},easeInBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*(a/=e)*a*((g+1)*a-g)+b},easeOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;return d*((a=a/e-1)*a*((g+1)*a+g)+1)+b},easeInOutBack:function(c,a,b,d,e,g){if(g==j)g=1.70158;if((a/=e/2)<1)return d/2*a*a*(((g*=1.525)+1)*a-g)+b;return d/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+b},easeInBounce:function(c,
a,b,d,e){return d-f.easing.easeOutBounce(c,e-a,0,d,e)+b},easeOutBounce:function(c,a,b,d,e){return(a/=e)<1/2.75?d*7.5625*a*a+b:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+b:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+b:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+b},easeInOutBounce:function(c,a,b,d,e){if(a<e/2)return f.easing.easeInBounce(c,a*2,0,d,e)*0.5+b;return f.easing.easeOutBounce(c,a*2-e,0,d,e)*0.5+d*0.5+b}})}(jQuery);
;/*
 * jQuery UI Effects Slide 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(c){c.effects.slide=function(d){return this.queue(function(){var a=c(this),h=["position","top","bottom","left","right"],f=c.effects.setMode(a,d.options.mode||"show"),b=d.options.direction||"left";c.effects.save(a,h);a.show();c.effects.createWrapper(a).css({overflow:"hidden"});var g=b=="up"||b=="down"?"top":"left";b=b=="up"||b=="left"?"pos":"neg";var e=d.options.distance||(g=="top"?a.outerHeight({margin:true}):a.outerWidth({margin:true}));if(f=="show")a.css(g,b=="pos"?isNaN(e)?"-"+e:-e:e);
var i={};i[g]=(f=="show"?b=="pos"?"+=":"-=":b=="pos"?"-=":"+=")+e;a.animate(i,{queue:false,duration:d.duration,easing:d.options.easing,complete:function(){f=="hide"&&a.hide();c.effects.restore(a,h);c.effects.removeWrapper(a);d.callback&&d.callback.apply(this,arguments);a.dequeue()}})})}})(jQuery);
;/*
 * jQuery UI Effects Transfer 1.8.11
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */
(function(e){e.effects.transfer=function(a){return this.queue(function(){var b=e(this),c=e(a.options.to),d=c.offset();c={top:d.top,left:d.left,height:c.innerHeight(),width:c.innerWidth()};d=b.offset();var f=e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(a.options.className).css({top:d.top,left:d.left,height:b.innerHeight(),width:b.innerWidth(),position:"absolute"}).animate(c,a.duration,a.options.easing,function(){f.remove();a.callback&&a.callback.apply(b[0],arguments);
b.dequeue()})})}})(jQuery);
;;
/*!
 * jQuery dragscrollable Plugin
 * version: 1.0 (25-Jun-2009)
 * Copyright (c) 2009 Miquel Herrera
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Modified by David Richard (2011)
 *   - added delegateMode option
 */
(function(e){e.fn.dragscrollable=function(t){var n=e.extend({dragSelector:">:first",acceptPropagatedEvent:!0,preventDefault:!0,delegateMode:!1},t||{}),r={mouseDownHandler:function(t){if(t.which!=1)return!1;if(!t.data.acceptPropagatedEvent){if(t.target.localName=="input"||t.target.localName=="textarea")return!0;if(t.target!=this)return!1}t.data.lastCoord={left:t.clientX,top:t.clientY},e.event.add(document,"mouseup",r.mouseUpHandler,t.data),e.event.add(document,"mousemove",r.mouseMoveHandler,t.data);if(t.data.preventDefault)return t.preventDefault(),!1},mouseMoveHandler:function(e){var t={left:e.clientX-e.data.lastCoord.left,top:e.clientY-e.data.lastCoord.top};e.data.scrollable.scrollLeft(e.data.scrollable.scrollLeft()-t.left),e.data.scrollable.scrollTop(e.data.scrollable.scrollTop()-t.top),e.data.lastCoord={left:e.clientX,top:e.clientY};if(e.data.preventDefault)return e.preventDefault(),!1},mouseUpHandler:function(t){e.event.remove(document,"mousemove",r.mouseMoveHandler),e.event.remove(document,"mouseup",r.mouseUpHandler);if(t.data.preventDefault)return t.preventDefault(),!1}};this.each(function(){var t={scrollable:e(this),acceptPropagatedEvent:n.acceptPropagatedEvent,preventDefault:n.preventDefault};n.delegateMode?e(this).delegate(n.dragSelector,"mousedown",t,r.mouseDownHandler):e(this).find(n.dragSelector).bind("mousedown",t,r.mouseDownHandler)})}})(jQuery);
/*!
 * jQuery Hotkeys Plugin
 * Copyright 2010, John Resig
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Based upon the plugin by Tzury Bar Yochay:
 * http://github.com/tzuryby/hotkeys
 *
 * Original idea by:
 * Binny V A, http://www.openjs.com/scripts/events/keyboard_shortcuts/
*/
(function(e){function t(t){if(typeof t.data!="string")return;var n=t.handler,r=t.data.toLowerCase().split(" ");t.handler=function(t){if(!(this===t.target||!/textarea|select/i.test(t.target.nodeName)&&t.target.type!=="text"))return;var i=t.type!=="keypress"&&e.hotkeys.specialKeys[t.which],s=String.fromCharCode(t.which).toLowerCase(),o,u="",a={};t.altKey&&i!=="alt"&&(u+="alt+"),t.ctrlKey&&i!=="ctrl"&&(u+="ctrl+"),t.metaKey&&!t.ctrlKey&&i!=="meta"&&(u+="meta+"),t.shiftKey&&i!=="shift"&&(u+="shift+"),i?a[u+i]=!0:(a[u+s]=!0,a[u+e.hotkeys.shiftNums[s]]=!0,u==="shift+"&&(a[e.hotkeys.shiftNums[s]]=!0));for(var f=0,l=r.length;f<l;f++)if(a[r[f]])return n.apply(this,arguments)}}e.hotkeys={version:"0.8",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},e.each(["keydown","keyup","keypress"],function(){e.event.special[this]={add:t}})})(jQuery);
/*! Copyright (c) 2010 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.4
 * 
 * Requires: 1.2.2+
 */
(function(e){function n(t){var n=t||window.event,r=[].slice.call(arguments,1),i=0,s=!0,o=0,u=0;return t=e.event.fix(n),t.type="mousewheel",t.wheelDelta&&(i=t.wheelDelta/120),t.detail&&(i=-t.detail/3),u=i,n.axis!==undefined&&n.axis===n.HORIZONTAL_AXIS&&(u=0,o=-1*i),n.wheelDeltaY!==undefined&&(u=n.wheelDeltaY/120),n.wheelDeltaX!==undefined&&(o=-1*n.wheelDeltaX/120),r.unshift(t,i,o,u),e.event.handle.apply(this,r)}var t=["DOMMouseScroll","mousewheel"];e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=t.length;e;)this.addEventListener(t[--e],n,!1);else this.onmousewheel=n},teardown:function(){if(this.removeEventListener)for(var e=t.length;e;)this.removeEventListener(t[--e],n,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})})(jQuery);
/*!
 * jQuery miniColors: A small color selector
 *
 * Copyright 2011 Cory LaViska for A Beautiful Site, LLC. (http://abeautifulsite.net/)
 *
 * Dual licensed under the MIT or GPL Version 2 licenses
 *
 */
jQuery&&function(e){e.extend(e.fn,{miniColors:function(t,n){var r=function(t,n,r){var i=m(t.val());i||(i="FFFFFF");var s=E(i),f=e('<a class="miniColors-trigger" style="background-color: #'+i+'" href="#"></a>');f.insertAfter(t),t.addClass("miniColors").attr("maxlength",7).attr("autocomplete","off"),t.data("trigger",f),t.data("hsb",s),n.change&&t.data("change",n.change),n.hide&&t.data("hide",n.hide),n.move&&t.data("move",n.move),n.readonly&&t.attr("readonly",!0),n.disabled&&o(t),f.bind("click.miniColors",function(e){e.preventDefault(),t.trigger("focus")}),t.bind("focus.miniColors",function(e){u(t)}),t.bind("blur.miniColors",function(e){var n=m(t.val());t.val(n?"#"+n:"")}),t.bind("keydown.miniColors",function(e){e.keyCode===9&&a(t)}),t.bind("keyup.miniColors",function(e){var n=t.val().replace(/[^A-F0-9#]/ig,"");t.val(n),p(t)||t.data("trigger").css("backgroundColor","#FFF")}),t.bind("paste.miniColors",function(e){setTimeout(function(){t.trigger("keyup")},5)})},i=function(t){a(),t=e(t),t.data("trigger").remove(),t.removeAttr("autocomplete"),t.removeData("trigger"),t.removeData("selector"),t.removeData("hsb"),t.removeData("huePicker"),t.removeData("colorPicker"),t.removeData("mousebutton"),t.removeData("moving"),t.unbind("click.miniColors"),t.unbind("focus.miniColors"),t.unbind("blur.miniColors"),t.unbind("keyup.miniColors"),t.unbind("keydown.miniColors"),t.unbind("paste.miniColors")},s=function(e){e.attr("disabled",!1),e.data("trigger").css("opacity",1)},o=function(e){e.attr("disabled",!0),e.data("trigger").css("opacity",.5),a(e)},u=function(t){if(t.attr("disabled"))return!1;a();var n=e('<div class="miniColors-selector"></div>');n.append('<div class="miniColors-colors" style="background-color: #FFF;"><div class="miniColors-colorPicker"></div></div>'),n.append('<div class="miniColors-hues"><div class="miniColors-huePicker"></div></div>'),n.css({top:t.is(":visible")?t.offset().top+t.outerHeight():t.data("trigger").offset().top+t.data("trigger").outerHeight(),left:t.is(":visible")?t.offset().left:t.data("trigger").offset().left-87,display:"none"}).addClass(t.attr("class"));var r=t.data("hsb");n.find(".miniColors-colors").css("backgroundColor","#"+S({h:r.h,s:100,b:100}));var i=t.data("colorPosition");i||(i=d(r)),n.find(".miniColors-colorPicker").css("top",i.y+"px").css("left",i.x+"px");var s=t.data("huePosition");s||(s=v(r)),n.find(".miniColors-huePicker").css("top",s.y+"px"),t.data("selector",n),t.data("huePicker",n.find(".miniColors-huePicker")),t.data("colorPicker",n.find(".miniColors-colorPicker")),t.data("mousebutton",0);var o=e("<div class='miniColors-overlay no-select'/>").css({position:"absolute",left:0,top:0,width:"100%",height:"100%","z-index":1e4}).appendTo("BODY").mousedown(function(){a(t),o.remove()});e("BODY").append(n),n.fadeIn(100),n.bind("selectstart",function(){return!1}),n.bind("mousedown.miniColors",function(n){t.data("mousebutton",1),e(n.target).hasClass("miniColors-colors")&&(n.preventDefault(),t.data("moving","colors"),f(t,n)),e(n.target).hasClass("miniColors-hues")&&(n.preventDefault(),t.data("moving","hues"),l(t,n)),t.data("move")&&t.data("move").call(t,t.val())}),n.bind("mouseup.miniColors",function(e){t.data("mousebutton",0),t.removeData("moving")}),n.bind("mousemove.miniColors",function(e){t.data("mousebutton")===1&&(t.data("moving")==="colors"&&f(t,e),t.data("moving")==="hues"&&l(t,e),t.data("move")&&t.data("move").call(t,t.val()))})},a=function(t){t&&t.data("hide")&&t.data("hide").call(t,t.val()),t||(t=".miniColors"),e(t).each(function(){var t=e(this).data("selector");e(this).removeData("selector"),e(t).fadeOut(100,function(){e(this).remove()})})},f=function(t,n){var r=t.data("colorPicker");r.hide();var i={x:n.clientX-t.data("selector").find(".miniColors-colors").offset().left+e(document).scrollLeft()-5,y:n.clientY-t.data("selector").find(".miniColors-colors").offset().top+e(document).scrollTop()-5};i.x<=-5&&(i.x=-5),i.x>=144&&(i.x=144),i.y<=-5&&(i.y=-5),i.y>=144&&(i.y=144),t.data("colorPosition",i),r.css("left",i.x).css("top",i.y).show();var s=Math.round((i.x+5)*.67);s<0&&(s=0),s>100&&(s=100);var o=100-Math.round((i.y+5)*.67);o<0&&(o=0),o>100&&(o=100);var u=t.data("hsb");u.s=s,u.b=o,c(t,u,!0)},l=function(t,n){var r=t.data("huePicker");r.hide();var i={y:n.clientY-t.data("selector").find(".miniColors-colors").offset().top+e(document).scrollTop()-1};i.y<=-1&&(i.y=-1),i.y>=149&&(i.y=149),t.data("huePosition",i),r.css("top",i.y).show();var s=Math.round((150-i.y-1)*2.4);s<0&&(s=0),s>360&&(s=360);var o=t.data("hsb");o.h=s,c(t,o,!0)},c=function(e,t,n){e.data("hsb",t);var r=S(t);n&&e.val("#"+r),e.data("trigger").css("backgroundColor","#"+r),e.data("selector")&&e.data("selector").find(".miniColors-colors").css("backgroundColor","#"+S({h:t.h,s:100,b:100})),e.data("change")&&e.data("change").call(e,"#"+r,g(t))},p=function(t){var n=m(t.val());if(!n)return!1;var r=E(n),i=t.data("hsb");if(r.h===i.h&&r.s===i.s&&r.b===i.b)return!0;var s=d(r),o=e(t.data("colorPicker"));o.css("top",s.y+"px").css("left",s.x+"px");var u=v(r),a=e(t.data("huePicker"));return a.css("top",u.y+"px"),c(t,r,!1),!0},d=function(e){var t=Math.ceil(e.s/.67);t<0&&(t=0),t>150&&(t=150);var n=150-Math.ceil(e.b/.67);return n<0&&(n=0),n>150&&(n=150),{x:t-5,y:n-5}},v=function(e){var t=150-e.h/2.4;return t<0&&(h=0),t>150&&(h=150),{y:t-1}},m=function(e){return e=e.replace(/[^A-Fa-f0-9]/,""),e.length==3&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),e.length===6?e:null},g=function(e){var t={},n=Math.round(e.h),r=Math.round(e.s*255/100),i=Math.round(e.b*255/100);if(r==0)t.r=t.g=t.b=i;else{var s=i,o=(255-r)*i/255,u=(s-o)*(n%60)/60;n==360&&(n=0),n<60?(t.r=s,t.b=o,t.g=o+u):n<120?(t.g=s,t.b=o,t.r=s-u):n<180?(t.g=s,t.r=o,t.b=o+u):n<240?(t.b=s,t.r=o,t.g=s-u):n<300?(t.b=s,t.g=o,t.r=o+u):n<360?(t.r=s,t.g=o,t.b=s-u):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},y=function(t){var n=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(n,function(e,t){t.length==1&&(n[e]="0"+t)}),n.join("")},b=function(e){var e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(e&65280)>>8,b:e&255}},w=function(e){var t={h:0,s:0,b:0},n=Math.min(e.r,e.g,e.b),r=Math.max(e.r,e.g,e.b),i=r-n;return t.b=r,t.s=r!=0?255*i/r:0,t.s!=0?e.r==r?t.h=(e.g-e.b)/i:e.g==r?t.h=2+(e.b-e.r)/i:t.h=4+(e.r-e.g)/i:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},E=function(e){var t=w(b(e));return t.s===0&&(t.h=360),t},S=function(e){return y(g(e))};switch(t){case"readonly":return e(this).each(function(){e(this).attr("readonly",n)}),e(this);case"disabled":return e(this).each(function(){n?o(e(this)):s(e(this))}),e(this);case"value":return e(this).each(function(){e(this).val(n).trigger("keyup")}),e(this);case"destroy":return e(this).each(function(){i(e(this))}),e(this);default:return t||(t={}),e(this).each(function(){if(e(this)[0].tagName.toLowerCase()!=="input")return;if(e(this).data("trigger"))return;r(e(this),t,n)}),e(this)}}})}(jQuery);
/*!
 * jQuery Templates Plugin 1.0.0pre
 * http://github.com/jquery/jquery-tmpl
 * Requires jQuery 1.4.2
 *
 * Copyright Software Freedom Conservancy, Inc.
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
(function(e,t){function h(t,n,r,i){var u={data:i||i===0||i===!1?i:n?n.data:{},_wrap:n?n._wrap:null,tmpl:null,parent:n||null,nodes:[],calls:w,nest:E,wrap:S,html:x,update:T};return t&&e.extend(u,t,{nodes:[],parent:n}),r&&(u.tmpl=r,u._ctnt=u._ctnt||u.tmpl(e,u),u.key=++f,(c.length?o:s)[f]=u),u}function p(t,n,i){var s,o=i?e.map(i,function(e){return typeof e=="string"?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+r+'="'+t.key+'" $2'):e:p(e,t,e._ctnt)}):t;return n?o:(o=o.join(""),o.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,n,r,i){s=e(r).get(),b(s),n&&(s=d(n).concat(s)),i&&(s=s.concat(d(i)))}),s?s:d(o))}function d(t){var n=document.createElement("div");return n.innerHTML=t,e.makeArray(n.childNodes)}function v(t){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,n,r,i,s,o,u){var a=e.tmpl.tag[r],f,l,c;if(!a)throw"Unknown template tag: "+r;return f=a._default||[],o&&!/\w$/.test(s)&&(s+=o,o=""),s?(s=g(s),u=u?","+g(u)+")":o?")":"",l=o?s.indexOf(".")>-1?s+g(o):"("+s+").call($item"+u:s,c=o?l:"(typeof("+s+")==='function'?("+s+").call($item):("+s+"))"):c=l=f.$1||"null",i=g(i),"');"+a[n?"close":"open"].split("$notnull_1").join(s?"typeof("+s+")!=='undefined' && ("+s+")!=null":"true").split("$1a").join(c).split("$1").join(l).split("$2").join(i||f.$2||"")+"__.push('"})+"');}return __;")}function m(t,n){t._wrap=p(t,!0,e.isArray(n)?n:[i.test(n)?n:e(n).html()]).join("")}function g(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function y(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function b(t){function v(t){function v(e){e+=n,p=a[e]=a[e]||h(p,s[p.parent.key+n]||p.parent)}var i,u=t,c,p,d;if(d=t.getAttribute(r)){while(u.parentNode&&(u=u.parentNode).nodeType===1&&!(i=u.getAttribute(r)));i!==d&&(u=u.parentNode?u.nodeType===11?0:u.getAttribute(r)||0:0,(p=s[d])||(p=o[d],p=h(p,s[u]||o[u]),p.key=++f,s[f]=p),l&&v(d)),t.removeAttribute(r)}else l&&(p=e.data(t,"tmplItem"))&&(v(p.key),s[p.key]=p,u=e.data(t.parentNode,"tmplItem"),u=u?u.key:0);if(p){c=p;while(c&&c.key!=u)c.nodes.push(t),c=c.parent;delete p._ctnt,delete p._wrap,e.data(t,"tmplItem",p)}}var n="_"+l,i,u,a={},c,p,d;for(c=0,p=t.length;c<p;c++){if((i=t[c]).nodeType!==1)continue;u=i.getElementsByTagName("*");for(d=u.length-1;d>=0;d--)v(u[d]);v(i)}}function w(e,t,n,r){if(!e)return c.pop();c.push({_:e,tmpl:t,item:this,data:n,options:r})}function E(t,n,r){return e.tmpl(e.template(t),n,r,this)}function S(t,n){var r=t.options||{};return r.wrapped=n,e.tmpl(e.template(t.tmpl),t.data,r,t.item)}function x(t,n){var r=this._wrap;return e.map(e(e.isArray(r)?r.join(""):r).filter(t||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||y(e)})}function T(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]),e(t).remove()}var n=e.fn.domManip,r="_tmplitem",i=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,s={},o={},u,a={key:0,data:{}},f=0,l=0,c=[];e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,n){e.fn[t]=function(r){var i=[],o=e(r),a,f,c,h,p=this.length===1&&this[0].parentNode;u=s||{};if(p&&p.nodeType===11&&p.childNodes.length===1&&o.length===1)o[n](this[0]),i=this;else{for(f=0,c=o.length;f<c;f++)l=f,a=(f>0?this.clone(!0):this).get(),e(o[f])[n](a),i=i.concat(a);l=0,i=this.pushStack(i,t,o.selector)}return h=u,u=null,e.tmpl.complete(h),i}}),e.fn.extend({tmpl:function(t,n,r){return e.tmpl(this[0],t,n,r)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(t,r,i,o){if(t[0]&&e.isArray(t[0])){var a=e.makeArray(arguments),f=t[0],c=f.length,h=0,p;while(h<c&&!(p=e.data(f[h++],"tmplItem")));p&&l&&(a[2]=function(t){e.tmpl.afterManip(this,t,i)}),n.apply(this,a)}else n.apply(this,arguments);return l=0,u||e.tmpl.complete(s),this}}),e.extend({tmpl:function(t,n,r,i){var u,f=!i;if(f)i=a,t=e.template[t]||e.template(null,t),o={};else if(!t)return t=i.tmpl,s[i.key]=i,i.nodes=[],i.wrapped&&m(i,i.wrapped),e(p(i,null,i.tmpl(e,i)));return t?(typeof n=="function"&&(n=n.call(i||{})),r&&r.wrapped&&m(r,r.wrapped),u=e.isArray(n)?e.map(n,function(e){return e?h(r,i,t,e):null}):[h(r,i,t,n)],f?e(p(i,null,u)):u):[]},tmplItem:function(t){var n;t instanceof e&&(t=t[0]);while(t&&t.nodeType===1&&!(n=e.data(t,"tmplItem"))&&(t=t.parentNode));return n||a},template:function(t,n){return n?(typeof n=="string"?n=v(n):n instanceof e&&(n=n[0]||{}),n.nodeType&&(n=e.data(n,"tmpl")||e.data(n,"tmpl",v(n.innerHTML))),typeof t=="string"?e.template[t]=n:n):t?typeof t!="string"?e.template(null,t):e.template[t]||e.template(null,i.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(e){s={}},afterManip:function(n,r,i){var s=r.nodeType===11?e.makeArray(r.childNodes):r.nodeType===1?[r]:[];i.call(n,r),b(s),l++}})})(jQuery);
/*!	SWFObject v2.2 <http://code.google.com/p/swfobject/> 
	is released under the MIT License <http://www.opensource.org/licenses/mit-license.php> 
*/
var swfobject=function(){function C(){if(b)return;try{var e=a.getElementsByTagName("body")[0].appendChild(U("span"));e.parentNode.removeChild(e)}catch(t){return}b=!0;var n=c.length;for(var r=0;r<n;r++)c[r]()}function k(e){b?e():c[c.length]=e}function L(t){if(typeof u.addEventListener!=e)u.addEventListener("load",t,!1);else if(typeof a.addEventListener!=e)a.addEventListener("load",t,!1);else if(typeof u.attachEvent!=e)z(u,"onload",t);else if(typeof u.onload=="function"){var n=u.onload;u.onload=function(){n(),t()}}else u.onload=t}function A(){l?O():M()}function O(){var n=a.getElementsByTagName("body")[0],r=U(t);r.setAttribute("type",i);var s=n.appendChild(r);if(s){var o=0;(function(){if(typeof s.GetVariable!=e){var t=s.GetVariable("$version");t&&(t=t.split(" ")[1].split(","),T.pv=[parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10)])}else if(o<10){o++,setTimeout(arguments.callee,10);return}n.removeChild(r),s=null,M()})()}else M()}function M(){var t=h.length;if(t>0)for(var n=0;n<t;n++){var r=h[n].id,i=h[n].callbackFn,s={success:!1,id:r};if(T.pv[0]>0){var o=R(r);if(o)if(W(h[n].swfVersion)&&!(T.wk&&T.wk<312))V(r,!0),i&&(s.success=!0,s.ref=_(r),i(s));else if(h[n].expressInstall&&D()){var u={};u.data=h[n].expressInstall,u.width=o.getAttribute("width")||"0",u.height=o.getAttribute("height")||"0",o.getAttribute("class")&&(u.styleclass=o.getAttribute("class")),o.getAttribute("align")&&(u.align=o.getAttribute("align"));var a={},f=o.getElementsByTagName("param"),l=f.length;for(var c=0;c<l;c++)f[c].getAttribute("name").toLowerCase()!="movie"&&(a[f[c].getAttribute("name")]=f[c].getAttribute("value"));P(u,a,r,i)}else H(o),i&&i(s)}else{V(r,!0);if(i){var p=_(r);p&&typeof p.SetVariable!=e&&(s.success=!0,s.ref=p),i(s)}}}}function _(n){var r=null,i=R(n);if(i&&i.nodeName=="OBJECT")if(typeof i.SetVariable!=e)r=i;else{var s=i.getElementsByTagName(t)[0];s&&(r=s)}return r}function D(){return!w&&W("6.0.65")&&(T.win||T.mac)&&!(T.wk&&T.wk<312)}function P(t,n,r,i){w=!0,g=i||null,y={success:!1,id:r};var o=R(r);if(o){o.nodeName=="OBJECT"?(v=B(o),m=null):(v=o,m=r),t.id=s;if(typeof t.width==e||!/%$/.test(t.width)&&parseInt(t.width,10)<310)t.width="310";if(typeof t.height==e||!/%$/.test(t.height)&&parseInt(t.height,10)<137)t.height="137";a.title=a.title.slice(0,47)+" - Flash Player Installation";var f=T.ie&&T.win?"ActiveX":"PlugIn",l="MMredirectURL="+u.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+a.title;typeof n.flashvars!=e?n.flashvars+="&"+l:n.flashvars=l;if(T.ie&&T.win&&o.readyState!=4){var c=U("div");r+="SWFObjectNew",c.setAttribute("id",r),o.parentNode.insertBefore(c,o),o.style.display="none",function(){o.readyState==4?o.parentNode.removeChild(o):setTimeout(arguments.callee,10)}()}j(t,n,r)}}function H(e){if(T.ie&&T.win&&e.readyState!=4){var t=U("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(B(e),t),e.style.display="none",function(){e.readyState==4?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(B(e),e)}function B(e){var n=U("div");if(T.win&&T.ie)n.innerHTML=e.innerHTML;else{var r=e.getElementsByTagName(t)[0];if(r){var i=r.childNodes;if(i){var s=i.length;for(var o=0;o<s;o++)(i[o].nodeType!=1||i[o].nodeName!="PARAM")&&i[o].nodeType!=8&&n.appendChild(i[o].cloneNode(!0))}}}return n}function j(n,r,s){var o,u=R(s);if(T.wk&&T.wk<312)return o;if(u){typeof n.id==e&&(n.id=s);if(T.ie&&T.win){var a="";for(var f in n)n[f]!=Object.prototype[f]&&(f.toLowerCase()=="data"?r.movie=n[f]:f.toLowerCase()=="styleclass"?a+=' class="'+n[f]+'"':f.toLowerCase()!="classid"&&(a+=" "+f+'="'+n[f]+'"'));var l="";for(var c in r)r[c]!=Object.prototype[c]&&(l+='<param name="'+c+'" value="'+r[c]+'" />');u.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+a+">"+l+"</object>",p[p.length]=n.id,o=R(n.id)}else{var h=U(t);h.setAttribute("type",i);for(var d in n)n[d]!=Object.prototype[d]&&(d.toLowerCase()=="styleclass"?h.setAttribute("class",n[d]):d.toLowerCase()!="classid"&&h.setAttribute(d,n[d]));for(var v in r)r[v]!=Object.prototype[v]&&v.toLowerCase()!="movie"&&F(h,v,r[v]);u.parentNode.replaceChild(h,u),o=h}}return o}function F(e,t,n){var r=U("param");r.setAttribute("name",t),r.setAttribute("value",n),e.appendChild(r)}function I(e){var t=R(e);t&&t.nodeName=="OBJECT"&&(T.ie&&T.win?(t.style.display="none",function(){t.readyState==4?q(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function q(e){var t=R(e);if(t){for(var n in t)typeof t[n]=="function"&&(t[n]=null);t.parentNode.removeChild(t)}}function R(e){var t=null;try{t=a.getElementById(e)}catch(n){}return t}function U(e){return a.createElement(e)}function z(e,t,n){e.attachEvent(t,n),d[d.length]=[e,t,n]}function W(e){var t=T.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function X(n,r,i,s){if(T.ie&&T.mac)return;var o=a.getElementsByTagName("head")[0];if(!o)return;var u=i&&typeof i=="string"?i:"screen";s&&(E=null,S=null);if(!E||S!=u){var f=U("style");f.setAttribute("type","text/css"),f.setAttribute("media",u),E=o.appendChild(f),T.ie&&T.win&&typeof a.styleSheets!=e&&a.styleSheets.length>0&&(E=a.styleSheets[a.styleSheets.length-1]),S=u}T.ie&&T.win?E&&typeof E.addRule==t&&E.addRule(n,r):E&&typeof a.createTextNode!=e&&E.appendChild(a.createTextNode(n+" {"+r+"}"))}function V(e,t){if(!x)return;var n=t?"visible":"hidden";b&&R(e)?R(e).style.visibility=n:X("#"+e,"visibility:"+n)}function $(t){var n=/[\\\"<>\.;]/,r=n.exec(t)!=null;return r&&typeof encodeURIComponent!=e?encodeURIComponent(t):t}var e="undefined",t="object",n="Shockwave Flash",r="ShockwaveFlash.ShockwaveFlash",i="application/x-shockwave-flash",s="SWFObjectExprInst",o="onreadystatechange",u=window,a=document,f=navigator,l=!1,c=[A],h=[],p=[],d=[],v,m,g,y,b=!1,w=!1,E,S,x=!0,T=function(){var s=typeof a.getElementById!=e&&typeof a.getElementsByTagName!=e&&typeof a.createElement!=e,o=f.userAgent.toLowerCase(),c=f.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(o),p=c?/mac/.test(c):/mac/.test(o),d=/webkit/.test(o)?parseFloat(o.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,v=!1,m=[0,0,0],g=null;if(typeof f.plugins!=e&&typeof f.plugins[n]==t)g=f.plugins[n].description,g&&(typeof f.mimeTypes==e||!f.mimeTypes[i]||!!f.mimeTypes[i].enabledPlugin)&&(l=!0,v=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),m[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),m[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),m[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof u.ActiveXObject!=e)try{var y=new ActiveXObject(r);y&&(g=y.GetVariable("$version"),g&&(v=!0,g=g.split(" ")[1].split(","),m=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]))}catch(b){}return{w3:s,pv:m,wk:d,ie:v,win:h,mac:p}}(),N=function(){if(!T.w3)return;(typeof a.readyState!=e&&a.readyState=="complete"||typeof a.readyState==e&&(a.getElementsByTagName("body")[0]||a.body))&&C(),b||(typeof a.addEventListener!=e&&a.addEventListener("DOMContentLoaded",C,!1),T.ie&&T.win&&(a.attachEvent(o,function(){a.readyState=="complete"&&(a.detachEvent(o,arguments.callee),C())}),u==top&&function(){if(b)return;try{a.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}C()}()),T.wk&&function(){if(b)return;if(!/loaded|complete/.test(a.readyState)){setTimeout(arguments.callee,0);return}C()}(),L(C))}(),J=function(){T.ie&&T.win&&window.attachEvent("onunload",function(){var e=d.length;for(var t=0;t<e;t++)d[t][0].detachEvent(d[t][1],d[t][2]);var n=p.length;for(var r=0;r<n;r++)I(p[r]);for(var i in T)T[i]=null;T=null;for(var s in swfobject)swfobject[s]=null;swfobject=null})}();return{registerObject:function(e,t,n,r){if(T.w3&&e&&t){var i={};i.id=e,i.swfVersion=t,i.expressInstall=n,i.callbackFn=r,h[h.length]=i,V(e,!1)}else r&&r({success:!1,id:e})},getObjectById:function(e){if(T.w3)return _(e)},embedSWF:function(n,r,i,s,o,u,a,f,l,c){var h={success:!1,id:r};T.w3&&!(T.wk&&T.wk<312)&&n&&r&&i&&s&&o?(V(r,!1),k(function(){i+="",s+="";var p={};if(l&&typeof l===t)for(var d in l)p[d]=l[d];p.data=n,p.width=i,p.height=s;var v={};if(f&&typeof f===t)for(var m in f)v[m]=f[m];if(a&&typeof a===t)for(var g in a)typeof v.flashvars!=e?v.flashvars+="&"+g+"="+a[g]:v.flashvars=g+"="+a[g];if(W(o)){var y=j(p,v,r);p.id==r&&V(r,!0),h.success=!0,h.ref=y}else{if(u&&D()){p.data=u,P(p,v,r,c);return}V(r,!0)}c&&c(h)})):c&&c(h)},switchOffAutoHideShow:function(){x=!1},ua:T,getFlashPlayerVersion:function(){return{major:T.pv[0],minor:T.pv[1],release:T.pv[2]}},hasFlashPlayerVersion:W,createSWF:function(e,t,n){return T.w3?j(e,t,n):undefined},showExpressInstall:function(e,t,n,r){T.w3&&D()&&P(e,t,n,r)},removeSWF:function(e){T.w3&&I(e)},createCSS:function(e,t,n,r){T.w3&&X(e,t,n,r)},addDomLoadEvent:k,addLoadEvent:L,getQueryParamValue:function(e){var t=a.location.search||a.location.hash;if(t){/\?/.test(t)&&(t=t.split("?")[1]);if(e==null)return $(t);var n=t.split("&");for(var r=0;r<n.length;r++)if(n[r].substring(0,n[r].indexOf("="))==e)return $(n[r].substring(n[r].indexOf("=")+1))}return""},expressInstallCallback:function(){if(w){var e=R(s);e&&v&&(e.parentNode.replaceChild(v,e),m&&(V(m,!0),T.ie&&T.win&&(v.style.display="block")),g&&g(y)),w=!1}}}}();
/*! Downloadify 0.2 (c) 2009 by Douglas Neiner. Licensed under the MIT license */
/*! Downloadify 0.2 (c) 2009 by Douglas Neiner. Licensed under the MIT license */
/* See http://github.com/dcneiner/Downloadify for license and more info */
(function(){Downloadify=window.Downloadify={queue:{},uid:new Date().getTime(),getTextForSave:function(a){var b=Downloadify.queue[a];if(b)return b.getData();return""},getFileNameForSave:function(a){var b=Downloadify.queue[a];if(b)return b.getFilename();return""},getDataTypeForSave:function(a){var b=Downloadify.queue[a];if(b)return b.getDataType();return""},saveComplete:function(a){var b=Downloadify.queue[a];if(b)b.complete();return true},saveCancel:function(a){var b=Downloadify.queue[a];if(b)b.cancel();return true},saveError:function(a){var b=Downloadify.queue[a];if(b)b.error();return true},addToQueue:function(a){Downloadify.queue[a.queue_name]=a},getUID:function(a){if(a.id=="")a.id='downloadify_'+Downloadify.uid++;return a.id}};Downloadify.create=function(a,b){var c=(typeof(a)=="string"?document.getElementById(a):a);return new Downloadify.Container(c,b)};Downloadify.Container=function(d,e){var f=this;f.el=d;f.enabled=true;f.dataCallback=null;f.filenameCallback=null;f.data=null;f.filename=null;var g=function(){f.options=e;if(!f.options.append)f.el.innerHTML="";f.flashContainer=document.createElement('span');f.el.appendChild(f.flashContainer);f.queue_name=Downloadify.getUID(f.flashContainer);if(typeof(f.options.filename)==="function")f.filenameCallback=f.options.filename;else if(f.options.filename)f.filename=f.options.filename;if(typeof(f.options.data)==="function")f.dataCallback=f.options.data;else if(f.options.data)f.data=f.options.data;var a={queue_name:f.queue_name,width:f.options.width,height:f.options.height};var b={allowScriptAccess:'always'};var c={id:f.flashContainer.id,name:f.flashContainer.id};if(f.options.enabled===false)f.enabled=false;if(f.options.transparent===true)b.wmode="transparent";if(f.options.downloadImage)a.downloadImage=f.options.downloadImage;swfobject.embedSWF(f.options.swf,f.flashContainer.id,f.options.width,f.options.height,"10",null,a,b,c);Downloadify.addToQueue(f)};f.enable=function(){var a=document.getElementById(f.flashContainer.id);a.setEnabled(true);f.enabled=true};f.disable=function(){var a=document.getElementById(f.flashContainer.id);a.setEnabled(false);f.enabled=false};f.getData=function(){if(!f.enabled)return"";if(f.dataCallback)return f.dataCallback();else if(f.data)return f.data;else return""};f.getFilename=function(){if(f.filenameCallback)return f.filenameCallback();else if(f.filename)return f.filename;else return""};f.getDataType=function(){if(f.options.dataType)return f.options.dataType;return"string"};f.complete=function(){if(typeof(f.options.onComplete)==="function")f.options.onComplete()};f.cancel=function(){if(typeof(f.options.onCancel)==="function")f.options.onCancel()};f.error=function(){if(typeof(f.options.onError)==="function")f.options.onError()};g()};Downloadify.defaultOptions={swf:'media/downloadify.swf',downloadImage:'images/download.png',width:100,height:30,transparent:true,append:false,dataType:"string"}})();if(typeof(jQuery)!="undefined"){(function($){$.fn.downloadify=function(b){return this.each(function(){b=$.extend({},Downloadify.defaultOptions,b);var a=Downloadify.create(this,b);$(this).data('Downloadify',a)})}})(jQuery)};if(typeof(MooTools)!='undefined'){Element.implement({downloadify:function(a){a=$merge(Downloadify.defaultOptions,a);return this.store('Downloadify',Downloadify.create(this,a))}})};;
/*!
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
var EventEmitter=function(){};EventEmitter.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},EventEmitter.prototype.emit=function(e){if(e==="error")if(!this._events||!this._events.error||Array.isArray(this._events.error)&&!this._events.error.length)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if(typeof t=="function"){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return!0}if(Array.isArray(t)){var n=Array.prototype.slice.call(arguments,1),r=t.slice();for(var i=0,s=r.length;i<s;i++)r[i].apply(this,n);return!0}return!1},EventEmitter.prototype.publish=EventEmitter.prototype.emit,EventEmitter.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");this._events||(this._events={}),this.emit("newListener",e,t);if(!this._events[e])this._events[e]=t;else if(Array.isArray(this._events[e])){this._events[e].push(t);if(!this._events[e].warned){var n;this._events.maxListeners!==undefined?n=this._events.maxListeners:n=10,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}else this._events[e]=[this._events[e],t];return this},EventEmitter.prototype.on=EventEmitter.prototype.subscribe=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){function r(){n.removeListener(e,r),t.apply(this,arguments)}if("function"!=typeof t)throw new Error(".once only takes instances of Function");var n=this;return r.listener=t,n.on(e,r),this},EventEmitter.prototype.removeListener=function(e,t){if("function"!=typeof t)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var n=this._events[e];if(Array.isArray(n)){var r=-1;for(var i=0,s=n.length;i<s;i++)if(n[i]===t||n[i].listener&&n[i].listener===t){r=i;break}if(r<0)return this;n.splice(r,1),n.length==0&&delete this._events[e]}else(n===t||n.listener&&n.listener===t)&&delete this._events[e];return this},EventEmitter.prototype.unsubscribe=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(e){return arguments.length===0?(this._events={},this):(e&&this._events&&this._events[e]&&(this._events[e]=null),this)},EventEmitter.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),Array.isArray(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},EventEmitter.mixin=function(e){for(var t in EventEmitter.prototype)e.prototype[t]||(e.prototype[t]=EventEmitter.prototype[t])};
/*!
 *  mindmaps - a HTML5 powered mind mapping application
 *  Copyright (C) 2011  David Richard
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as
 *  published by the Free Software Foundation, either version 3 of the
 *  License, or (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
"use strict";function removeEventLayerXY(){var e=$.event.props,t=e.length,n=[];while(t--){var r=e[t];r!="layerX"&&r!="layerY"&&n.push(r)}$.event.props=n}function addUnloadHook(){window.onbeforeunload=function(e){var t="Are you sure? Any unsaved progress will be lost.";return e=e||window.event,e&&(e.returnValue=t),t}}function trackErrors(){window.onerror=function(e,t,n){if(!window._gaq)return;return _gaq.push(["_trackEvent","Error Log",e,t+"_"+n]),!1}}function setupConsole(){var e=function(){},t=window.console||{};["log","info","debug","warn","error"].forEach(function(n){t[n]=t[n]||e}),mindmaps.DEBUG||(t.debug=e,t.info=e,t.log=e,t.warn=e,t.error=function(e){window.alert("Error: "+e)}),window.console=t}function createECMA5Shims(){if(!Function.prototype.bind){var e=Array.prototype.slice;Function.prototype.bind=function(n){function s(){if(this instanceof s){var t=Object.create(r.prototype);return r.apply(t,i.concat(e.call(arguments))),t}return r.call.apply(r,i.concat(e.call(arguments)))}var r=this;if(typeof r.apply!="function"||typeof r.call!="function")return new TypeError;var i=e.call(arguments);return s.length=typeof r=="function"?Math.max(r.length-i.length,0):0,s}}Array.isArray||(Array.isArray=function(t){return Object.prototype.toString.call(t)==="[object Array]"}),Array.prototype.forEach||(Array.prototype.forEach=function(t,n){var r=+this.length;for(var i=0;i<r;i++)i in this&&t.call(n,this[i],i,this)}),Array.prototype.map||(Array.prototype.map=function(t){var n=+this.length;if(typeof t!="function")throw new TypeError;var r=new Array(n),i=arguments[1];for(var s=0;s<n;s++)s in this&&(r[s]=t.call(i,this[s],s,this));return r}),Array.prototype.filter||(Array.prototype.filter=function(t){var n=[],r=arguments[1];for(var i=0;i<this.length;i++)t.call(r,this[i])&&n.push(this[i]);return n}),Array.prototype.every||(Array.prototype.every=function(t){var n=arguments[1];for(var r=0;r<this.length;r++)if(!t.call(n,this[r]))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t){var n=arguments[1];for(var r=0;r<this.length;r++)if(t.call(n,this[r]))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var n=+this.length;if(typeof t!="function")throw new TypeError;if(n===0&&arguments.length===1)throw new TypeError;var r=0;if(arguments.length>=2)var i=arguments[1];else do{if(r in this){i=this[r++];break}if(++r>=n)throw new TypeError}while(!0);for(;r<n;r++)r in this&&(i=t.call(null,i,this[r],r,this));return i}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var n=+this.length;if(typeof t!="function")throw new TypeError;if(n===0&&arguments.length===1)throw new TypeError;var r,i=n-1;if(arguments.length>=2)r=arguments[1];else do{if(i in this){r=this[i--];break}if(--i<0)throw new TypeError}while(!0);for(;i>=0;i--)i in this&&(r=t.call(null,r,this[i],i,this));return r}),Array.prototype.indexOf||(Array.prototype.indexOf=function(t){var n=this.length;if(!n)return-1;var r=arguments[1]||0;if(r>=n)return-1;r<0&&(r+=n);for(;r<n;r++){if(!(r in this))continue;if(t===this[r])return r}return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){var n=this.length;if(!n)return-1;var r=arguments[1]||n;r<0&&(r+=n),r=Math.min(r,n-1);for(;r>=0;r--){if(!(r in this))continue;if(t===this[r])return r}return-1}),Date.now||(Date.now=function(){return(new Date).getTime()})}function createHTML5Shims(){typeof window.localStorage=="undefined"&&(window.localStorage={getItem:function(){return null},setItem:function(){},clear:function(){},removeItem:function(){},length:0,key:function(){return null}})}var mindmaps=mindmaps||{};mindmaps.VERSION="0.7.2",window.addEventListener("load",function(e){window.applicationCache.addEventListener("updateready",function(e){window.applicationCache.status==window.applicationCache.UPDATEREADY&&(window.applicationCache.swapCache(),window.onbeforeunload=null,confirm("A new version of the app is available. Load it?")&&window.location.reload())},!1)},!1),$(function(){removeEventLayerXY(),createECMA5Shims(),createHTML5Shims(),setupConsole(),trackErrors(),mindmaps.DEBUG||addUnloadHook();var e=new mindmaps.ApplicationController;e.go()}),$(function(){$("#bottombar table").remove(),$("input[name='hosted_button_id']").val("123")});
mindmaps.Command=function(){this.id="BASE_COMMAND",this.shortcut=null,this.handler=null,this.label=null,this.description=null,this.enabled=!1},mindmaps.Command.Event={HANDLER_REGISTERED:"HandlerRegisteredCommandEvent",HANDLER_REMOVED:"HandlerRemovedCommandEvent",ENABLED_CHANGED:"EnabledChangedCommandEvent"},mindmaps.Command.prototype={execute:function(){this.handler?(this.handler(),mindmaps.DEBUG&&console.log("handler called for",this.id)):mindmaps.DEBUG&&console.log("no handler found for",this.id)},setHandler:function(e){this.removeHandler(),this.handler=e,this.publish(mindmaps.Command.Event.HANDLER_REGISTERED)},removeHandler:function(){this.handler=null,this.publish(mindmaps.Command.Event.HANDLER_REMOVED)},setEnabled:function(e){this.enabled=e,this.publish(mindmaps.Command.Event.ENABLED_CHANGED,e)}},EventEmitter.mixin(mindmaps.Command),mindmaps.CreateNodeCommand=function(){this.id="CREATE_NODE_COMMAND",this.shortcut="tab",this.label="Add",this.icon="ui-icon-plusthick",this.description="Creates a new node"},mindmaps.CreateNodeCommand.prototype=new mindmaps.Command,mindmaps.CreateSiblingNodeCommand=function(){this.id="CREATE_SIBLING_NODE_COMMAND",this.shortcut="shift+tab",this.label="Add",this.icon="ui-icon-plusthick",this.description="Creates a new sibling node"},mindmaps.CreateSiblingNodeCommand.prototype=new mindmaps.Command,mindmaps.DeleteNodeCommand=function(){this.id="DELETE_NODE_COMMAND",this.shortcut=["del","backspace"],this.label="Delete",this.icon="ui-icon-minusthick",this.description="Deletes a new node"},mindmaps.DeleteNodeCommand.prototype=new mindmaps.Command,mindmaps.EditNodeCaptionCommand=function(){this.id="EDIT_NODE_CAPTION_COMMAND",this.shortcut=["F2","return"],this.label="Edit node caption",this.description="Edits the node text"},mindmaps.EditNodeCaptionCommand.prototype=new mindmaps.Command,mindmaps.ToggleNodeFoldedCommand=function(){this.id="TOGGLE_NODE_FOLDED_COMMAND",this.shortcut="space",this.description="Show or hide the node's children"},mindmaps.ToggleNodeFoldedCommand.prototype=new mindmaps.Command,mindmaps.UndoCommand=function(){this.id="UNDO_COMMAND",this.shortcut=["ctrl+z","meta+z"],this.label="Undo",this.icon="ui-icon-arrowreturnthick-1-w",this.description="Undo"},mindmaps.UndoCommand.prototype=new mindmaps.Command,mindmaps.RedoCommand=function(){this.id="REDO_COMMAND",this.shortcut=["ctrl+y","meta+shift+z"],this.label="Redo",this.icon="ui-icon-arrowreturnthick-1-e",this.description="Redo"},mindmaps.RedoCommand.prototype=new mindmaps.Command,mindmaps.CopyNodeCommand=function(){this.id="COPY_COMMAND",this.shortcut=["ctrl+c","meta+c"],this.label="Copy",this.icon="ui-icon-copy",this.description="Copy a branch"},mindmaps.CopyNodeCommand.prototype=new mindmaps.Command,mindmaps.CutNodeCommand=function(){this.id="CUT_COMMAND",this.shortcut=["ctrl+x","meta+x"],this.label="Cut",this.icon="ui-icon-scissors",this.description="Cut a branch"},mindmaps.CutNodeCommand.prototype=new mindmaps.Command,mindmaps.PasteNodeCommand=function(){this.id="PASTE_COMMAND",this.shortcut=["ctrl+v","meta+v"],this.label="Paste",this.icon="ui-icon-clipboard",this.description="Paste a branch"},mindmaps.PasteNodeCommand.prototype=new mindmaps.Command,mindmaps.NewDocumentCommand=function(){this.id="NEW_DOCUMENT_COMMAND",this.label="New",this.icon="ui-icon-document-b",this.description="Start working on a new mind map"},mindmaps.NewDocumentCommand.prototype=new mindmaps.Command,mindmaps.OpenDocumentCommand=function(){this.id="OPEN_DOCUMENT_COMMAND",this.label="Open...",this.shortcut=["ctrl+o","meta+o"],this.icon="ui-icon-folder-open",this.description="Open an existing mind map"},mindmaps.OpenDocumentCommand.prototype=new mindmaps.Command,mindmaps.SaveDocumentCommand=function(){this.id="SAVE_DOCUMENT_COMMAND",this.label="Save...",this.shortcut=["ctrl+s","meta+s"],this.icon="ui-icon-disk",this.description="Save the mind map"},mindmaps.SaveDocumentCommand.prototype=new mindmaps.Command,mindmaps.CloseDocumentCommand=function(){this.id="CLOSE_DOCUMENT_COMMAND",this.label="Close",this.icon="ui-icon-close",this.description="Close the mind map"},mindmaps.CloseDocumentCommand.prototype=new mindmaps.Command,mindmaps.HelpCommand=function(){this.id="HELP_COMMAND",this.enabled=!0,this.icon="ui-icon-help",this.label="Help",this.shortcut="F1",this.description="Get help!"},mindmaps.HelpCommand.prototype=new mindmaps.Command,mindmaps.PrintCommand=function(){this.id="PRINT_COMMAND",this.icon="ui-icon-print",this.label="Print",this.shortcut=["ctrl+p","meta+p"],this.description="Print the mind map"},mindmaps.PrintCommand.prototype=new mindmaps.Command,mindmaps.ExportCommand=function(){this.id="EXPORT_COMMAND",this.icon="ui-icon-image",this.label="Export As Image...",this.description="Export the mind map"},mindmaps.ExportCommand.prototype=new mindmaps.Command;
mindmaps.CommandRegistry=function(e){function t(t){t.shortcut&&t.execute&&e.register(t.shortcut,t.execute.bind(t))}function n(t){t.shortcut&&e.unregister(t.shortcut)}this.commands={},this.get=function(n){var r=this.commands[n];return r||(r=new n,this.commands[n]=r,e&&t(r)),r},this.remove=function(t){var r=this.commands[t];if(!r)return;delete this.commands[t],e&&n(r)}};
mindmaps.action={},mindmaps.action.Action=function(){},mindmaps.action.Action.prototype={noUndo:function(){return delete this.undo,delete this.redo,this},noEvent:function(){return delete this.event,this},execute:function(){},cancel:function(){this.cancelled=!0}},mindmaps.action.MoveNodeAction=function(e,t){var n=e.offset;this.execute=function(){e.offset=t},this.event=[mindmaps.Event.NODE_MOVED,e],this.undo=function(){return new mindmaps.action.MoveNodeAction(e,n)}},mindmaps.action.MoveNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.DeleteNodeAction=function(e,t){var n=e.getParent();this.execute=function(){if(e.isRoot())return!1;t.removeNode(e)},this.event=[mindmaps.Event.NODE_DELETED,e,n],this.undo=function(){return new mindmaps.action.CreateNodeAction(e,n,t)}},mindmaps.action.DeleteNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.CreateAutoPositionedNodeAction=function(e,t){if(e.isRoot())var n=mindmaps.Util.randomColor(),r=Math.random()>.49?1:-1,i=Math.random()>.49?1:-1,s=r*(100+Math.random()*250),o=i*Math.random()*250;else{var n=e.branchColor,r=e.offset.x>0?1:-1,s=r*(150+Math.random()*10);if(e.isLeaf())var u=5,a=-5;else var u=150,a=-150;var o=Math.floor(Math.random()*(u-a+1)+a)}var f=new mindmaps.Node;return f.branchColor=n,f.shouldEditCaption=!0,f.offset=new mindmaps.Point(s,o),new mindmaps.action.CreateNodeAction(f,e,t)},mindmaps.action.CreateNodeAction=function(e,t,n){this.execute=function(){n.addNode(e),t.addChild(e)},this.event=[mindmaps.Event.NODE_CREATED,e],this.undo=function(){return new mindmaps.action.DeleteNodeAction(e,n)}},mindmaps.action.CreateNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.ToggleNodeFoldAction=function(e){return e.foldChildren?new mindmaps.action.OpenNodeAction(e):new mindmaps.action.CloseNodeAction(e)},mindmaps.action.OpenNodeAction=function(e){this.execute=function(){e.foldChildren=!1},this.event=[mindmaps.Event.NODE_OPENED,e]},mindmaps.action.OpenNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.CloseNodeAction=function(e){this.execute=function(){e.foldChildren=!0},this.event=[mindmaps.Event.NODE_CLOSED,e]},mindmaps.action.CloseNodeAction.prototype=new mindmaps.action.Action,mindmaps.action.ChangeNodeCaptionAction=function(e,t){var n=e.getCaption();this.execute=function(){if(n===t)return!1;e.setCaption(t)},this.event=[mindmaps.Event.NODE_TEXT_CAPTION_CHANGED,e],this.undo=function(){return new mindmaps.action.ChangeNodeCaptionAction(e,n)}},mindmaps.action.ChangeNodeCaptionAction.prototype=new mindmaps.action.Action,mindmaps.action.ChangeNodeFontSizeAction=function(e,t){this.execute=function(){e.text.font.size+=t},this.event=[mindmaps.Event.NODE_FONT_CHANGED,e],this.undo=function(){return new mindmaps.action.ChangeNodeFontSizeAction(e,-t)}},mindmaps.action.ChangeNodeFontSizeAction.prototype=new mindmaps.action.Action,mindmaps.action.DecreaseNodeFontSizeAction=function(e){return new mindmaps.action.ChangeNodeFontSizeAction(e,-4)},mindmaps.action.IncreaseNodeFontSizeAction=function(e){return new mindmaps.action.ChangeNodeFontSizeAction(e,4)},mindmaps.action.SetFontWeightAction=function(e,t){this.execute=function(){var n=t?"bold":"normal";e.text.font.weight=n},this.event=[mindmaps.Event.NODE_FONT_CHANGED,e],this.undo=function(){return new mindmaps.action.SetFontWeightAction(e,!t)}},mindmaps.action.SetFontWeightAction.prototype=new mindmaps.action.Action,mindmaps.action.SetFontStyleAction=function(e,t){this.execute=function(){var n=t?"italic":"normal";e.text.font.style=n},this.event=[mindmaps.Event.NODE_FONT_CHANGED,e],this.undo=function(){return new mindmaps.action.SetFontStyleAction(e,!t)}},mindmaps.action.SetFontStyleAction.prototype=new mindmaps.action.Action,mindmaps.action.SetFontDecorationAction=function(e,t){var n=e.text.font.decoration;this.execute=function(){e.text.font.decoration=t},this.event=[mindmaps.Event.NODE_FONT_CHANGED,e],this.undo=function(){return new mindmaps.action.SetFontDecorationAction(e,n)}},mindmaps.action.SetFontDecorationAction.prototype=new mindmaps.action.Action,mindmaps.action.SetFontColorAction=function(e,t){var n=e.text.font.color;this.execute=function(){e.text.font.color=t},this.event=[mindmaps.Event.NODE_FONT_CHANGED,e],this.undo=function(){return new mindmaps.action.SetFontColorAction(e,n)}},mindmaps.action.SetFontColorAction.prototype=new mindmaps.action.Action,mindmaps.action.SetBranchColorAction=function(e,t){var n=e.branchColor;this.execute=function(){if(t===e.branchColor)return!1;e.branchColor=t},this.event=[mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,e],this.undo=function(){return new mindmaps.action.SetBranchColorAction(e,n)}},mindmaps.action.SetBranchColorAction.prototype=new mindmaps.action.Action,mindmaps.action.CompositeAction=function(){this.actions=[]},mindmaps.action.CompositeAction.prototype.addAction=function(e){this.actions.push(e)},mindmaps.action.CompositeAction.prototype.forEachAction=function(e){this.actions.forEach(e)},mindmaps.action.SetChildrenBranchColorAction=function(e){mindmaps.action.CompositeAction.call(this);var t=e.branchColor,n=this;e.forEachDescendant(function(e){n.addAction(new mindmaps.action.SetBranchColorAction(e,t))})},mindmaps.action.SetChildrenBranchColorAction.prototype=new mindmaps.action.CompositeAction;
function timeit(e,t){var n=(new Date).getTime();e();var r=(new Date).getTime(),i=r-n;console.log(t||"",i,"ms")}function getBinaryMapWithDepth(e){function r(e,n){if(n===0)return;var i=t.createNode();i.text.caption="Node "+i.id,e.addChild(i),r(i,n-1);var s=t.createNode();s.text.caption="Node "+s.id,e.addChild(s),r(s,n-1)}function o(e,t,n){e.offset=new mindmaps.Point((t+1)*50,n);if(e.isLeaf())return;var r=e.children.values(),i=r[0];o(i,t+1,n-n/2);var s=r[1];o(s,t+1,n+n/2)}var t=new mindmaps.MindMap,n=t.root,e=e||10;r(n,e),n.offset=new mindmaps.Point(400,400);var i=80,s=n.children.values();return o(s[0],0,-i),o(s[1],0,i),s[0].branchColor=mindmaps.Util.randomColor(),s[0].forEachDescendant(function(e){e.branchColor=mindmaps.Util.randomColor()}),s[1].branchColor=mindmaps.Util.randomColor(),s[1].forEachDescendant(function(e){e.branchColor=mindmaps.Util.randomColor()}),t}function getDefaultTestMap(){var e=new mindmaps.MindMap,t=e.root,n=e.createNode(),r=e.createNode(),i=e.createNode();t.addChild(n),t.addChild(r),t.addChild(i);var s=e.createNode(),o=e.createNode();r.addChild(s),r.addChild(o);var u=e.createNode(),a=e.createNode(),f=e.createNode(),l=e.createNode();i.addChild(u),i.addChild(a),i.addChild(f),i.addChild(l);var c=e.createNode();s.addChild(c);var h=e.createNode();return c.addChild(h),e}function getDefaultTestDocument(){var e=new mindmaps.Document;return e.title="test document",e.mindmap=getDefaultTestMap(),e}function getSimpleMap(){var e=new mindmaps.MindMap,t=e.root,n=e.createNode(),r=e.createNode();return t.addChild(n),t.addChild(r),e}mindmaps.Util=mindmaps.Util||{},mindmaps.Util.trackEvent=function(e,t,n){if(!window._gaq)return;n?_gaq.push(["_trackEvent",e,t,n]):_gaq.push(["_trackEvent",e,t])},mindmaps.Util.createUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})},mindmaps.Util.getId=function(){return mindmaps.Util.createUUID()},mindmaps.Util.randomColor=function(){return function(e){return"#000000".substr(0,7-e.length)+e}((~~(Math.random()*(1<<24))).toString(16))},mindmaps.Util.getUrlParams=function(){var e={},t,n=/\+/g,r=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},s=window.location.search.substring(1);while(t=r.exec(s))e[i(t[1])]=i(t[2]);return e},mindmaps.Util.distance=function(e,t){return Math.sqrt(e*e+t*t)};
mindmaps.Point=function(e,t){this.x=e||0,this.y=t||0},mindmaps.Point.fromObject=function(e){return new mindmaps.Point(e.x,e.y)},mindmaps.Point.prototype.clone=function(){return new mindmaps.Point(this.x,this.y)},mindmaps.Point.prototype.add=function(e){this.x+=e.x,this.y+=e.y},mindmaps.Point.prototype.toString=function(){return"{x: "+this.x+" y: "+this.y+"}"};
mindmaps.Document=function(){this.id=mindmaps.Util.createUUID(),this.title="New Document",this.mindmap=new mindmaps.MindMap,this.dates={created:new Date,modified:null},this.dimensions=new mindmaps.Point(4e3,2e3),this.autosave=!1},mindmaps.Document.fromJSON=function(e){return mindmaps.Document.fromObject(JSON.parse(e))},mindmaps.Document.fromObject=function(e){var t=new mindmaps.Document;return t.id=e.id,t.title=e.title,t.mindmap=mindmaps.MindMap.fromObject(e.mindmap),t.dates={created:new Date(e.dates.created),modified:e.dates.modified?new Date(e.dates.modified):null},t.dimensions=mindmaps.Point.fromObject(e.dimensions),t.autosave=e.autosave,t},mindmaps.Document.prototype.toJSON=function(){var e={created:this.dates.created.getTime()};return this.dates.modified&&(e.modified=this.dates.modified.getTime()),{id:this.id,title:this.title,mindmap:this.mindmap,dates:e,dimensions:this.dimensions,autosave:this.autosave}},mindmaps.Document.prototype.serialize=function(){return JSON.stringify(this)},mindmaps.Document.prototype.prepareSave=function(){return this.dates.modified=new Date,this.title=this.mindmap.getRoot().getCaption(),this},mindmaps.Document.sortByModifiedDateDescending=function(e,t){return e.dates.modified>t.dates.modified?-1:e.dates.modified<t.dates.modified?1:0},mindmaps.Document.prototype.isNew=function(){return this.dates.modified===null},mindmaps.Document.prototype.getCreatedDate=function(){return this.dates.created},mindmaps.Document.prototype.getWidth=function(){return this.dimensions.x},mindmaps.Document.prototype.getHeight=function(){return this.dimensions.y},mindmaps.Document.prototype.isAutoSave=function(){return this.autosave},mindmaps.Document.prototype.setAutoSave=function(e){this.autosave=e};
mindmaps.MindMap=function(e){this.nodes=new mindmaps.NodeMap,e?this.root=e:(this.root=new mindmaps.Node,this.root.text.font.size=20,this.root.text.font.weight="bold",this.root.text.caption="Central Idea"),this.addNode(this.root)},mindmaps.MindMap.fromJSON=function(e){return mindmaps.MindMap.fromObject(JSON.parse(e))},mindmaps.MindMap.fromObject=function(e){var t=mindmaps.Node.fromObject(e.root),n=new mindmaps.MindMap(t);return t.forEachDescendant(function(e){n.addNode(e)}),n},mindmaps.MindMap.prototype.toJSON=function(){var e={root:this.root};return e},mindmaps.MindMap.prototype.serialize=function(){return JSON.stringify(this)},mindmaps.MindMap.prototype.createNode=function(){var e=new mindmaps.Node;return this.addNode(e),e},mindmaps.MindMap.prototype.addNode=function(e){this.nodes.add(e);var t=this;e.forEachDescendant(function(e){t.nodes.add(e)})},mindmaps.MindMap.prototype.removeNode=function(e){var t=e.parent;t.removeChild(e);var n=this;e.forEachDescendant(function(e){n.nodes.remove(e)}),this.nodes.remove(e)},mindmaps.MindMap.prototype.getRoot=function(){return this.root};
mindmaps.Node=function(){this.id=mindmaps.Util.getId(),this.parent=null,this.children=new mindmaps.NodeMap,this.text={caption:"New Idea",font:{style:"normal",weight:"normal",decoration:"none",size:15,color:"#000000"}},this.offset=new mindmaps.Point,this.foldChildren=!1,this.branchColor="#000000"},mindmaps.Node.prototype.clone=function(){var e=new mindmaps.Node,t={caption:this.text.caption},n={weight:this.text.font.weight,style:this.text.font.style,decoration:this.text.font.decoration,size:this.text.font.size,color:this.text.font.color};return t.font=n,e.text=t,e.offset=this.offset.clone(),e.foldChildren=this.foldChildren,e.branchColor=this.branchColor,this.forEachChild(function(t){var n=t.clone();e.addChild(n)}),e},mindmaps.Node.fromJSON=function(e){return mindmaps.Node.fromObject(JSON.parse(e))},mindmaps.Node.fromObject=function(e){var t=new mindmaps.Node;return t.id=e.id,t.text=e.text,t.offset=mindmaps.Point.fromObject(e.offset),t.foldChildren=e.foldChildren,t.branchColor=e.branchColor,e.children.forEach(function(e){var n=mindmaps.Node.fromObject(e);t.addChild(n)}),t},mindmaps.Node.prototype.toJSON=function(){var e=this,t=function(){var t=[];return e.forEachChild(function(e){t.push(e.toJSON())}),t}(),n={id:this.id,parentId:this.parent?this.parent.id:null,text:this.text,offset:this.offset,foldChildren:this.foldChildren,branchColor:this.branchColor,children:t};return n},mindmaps.Node.prototype.serialize=function(){return JSON.stringify(this)},mindmaps.Node.prototype.addChild=function(e){e.parent=this,this.children.add(e)},mindmaps.Node.prototype.removeChild=function(e){e.parent=null,this.children.remove(e)},mindmaps.Node.prototype.isRoot=function(){return this.parent===null},mindmaps.Node.prototype.isLeaf=function(){return this.children.size()===0},mindmaps.Node.prototype.getParent=function(){return this.parent},mindmaps.Node.prototype.getRoot=function(){var e=this;while(e.parent)e=e.parent;return e},mindmaps.Node.prototype.getPosition=function(){var e=this.offset.clone(),t=this.parent;while(t)e.add(t.offset),t=t.parent;return e},mindmaps.Node.prototype.getDepth=function(){var e=this.parent,t=0;while(e)t++,e=e.parent;return t},mindmaps.Node.prototype.getChildren=function(e){var t=[];return this.children.each(function(n){if(e){var r=n.getChildren(!0);r.forEach(function(e){t.push(e)})}t.push(n)}),t},mindmaps.Node.prototype.forEachChild=function(e){this.children.each(e)},mindmaps.Node.prototype.forEachDescendant=function(e){this.children.each(function(t){e(t),t.forEachDescendant(e)})},mindmaps.Node.prototype.setCaption=function(e){this.text.caption=e},mindmaps.Node.prototype.getCaption=function(){return this.text.caption},mindmaps.Node.prototype.isDescendant=function(e){function t(n){var r=n.children.values();for(var i=0,s=r.length;i<s;i++){var o=r[i];if(t(o))return!0;if(o===e)return!0}return!1}return t(this)};
mindmaps.NodeMap=function(){this.nodes={},this.count=0},mindmaps.NodeMap.prototype.get=function(e){return this.nodes[e]},mindmaps.NodeMap.prototype.add=function(e){return this.nodes.hasOwnProperty(e.id)?!1:(this.nodes[e.id]=e,this.count++,!0)},mindmaps.NodeMap.prototype.remove=function(e){return this.nodes.hasOwnProperty(e.id)?(delete this.nodes[e.id],this.count--,!0):!1},mindmaps.NodeMap.prototype.size=function(){return this.count},mindmaps.NodeMap.prototype.values=function(){return Object.keys(this.nodes).map(function(e){return this.nodes[e]},this)},mindmaps.NodeMap.prototype.each=function(e){for(var t in this.nodes)e(this.nodes[t])};
function UndoManager(e){this.maxStackSize=e||64;var t={UNDO:"undo",REDO:"redo"},n=this,r=new UndoManager.CircularStack(this.maxStackSize),i=new UndoManager.CircularStack(this.maxStackSize),s=!1,o=null,u=null,a=function(){n.stateChanged&&n.stateChanged()},f=function(e){o=e,s=!0;switch(u){case t.UNDO:e.undo();break;case t.REDO:e.redo()}s=!1};this.addUndo=function(e,n){if(s)o.redo==null&&u==t.UNDO&&(o.redo=e);else{var f={undo:e,redo:n};r.push(f),i.clear(),a()}},this.undo=function(){if(this.canUndo()){u=t.UNDO;var e=r.pop();f(e),e.redo&&i.push(e),a()}},this.redo=function(){if(this.canRedo()){u=t.REDO;var e=i.pop();f(e),e.undo&&r.push(e),a()}},this.canUndo=function(){return!r.isEmpty()},this.canRedo=function(){return!i.isEmpty()},this.reset=function(){r.clear(),i.clear(),s=!1,o=null,u=null,a()},this.stateChanged=function(){}}UndoManager.CircularStack=function(e){this.maxSize=e||32,this.buffer=[],this.nextPointer=0},UndoManager.CircularStack.prototype.push=function(e){this.buffer[this.nextPointer]=e,this.nextPointer=(this.nextPointer+1)%this.maxSize},UndoManager.CircularStack.prototype.isEmpty=function(){if(this.buffer.length===0)return!0;var e=this.getPreviousPointer();return e===null?!0:this.buffer[e]===null},UndoManager.CircularStack.prototype.getPreviousPointer=function(){return this.nextPointer>0?this.nextPointer-1:this.buffer.length<this.maxSize?null:this.maxSize-1},UndoManager.CircularStack.prototype.clear=function(){this.buffer.length=0,this.nextPointer=0},UndoManager.CircularStack.prototype.pop=function(){if(this.isEmpty())return null;var e=this.getPreviousPointer(),t=this.buffer[e];return this.buffer[e]=null,this.nextPointer=e,t},UndoManager.CircularStack.prototype.peek=function(){return this.isEmpty()?null:this.buffer[this.getPreviousPointer()]};
mindmaps.UndoController=function(e,t){this.init=function(){this.undoManager=new UndoManager(128),this.undoManager.stateChanged=this.undoStateChanged.bind(this),this.undoCommand=t.get(mindmaps.UndoCommand),this.undoCommand.setHandler(this.doUndo.bind(this)),this.redoCommand=t.get(mindmaps.RedoCommand),this.redoCommand.setHandler(this.doRedo.bind(this)),e.subscribe(mindmaps.Event.DOCUMENT_OPENED,this.documentOpened.bind(this)),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,this.documentClosed.bind(this))},this.undoStateChanged=function(){this.undoCommand.setEnabled(this.undoManager.canUndo()),this.redoCommand.setEnabled(this.undoManager.canRedo())},this.addUndo=function(e,t){this.undoManager.addUndo(e,t)},this.doUndo=function(){this.undoManager.undo()},this.doRedo=function(){this.undoManager.redo()},this.documentOpened=function(){this.undoManager.reset(),this.undoStateChanged()},this.documentClosed=function(){this.undoManager.reset(),this.undoStateChanged()},this.init()};
mindmaps.ClipboardController=function(e,t,n){function u(){i=t.get(mindmaps.CopyNodeCommand),i.setHandler(f),s=t.get(mindmaps.CutNodeCommand),s.setHandler(l),o=t.get(mindmaps.PasteNodeCommand),o.setHandler(c),o.setEnabled(!1),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){i.setEnabled(!1),s.setEnabled(!1),o.setEnabled(!1)}),e.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){i.setEnabled(!0),s.setEnabled(!0),o.setEnabled(r!=null)})}function a(){r=n.selectedNode.clone(),o.setEnabled(!0)}function f(){a()}function l(){a(),n.deleteNode(n.selectedNode)}function c(){if(!r)return;n.createNode(r.clone(),n.selectedNode)}var r,i,s,o;u()};
mindmaps.ZoomController=function(e,t){var n=this;this.ZOOM_STEP=.25,this.MAX_ZOOM=3,this.MIN_ZOOM=.25,this.DEFAULT_ZOOM=1,this.zoomFactor=this.DEFAULT_ZOOM,this.zoomTo=function(t){t<=this.MAX_ZOOM&&t>=this.MIN_ZOOM&&(this.zoomFactor=t,e.publish(mindmaps.Event.ZOOM_CHANGED,t))},this.zoomIn=function(){return this.zoomFactor+=this.ZOOM_STEP,this.zoomFactor>this.MAX_ZOOM?this.zoomFactor-=this.ZOOM_STEP:e.publish(mindmaps.Event.ZOOM_CHANGED,this.zoomFactor),this.zoomFactor},this.zoomOut=function(){return this.zoomFactor-=this.ZOOM_STEP,this.zoomFactor<this.MIN_ZOOM?this.zoomFactor+=this.ZOOM_STEP:e.publish(mindmaps.Event.ZOOM_CHANGED,this.zoomFactor),this.zoomFactor},e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(e){n.zoomTo(n.DEFAULT_ZOOM)})};
mindmaps.ShortcutController=function(){function e(e,t){return t=t||"keydown",t+"."+e}this.shortcuts={},this.register=function(t,n,r){Array.isArray(t)||(t=[t]);var i=this;t.forEach(function(t){r=e(t,r),$(document).bind(r,t,function(e){return e.stopImmediatePropagation(),e.stopPropagation(),e.preventDefault(),n(),!1})})},this.unregister=function(t,n){n=e(t,n),$(document).unbind(n),delete this.shortcuts[n]},this.unregisterAll=function(){for(var e in shortcuts)$(document).unbind(e)}};
mindmaps.HelpController=function(e,t){function n(){function r(){t.forEach(function(e){e.close()})}function o(){i=new mindmaps.Notification("#toolbar",{position:"bottomMiddle",maxWidth:550,title:"Welcome to mindmaps",content:"Hello there, it seems like you are new here! These bubbles will guide you through the app. Or they won't if you want to skip this tutorial and <a class='skip-tutorial link'>click here<a/>."}),t.push(i),i.$().find("a.skip-tutorial").click(function(){n=!1,r(),v()}),setTimeout(u,2e3)}function u(){if(d())return;s=new mindmaps.Notification(".node-caption.root",{position:"bottomMiddle",closeButton:!0,maxWidth:350,title:"This is where you start - your main idea",content:"Double click the idea to change what it says. This will be the main topic of your mind map."}),t.push(s),e.once(mindmaps.Event.NODE_TEXT_CAPTION_CHANGED,function(){s.close(),setTimeout(a,900)})}function a(){if(d())return;var n=new mindmaps.Notification(".node-caption.root",{position:"bottomMiddle",closeButton:!0,maxWidth:350,padding:20,title:"Creating new ideas",content:"Now it's time to build your mind map.<br/> Move your mouse over the idea, click and then drag the <span style='color:red'>red circle</span> away from the root. This is how you create a new branch."});t.push(n),e.once(mindmaps.Event.NODE_CREATED,function(){i.close(),n.close(),setTimeout(f,900)})}function f(){if(d())return;var n=new mindmaps.Notification(".node-container.root > .node-container:first",{position:"bottomMiddle",closeButton:!0,maxWidth:350,title:"Your first branch",content:"Great! This is easy, right? The red circle is your most important tool. Now, you can move your idea around by dragging it or double click to change the text again."});t.push(n),setTimeout(c,2e3),e.once(mindmaps.Event.NODE_MOVED,function(){n.close(),setTimeout(l,0),setTimeout(h,15e3),setTimeout(p,1e4),setTimeout(v,2e4)})}function l(){if(d())return;var e=new mindmaps.Notification(".float-panel:has(#navigator)",{position:"bottomRight",closeButton:!0,maxWidth:350,expires:1e4,title:"Navigation",content:"You can click and drag the background of the map to move around. Use your mousewheel or slider over there to zoom in and out."});t.push(e)}function c(){if(d())return;var e=new mindmaps.Notification("#inspector",{position:"leftBottom",closeButton:!0,maxWidth:350,padding:20,title:"Don't like the colors?",content:"Use these controls to change the appearance of your ideas. Try clicking the icon in the upper right corner to minimize this panel."});t.push(e)}function h(){if(d())return;var e=new mindmaps.Notification("#toolbar .buttons-left",{position:"bottomLeft",closeButton:!0,maxWidth:350,padding:20,title:"The tool bar",content:"Those buttons do what they say. You can use them or work with keyboard shortcuts. Hover over the buttons for the key combinations."});t.push(e)}function p(){if(d())return;var e=new mindmaps.Notification("#toolbar .buttons-right",{position:"leftTop",closeButton:!0,maxWidth:350,title:"Save your work",content:"The button to the right opens a menu where you can save your mind map or start working on another one if you like."});t.push(e)}function d(){return mindmaps.LocalStorage.get("mindmaps.tutorial.done")==1}function v(){mindmaps.LocalStorage.put("mindmaps.tutorial.done",1)}if(d()){console.debug("skipping tutorial");return}var t=[],n=!0;e.once(mindmaps.Event.DOCUMENT_OPENED,function(){setTimeout(o,1e3)});var i,s}function r(){function r(){var e=n.some(function(e){return e.isVisible()});if(e){n.forEach(function(e){e.close()}),n.length=0;return}var t=new mindmaps.Notification(".node-caption.root",{position:"bottomLeft",closeButton:!0,maxWidth:350,title:"This is your main idea",content:"Double click an idea to edit its text. Move the mouse over an idea and drag the red circle to create a new idea."}),r=new mindmaps.Notification("#navigator",{position:"leftTop",closeButton:!0,maxWidth:350,padding:20,title:"This is the navigator",content:"Use this panel to get an overview of your map. You can navigate around by dragging the red rectangle or change the zoom by clicking on the magnifier buttons."}),i=new mindmaps.Notification("#inspector",{position:"leftTop",closeButton:!0,maxWidth:350,padding:20,title:"This is the inspector",content:"Use these controls to change the appearance of your ideas. Try clicking the icon in the upper right corner to minimize this panel."}),s=new mindmaps.Notification("#toolbar .buttons-left",{position:"bottomLeft",closeButton:!0,maxWidth:350,title:"This is your toolbar",content:"Those buttons do what they say. You can use them or work with keyboard shortcuts. Hover over the buttons for the key combinations."});n.push(t,r,i,s)}var e=t.get(mindmaps.HelpCommand);e.setHandler(r);var n=[]}n(),r()};
mindmaps.FloatPanelFactory=function(e){function s(s){e.subscribe(mindmaps.CanvasContainer.Event.RESIZED,function(){n.forEach(function(e){e.visible&&e.ensurePosition()})});var o=t.outerWidth(),u=t.offset().top,a=s.width(),f=s.height(),l=n.reduce(function(e,t){return e+t.height()+i},0);s.setPosition(o-a-r,u+i+l)}var t=e.getContent(),n=[],r=15,i=5;this.create=function(e,r){var i=new mindmaps.FloatPanel(e,t,r);return s(i),n.push(i),i}},mindmaps.FloatPanel=function(e,t,n){var r=this,i=!1;this.caption=e,this.visible=!1,this.animationDuration=400,this.setContent=function(e){this.clearContent(),$("div.ui-dialog-content",this.$widget).append(e)},this.clearContent=function(){$("div.ui-dialog-content",this.$widget).children().detach()},this.$widget=function(){var i=$("#template-float-panel").tmpl({title:e});return i.find(".ui-dialog-titlebar-close").click(function(){r.hide()}),n&&i.find(".ui-dialog-content").append(n),i.draggable({containment:"parent",handle:"div.ui-dialog-titlebar",opacity:.75}).hide().appendTo(t),i}(),this.hide=function(){!i&&this.visible&&(this.visible=!1,this.$widget.fadeOut(this.animationDuration*1.5),this.$hideTarget&&this.transfer(this.$widget,this.$hideTarget))},this.show=function(){!i&&!this.visible&&(this.visible=!0,this.$widget.fadeIn(this.animationDuration*1.5),this.ensurePosition(),this.$hideTarget&&this.transfer(this.$hideTarget,this.$widget))},this.toggle=function(){this.visible?this.hide():this.show()},this.transfer=function(e,t){i=!0;var n=t.offset(),r={top:n.top,left:n.left,height:t.innerHeight(),width:t.innerWidth()},s=e.offset(),o=$('<div class="ui-effects-transfer"></div>').appendTo(document.body).css({top:s.top,left:s.left,height:e.innerHeight(),width:e.innerWidth(),position:"absolute"}).animate(r,this.animationDuration,"linear",function(){o.remove(),i=!1})},this.width=function(){return this.$widget.outerWidth()},this.height=function(){return this.$widget.outerHeight()},this.offset=function(){return this.$widget.offset()},this.setPosition=function(e,t){this.$widget.offset({left:e,top:t})},this.ensurePosition=function(){var e=t.outerWidth(),n=t.outerHeight(),r=t.offset().left,i=t.offset().top,s=this.width(),o=this.height(),u=this.offset().left,a=this.offset().top;e+r<s+u&&e>=s&&this.setPosition(e+r-s,a),n+i<o+a&&n>=o&&this.setPosition(u,n+i-o)},this.setHideTarget=function(e){this.$hideTarget=e}};
mindmaps.NavigatorView=function(){var e=this,t=$("#template-navigator").tmpl(),n=t.children(".active").hide(),r=t.children(".inactive").hide(),i=$("#navi-canvas-overlay",t),s=$("#navi-canvas",t);this.getContent=function(){return t},this.showActiveContent=function(){r.hide(),n.show()},this.showInactiveContent=function(){n.hide(),r.show()},this.setDraggerSize=function(e,t){i.css({width:e,height:t})},this.setDraggerPosition=function(e,t){i.css({left:e,top:t})},this.setCanvasHeight=function(e){$("#navi-canvas",t).css({height:e})},this.getCanvasWidth=function(){return $("#navi-canvas",t).width()},this.init=function(n){$("#navi-slider",t).slider({min:0,max:11,step:1,value:3,slide:function(t,n){e.sliderChanged&&e.sliderChanged(n.value)}}),$("#button-navi-zoom-in",t).button({text:!1,icons:{primary:"ui-icon-zoomin"}}).click(function(){e.buttonZoomInClicked&&e.buttonZoomInClicked()}),$("#button-navi-zoom-out",t).button({text:!1,icons:{primary:"ui-icon-zoomout"}}).click(function(){e.buttonZoomOutClicked&&e.buttonZoomOutClicked()}),i.draggable({containment:"parent",start:function(t,n){e.dragStart&&e.dragStart()},drag:function(t,n){if(e.dragging){var r=n.position.left,i=n.position.top;e.dragging(r,i)}},stop:function(t,n){e.dragStop&&e.dragStop()}})},this.draw=function(e,t){function a(e){return e/t}function f(e,t,n){u.save(),u.translate(t,n),e.collapseChildren||e.forEachChild(function(e){u.beginPath(),u.strokeStyle=e.branchColor,u.moveTo(0,0);var t=a(e.offset.x),n=a(e.offset.y),r=5;if(t<0)var i=t+r,s=t;else var i=t,s=t+r;u.lineTo(i,n),u.lineTo(s,n),u.stroke(),f(e,s,n)}),u.restore()}var n=e.root,r=s[0],i=r.width,o=r.height,u=r.getContext("2d");u.clearRect(0,0,i,o),u.lineWidth=1.8,f(n,i/2,o/2),u.fillRect(i/2-4,o/2-2,8,4)},this.showZoomLevel=function(e){$("#navi-zoom-level").text(e)},this.setSliderValue=function(e){$("#navi-slider").slider("value",e)}},mindmaps.NavigatorPresenter=function(e,t,n,r){function c(){var e=s.width()/u,n=s.height()/u,r=e*a.x/f.x,i=n*a.y/f.y;r>a.x&&(r=a.x),i>a.y&&(i=a.y),t.setDraggerSize(r,i)}function h(){var e=t.getCanvasWidth(),n=f.x/e,r=f.y/n;t.setCanvasHeight(r),a.x=e,a.y=r}function p(){var e=s.scrollLeft()/u,n=s.scrollTop()/u,r=e*a.x/f.x,i=n*a.y/f.y;t.setDraggerPosition(r,i)}function d(){var e=u*100+" %";t.showZoomLevel(e)}function v(){var e=u/r.ZOOM_STEP-1;t.setSliderValue(e)}function m(e){f=e.dimensions,l=e.mindmap,h(),p(),c(),d(),v(),g(),t.showActiveContent(),s.bind("scroll.navigator-view",function(){o||p()})}function g(){var e=f.x/a.x;t.draw(l,e)}function y(){f=null,l=null,u=1,s.unbind("scroll.navigator-view"),t.showInactiveContent()}var i=this,s=n.getContent(),o=!1,u=r.DEFAULT_ZOOM,a=new mindmaps.Point,f=null,l=null;t.dragStart=function(){o=!0},t.dragging=function(e,t){var n=u*f.x*e/a.x,r=u*f.y*t/a.y;s.scrollLeft(n).scrollTop(r)},t.dragStop=function(){o=!1},t.buttonZoomInClicked=function(){r.zoomIn()},t.buttonZoomOutClicked=function(){r.zoomOut()},t.sliderChanged=function(e){r.zoomTo((e+1)*r.ZOOM_STEP)},n.subscribe(mindmaps.CanvasContainer.Event.RESIZED,function(){f&&c()}),e.subscribe(mindmaps.Event.DOCUMENT_OPENED,m),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,y),e.subscribe(mindmaps.Event.NODE_MOVED,g),e.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,g),e.subscribe(mindmaps.Event.NODE_CREATED,g),e.subscribe(mindmaps.Event.NODE_DELETED,g),e.subscribe(mindmaps.Event.NODE_OPENED,g),e.subscribe(mindmaps.Event.NODE_CLOSED,g),e.subscribe(mindmaps.Event.ZOOM_CHANGED,function(e){u=e,p(),c(),d(),v()}),this.go=function(){t.init(),t.showInactiveContent()}};
mindmaps.InspectorView=function(){var e=this,t=$("#template-inspector").tmpl(),n=$("#inspector-button-font-size-decrease",t),r=$("#inspector-button-font-size-increase",t),i=$("#inspector-checkbox-font-bold",t),s=$("#inspector-checkbox-font-italic",t),o=$("#inspector-checkbox-font-underline",t),u=$("#inspector-checkbox-font-linethrough",t),a=$("#inspector-button-branch-color-children",t),f=$("#inspector-branch-color-picker",t),l=$("#inspector-font-color-picker",t),c=[n,r,i,s,o,u,a],h=[f,l];this.getContent=function(){return t},this.setControlsEnabled=function(e){var t=e?"enable":"disable";c.forEach(function(e){e.button(t)}),h.forEach(function(t){t.miniColors("disabled",!e)})},this.setBoldCheckboxState=function(e){i.prop("checked",e).button("refresh")},this.setItalicCheckboxState=function(e){s.prop("checked",e).button("refresh")},this.setUnderlineCheckboxState=function(e){o.prop("checked",e).button("refresh")},this.setLinethroughCheckboxState=function(e){u.prop("checked",e).button("refresh")},this.setBranchColorPickerColor=function(e){f.miniColors("value",e)},this.setFontColorPickerColor=function(e){l.miniColors("value",e)},this.init=function(){$(".buttonset",t).buttonset(),a.button(),n.click(function(){e.fontSizeDecreaseButtonClicked&&e.fontSizeDecreaseButtonClicked()}),r.click(function(){e.fontSizeIncreaseButtonClicked&&e.fontSizeIncreaseButtonClicked()}),i.click(function(){if(e.fontBoldCheckboxClicked){var t=$(this).prop("checked");e.fontBoldCheckboxClicked(t)}}),s.click(function(){if(e.fontItalicCheckboxClicked){var t=$(this).prop("checked");e.fontItalicCheckboxClicked(t)}}),o.click(function(){if(e.fontUnderlineCheckboxClicked){var t=$(this).prop("checked");e.fontUnderlineCheckboxClicked(t)}}),u.click(function(){if(e.fontLinethroughCheckboxClicked){var t=$(this).prop("checked");e.fontLinethroughCheckboxClicked(t)}}),f.miniColors({hide:function(t){if(this.attr("disabled"))return;console.log("hide branch",t),e.branchColorPicked&&e.branchColorPicked(t)},move:function(t){e.branchColorPreview&&e.branchColorPreview(t)}}),l.miniColors({hide:function(t){if(this.attr("disabled"))return;console.log("font",t),e.fontColorPicked&&e.fontColorPicked(t)},move:function(t){e.fontColorPreview&&e.fontColorPreview(t)}}),a.click(function(){e.branchColorChildrenButtonClicked&&e.branchColorChildrenButtonClicked()})}},mindmaps.InspectorPresenter=function(e,t,n){function i(e){var t=e.text.font;n.setBoldCheckboxState(t.weight==="bold"),n.setItalicCheckboxState(t.style==="italic"),n.setUnderlineCheckboxState(t.decoration==="underline"),n.setLinethroughCheckboxState(t.decoration==="line-through"),n.setFontColorPickerColor(t.color),n.setBranchColorPickerColor(e.branchColor)}var r=this;n.fontSizeDecreaseButtonClicked=function(){var e=new mindmaps.action.DecreaseNodeFontSizeAction(t.selectedNode);t.executeAction(e)},n.fontSizeIncreaseButtonClicked=function(){var e=new mindmaps.action.IncreaseNodeFontSizeAction(t.selectedNode);t.executeAction(e)},n.fontBoldCheckboxClicked=function(e){var n=new mindmaps.action.SetFontWeightAction(t.selectedNode,e);t.executeAction(n)},n.fontItalicCheckboxClicked=function(e){var n=new mindmaps.action.SetFontStyleAction(t.selectedNode,e);t.executeAction(n)},n.fontUnderlineCheckboxClicked=function(e){var n=new mindmaps.action.SetFontDecorationAction(t.selectedNode,e?"underline":"none");t.executeAction(n)},n.fontLinethroughCheckboxClicked=function(e){var n=new mindmaps.action.SetFontDecorationAction(t.selectedNode,e?"line-through":"none");t.executeAction(n)},n.branchColorPicked=function(e){var n=new mindmaps.action.SetBranchColorAction(t.selectedNode,e);t.executeAction(n)},n.branchColorPreview=function(n){e.publish(mindmaps.Event.NODE_BRANCH_COLOR_PREVIEW,t.selectedNode,n)},n.fontColorPicked=function(e){var n=new mindmaps.action.SetFontColorAction(t.selectedNode,e);t.executeAction(n)},n.fontColorPreview=function(n){e.publish(mindmaps.Event.NODE_FONT_COLOR_PREVIEW,t.selectedNode,n)},n.branchColorChildrenButtonClicked=function(){var e=new mindmaps.action.SetChildrenBranchColorAction(t.selectedNode);t.executeAction(e)},e.subscribe(mindmaps.Event.NODE_FONT_CHANGED,function(e){t.selectedNode===e&&i(e)}),e.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,function(e){t.selectedNode===e&&i(e)}),e.subscribe(mindmaps.Event.NODE_SELECTED,function(e){i(e)}),e.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){n.setControlsEnabled(!0)}),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){n.setControlsEnabled(!1)}),this.go=function(){n.init()}};
mindmaps.ToolBarView=function(){var e=this;this.init=function(){},this.addButton=function(e,t){t(e.asJquery())},this.addButtonGroup=function(e,t){var n=$("<span/>");e.forEach(function(e){n.append(e.asJquery())}),n.buttonset(),t(n)},this.addMenu=function(e){this.alignRight(e.getContent())},this.alignLeft=function(e){e.appendTo("#toolbar .buttons-left")},this.alignRight=function(e){e.appendTo("#toolbar .buttons-right")}},mindmaps.ToolBarButton=function(e){this.command=e;var t=this;e.subscribe(mindmaps.Command.Event.ENABLED_CHANGED,function(e){t.setEnabled&&t.setEnabled(e)})},mindmaps.ToolBarButton.prototype.isEnabled=function(){return this.command.enabled},mindmaps.ToolBarButton.prototype.click=function(){this.command.execute()},mindmaps.ToolBarButton.prototype.getTitle=function(){return this.command.label},mindmaps.ToolBarButton.prototype.getToolTip=function(){var e=this.command.description,t=this.command.shortcut;return t&&(Array.isArray(t)&&(t=t.join(", ")),e+=" ["+t.toUpperCase()+"]"),e},mindmaps.ToolBarButton.prototype.getId=function(){return"button-"+this.command.id},mindmaps.ToolBarButton.prototype.asJquery=function(){var e=this,t=$("<button/>",{id:this.getId(),title:this.getToolTip()}).click(function(){e.click()}).button({label:this.getTitle(),disabled:!this.isEnabled()}),n=this.command.icon;return n&&t.button({icons:{primary:n}}),this.setEnabled=function(e){t.button(e?"enable":"disable")},t},mindmaps.ToolBarMenu=function(e,t){var n=this;this.$menuWrapper=$("<span/>",{"class":"menu-wrapper"}).hover(function(){n.$menu.show()},function(){n.$menu.hide()}),this.$menuButton=$("<button/>").button({label:e,icons:{primary:t,secondary:"ui-icon-triangle-1-s"}}).appendTo(this.$menuWrapper),this.$menu=$("<div/>",{"class":"menu"}).click(function(){n.$menu.hide()}).appendTo(this.$menuWrapper),this.add=function(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){var t=e.asJquery().removeClass("ui-corner-all").addClass("menu-item");this.$menu.append(t)},this),this.$menu.children().last().addClass("ui-corner-bottom").prev().removeClass("ui-corner-bottom")},this.getContent=function(){return this.$menuWrapper}},mindmaps.ToolBarPresenter=function(e,t,n,r){function i(e){var n=t.get(e);return new mindmaps.ToolBarButton(n)}function s(e){return e.map(i)}var o=[mindmaps.CreateNodeCommand,mindmaps.DeleteNodeCommand],u=s(o);n.addButtonGroup(u,n.alignLeft);var a=[mindmaps.UndoCommand,mindmaps.RedoCommand],f=s(a);n.addButtonGroup(f,n.alignLeft);var l=[mindmaps.CopyNodeCommand,mindmaps.CutNodeCommand,mindmaps.PasteNodeCommand],c=s(l);n.addButtonGroup(c,n.alignLeft);var h=new mindmaps.ToolBarMenu("Mind map","ui-icon-document"),p=[mindmaps.NewDocumentCommand,mindmaps.OpenDocumentCommand,mindmaps.SaveDocumentCommand,mindmaps.ExportCommand,mindmaps.PrintCommand,mindmaps.CloseDocumentCommand],d=s(p);h.add(d),n.addMenu(h),n.addButton(i(mindmaps.HelpCommand),n.alignRight),this.go=function(){n.init()}};
mindmaps.StatusBarView=function(){var e=this,t=$("#statusbar");this.init=function(){},this.createButton=function(n,r){return $("<button/>",{id:"statusbar-button-"+n}).button({label:r}).click(function(){e.buttonClicked&&e.buttonClicked(n)}).prependTo(t.find(".buttons"))},this.getContent=function(){return t}},mindmaps.StatusBarPresenter=function(e,t){var n=0,r={},i=new mindmaps.StatusNotificationController(e,t.getContent());t.buttonClicked=function(e){r[e].toggle()},this.go=function(){t.init()},this.addEntry=function(e){var i=n++,s=t.createButton(i,e.caption);e.setHideTarget(s),r[i]=e}},mindmaps.StatusNotificationController=function(e,t){var n=$("<div class='notification-anchor'/>").css({position:"absolute",right:20}).appendTo(t);e.subscribe(mindmaps.Event.DOCUMENT_SAVED,function(){var e=new mindmaps.Notification(n,{position:"topRight",expires:2500,content:"Mind map saved"})}),e.subscribe(mindmaps.Event.NOTIFICATION_INFO,function(e){var t=new mindmaps.Notification(n,{position:"topRight",content:e,expires:2500,type:"info"})}),e.subscribe(mindmaps.Event.NOTIFICATION_WARN,function(e){var t=new mindmaps.Notification(n,{position:"topRight",title:"Warning",content:e,expires:3e3,type:"warn"})}),e.subscribe(mindmaps.Event.NOTIFICATION_ERROR,function(e){var t=new mindmaps.Notification(n,{position:"topRight",title:"Error",content:e,expires:3500,type:"error"})})};
mindmaps.CanvasDrawingUtil={getLineWidth:function(e,t){var n=e*(12-t*2);return n<2&&(n=2),n},roundedRect:function(t,n,r,i,s,o){t.beginPath(),t.moveTo(n,r+o),t.lineTo(n,r+s-o),t.quadraticCurveTo(n,r+s,n+o,r+s),t.lineTo(n+i-o,r+s),t.quadraticCurveTo(n+i,r+s,n+i,r+s-o),t.lineTo(n+i,r+o),t.quadraticCurveTo(n+i,r,n+i-o,r),t.lineTo(n+o,r),t.quadraticCurveTo(n,r,n,r+o),t.stroke(),t.fill()}},mindmaps.CanvasBranchDrawer=function(){this.beforeDraw=function(e,t,n,r){},this.render=function(e,t,n,r,i,s,o,u){n*=u,r*=u;var a=s.width(),f=i.width(),l=s.innerHeight(),c=i.innerHeight(),h,p,d=!1,v,m,g,y,b,w=n+f/2<a/2;if(w){var E=Math.abs(n);E>f?(g=E-f+1,v=f,h=!0):(v=-n,g=f+n,h=!1,d=!0)}else n>a?(g=n-a+1,v=a-n,h=!1):(g=a-n,v=0,h=!0,d=!0);var S=mindmaps.CanvasDrawingUtil.getLineWidth(u,t),x=S/2;g<S&&(g=S);var T=r+c<l;T?(m=c,y=s.outerHeight()-r-m,p=!0):(m=l-r,y=i.outerHeight()-m,p=!1),this.beforeDraw(g,y,v,m);var N,C,k,L;h?(N=0,k=g):(N=g,k=0);var A=mindmaps.CanvasDrawingUtil.getLineWidth(u,t-1),O=(A-S)/2;p?(C=0+x,L=y-x-O):(C=y-x,L=0+x+O);if(!d)var M=N>k?N/5:k-k/5,_=L,D=Math.abs(N-k)/2,P=C;else{h?(N+=x,k-=x):(N-=x,k+=x);var D=N,P=Math.abs(C-L)/2,M=k,_=C>L?C/5:L-L/5}e.lineWidth=S,e.strokeStyle=o,e.fillStyle=o,e.beginPath(),e.moveTo(N,C),e.bezierCurveTo(D,P,M,_,k,L),e.stroke();var H=!1;H&&(e.beginPath(),e.fillStyle="red",e.arc(D,P,4,0,Math.PI*2),e.fill(),e.beginPath(),e.fillStyle="green",e.arc(M,_,4,0,Math.PI*2),e.fill())}},mindmaps.TextMetrics=function(){var e=$("<div/>",{"class":"node-text-behaviour"}).css({position:"absolute",visibility:"hidden",height:"auto",width:"auto"}).prependTo($("body"));return{ROOT_CAPTION_MIN_WIDTH:100,NODE_CAPTION_MIN_WIDTH:70,NODE_CAPTION_MAX_WIDTH:150,getTextMetrics:function(t,n,r){n=n||1,r=r||t.getCaption();var i=t.text.font,s=t.isRoot()?this.ROOT_CAPTION_MIN_WIDTH:this.NODE_CAPTION_MIN_WIDTH,o=this.NODE_CAPTION_MAX_WIDTH;e.css({"font-size":n*i.size,"min-width":n*s,"max-width":n*o,"font-weight":i.weight}).text(r);var u=e.width()+2,a=e.height()+2;return{width:u,height:a}}}}();
mindmaps.CanvasView=function(){this.$getDrawingArea=function(){return $("#drawing-area")},this.$getContainer=function(){return $("#canvas-container")},this.center=function(){var e=this.$getContainer(),t=this.$getDrawingArea(),n=t.width()-e.width(),r=t.height()-e.height();this.scroll(n/2,r/2)},this.scroll=function(e,t){var n=this.$getContainer();n.scrollLeft(e).scrollTop(t)},this.applyViewZoom=function(){var e=this.zoomFactorDelta,t=this.$getContainer(),n=t.scrollLeft(),r=t.scrollTop(),i=t.width(),s=t.height(),o=i/2+n,u=s/2+r;o*=this.zoomFactorDelta,u*=this.zoomFactorDelta,n=o-i/2,r=u-s/2;var a=this.$getDrawingArea(),f=a.width(),l=a.height();a.width(f*e).height(l*e),this.scroll(n,r);var c=parseFloat(a.css("background-size"));isNaN(c)&&console.warn("Could not set background-size!"),a.css("background-size",c*e)},this.setDimensions=function(e,t){e*=this.zoomFactor,t*=this.zoomFactor;var n=this.$getDrawingArea();n.width(e).height(t)},this.setZoomFactor=function(e){this.zoomFactorDelta=e/(this.zoomFactor||1),this.zoomFactor=e}},mindmaps.CanvasView.prototype.drawMap=function(e){throw new Error("Not implemented")},mindmaps.DefaultCanvasView=function(){function o(){e.$getContainer().dragscrollable({dragSelector:"#drawing-area, canvas.line-canvas",acceptPropagatedEvent:!1,delegateMode:!0,preventDefault:!0})}function u(e){return $("#node-canvas-"+e.id)}function a(e){return $("#node-"+e.id)}function f(e){return $("#node-caption-"+e.id)}function l(t,n,r,i,o,u,a){var f=t[0],l=f.getContext("2d");s.$canvas=t,s.render(l,n,r,i,o,u,a,e.zoomFactor)}function c(e,t){var n=e.getParent(),r=e.getDepth(),i=e.offset.x,s=e.offset.y;t=t||e.branchColor;var o=a(e),f=a(n),c=u(e);l(c,r,i,s,o,f,t)}function h(e){function s(){n&&t.commit&&t.commit(t.node,r.val())}function o(){setTimeout(function(){e.redrawNodeConnectors(t.node)},1)}var t=this,n=!1,r=$("<textarea/>",{id:"caption-editor","class":"node-text-behaviour"}).bind("keydown","esc",function(){t.stop()}).bind("keydown","return",function(){s()}).mousedown(function(e){e.stopPropagation()}).blur(function(){s()}).bind("input",function(){var n=i.getTextMetrics(t.node,e.zoomFactor,r.val());r.css(n),o()});this.edit=function(o,u){if(n)return;this.node=o,n=!0,this.$text=f(o),this.$cancelArea=u,this.text=this.$text.text(),this.$text.css({width:"auto",height:"auto"}).empty().addClass("edit"),u.bind("mousedown.editNodeCaption",function(e){s()});var a=i.getTextMetrics(t.node,e.zoomFactor,this.text);r.attr({value:this.text}).css(a).appendTo(this.$text).select()},this.stop=function(){n&&(n=!1,this.$text.removeClass("edit"),r.detach(),this.$cancelArea.unbind("mousedown.editNodeCaption"),e.setNodeText(this.node,this.text),o())}}function p(e){var t=this,n=!1;this.node=null,this.lineColor=null;var r=$("<div/>",{id:"creator-wrapper"}).bind("remove",function(e){return t.detach(),e.stopImmediatePropagation(),console.debug("creator detached."),!1}),i=$("<div/>",{id:"creator-nub"}).appendTo(r),s=$("<div/>",{id:"creator-fakenode"}).appendTo(i),o=$("<canvas/>",{id:"creator-canvas","class":"line-canvas"}).hide().appendTo(r);r.draggable({revert:!0,revertDuration:0,start:function(){n=!0,o.show(),t.dragStarted&&(t.lineColor=t.dragStarted(t.node))},drag:function(n,r){var i=r.position.left/e.zoomFactor,u=r.position.top/e.zoomFactor,f=a(t.node);l(o,t.depth+1,i,u,s,f,t.lineColor)},stop:function(i,s){n=!1,o.hide();if(t.dragStopped){var u=r.position(),a=u.left/e.zoomFactor,f=u.top/e.zoomFactor,l=s.position.left/e.zoomFactor,c=s.position.top/e.zoomFactor,h=mindmaps.Util.distance(a-l,f-c);t.dragStopped(t.node,l,c,h)}r.css({left:"",top:""})}}),this.attachToNode=function(t){if(this.node===t)return;this.node=t,r.removeClass("left right"),t.offset.x>0?r.addClass("right"):t.offset.x<0&&r.addClass("left"),this.depth=t.getDepth();var n=e.getLineWidth(this.depth+1);s.css("border-bottom-width",n);var i=a(t);r.appendTo(i)},this.detach=function(){r.detach(),this.node=null},this.isDragging=function(){return n}}var e=this,t=!1,n=new p(this),r=new h(this);r.commit=function(t,n){e.nodeCaptionEditCommitted&&e.nodeCaptionEditCommitted(t,n)};var i=mindmaps.TextMetrics,s=new mindmaps.CanvasBranchDrawer;s.beforeDraw=function(e,t,n,r){this.$canvas.attr({width:e,height:t}).css({left:n,top:r})},this.init=function(){o(),this.center();var t=this.$getDrawingArea();t.addClass("mindmap"),t.delegate("div.node-caption","mousedown",function(t){var n=$(this).parent().data("node");e.nodeMouseDown&&e.nodeMouseDown(n)}),t.delegate("div.node-caption","mouseup",function(t){var n=$(this).parent().data("node");e.nodeMouseUp&&e.nodeMouseUp(n)}),t.delegate("div.node-caption","dblclick",function(t){var n=$(this).parent().data("node");e.nodeDoubleClicked&&e.nodeDoubleClicked(n)}),t.delegate("div.node-container","mouseover",function(t){if(t.target===this){var n=$(this).data("node");e.nodeMouseOver&&e.nodeMouseOver(n)}return!1}),t.delegate("div.node-caption","mouseover",function(t){if(t.target===this){var n=$(this).parent().data("node");e.nodeCaptionMouseOver&&e.nodeCaptionMouseOver(n)}return!1}),this.$getContainer().bind("mousewheel",function(t,n){e.mouseWheeled&&e.mouseWheeled(n)})},this.clear=function(){var e=this.$getDrawingArea();e.children().remove(),e.width(0).height(0)},this.getLineWidth=function(e){return mindmaps.CanvasDrawingUtil.getLineWidth(this.zoomFactor,e)},this.drawMap=function(t){var n=(new Date).getTime(),r=this.$getDrawingArea();r.children().remove();var i=t.root,s=!1;if(s){var o=r.parent();r.detach(),e.createNode(i,r),r.appendTo(o)}else e.createNode(i,r);console.debug("draw map ms: ",(new Date).getTime()-n)},this.createNode=function(n,r,s){var o=n.getParent(),r=r||a(o),s=s||n.getDepth(),f=n.offset.x,c=n.offset.y,h=$("<div/>",{id:"node-"+n.id,"class":"node-container"}).data({node:n}).css({"font-size":n.text.font.size});h.appendTo(r);if(n.isRoot()){var p=this.getLineWidth(s);h.css("border-bottom-width",p)}if(!n.isRoot()){var d=this.getLineWidth(s),v=n.branchColor,m=d+"px solid "+v;h.css({left:this.zoomFactor*f,top:this.zoomFactor*c,"border-bottom":m}),h.one("mouseenter",function(){h.draggable({handle:"div.node-caption:first",start:function(){t=!0},drag:function(t,i){var o=i.position.left/e.zoomFactor,a=i.position.top/e.zoomFactor,f=n.branchColor,c=u(n);l(c,s,o,a,h,r,f),e.nodeDragging&&e.nodeDragging()},stop:function(r,i){t=!1;var s=new mindmaps.Point(i.position.left/e.zoomFactor,i.position.top/e.zoomFactor);e.nodeDragged&&e.nodeDragged(n,s)}})})}var g=n.text.font,y=$("<div/>",{id:"node-caption-"+n.id,"class":"node-caption node-text-behaviour",text:n.text.caption}).css({color:g.color,"font-size":this.zoomFactor*100+"%","font-weight":g.weight,"font-style":g.style,"text-decoration":g.decoration}).appendTo(h),b=i.getTextMetrics(n,this.zoomFactor);y.css(b);var w=r.data("foldButton"),E=n.isRoot()||o.isRoot();!w&&!E&&this.createFoldButton(o);if(!n.isRoot()){o.foldChildren?h.hide():h.show();var S=$("<canvas/>",{id:"node-canvas-"+n.id,"class":"line-canvas"});l(S,s,f,c,h,r,n.branchColor),S.appendTo(h)}n.isRoot()&&h.children().andSelf().addClass("root"),n.forEachChild(function(t){e.createNode(t,h,s+1)})},this.deleteNode=function(e){var t=a(e);t.remove()},this.highlightNode=function(e){var t=f(e);t.addClass("selected")},this.unhighlightNode=function(e){var t=f(e);t.removeClass("selected")},this.closeNode=function(e){var t=a(e);t.children(".node-container").hide();var n=t.children(".button-fold").first();n.removeClass("open").addClass("closed")},this.openNode=function(e){var t=a(e);t.children(".node-container").show();var n=t.children(".button-fold").first();n.removeClass("closed").addClass("open")},this.createFoldButton=function(t){var n=t.offset.x>0?" right":" left",r=t.foldChildren?" closed":" open",i=$("<div/>",{"class":"button-fold no-select"+r+n}).click(function(n){return e.foldButtonClicked&&e.foldButtonClicked(t),n.preventDefault(),!1}),s=a(t);s.data({foldButton:!0}).append(i)},this.removeFoldButton=function(e){var t=a(e);t.data({foldButton:!1}).children(".button-fold").remove()},this.editNodeCaption=function(e){r.edit(e,this.$getDrawingArea())},this.stopEditNodeCaption=function(){r.stop()},this.setNodeText=function(e,t){var n=f(e),r=i.getTextMetrics(e,this.zoomFactor,t);n.css(r).text(t)},this.getCreator=function(){return n},this.isNodeDragging=function(){return t},this.redrawNodeConnectors=function(e){e.isRoot()||c(e),e.isLeaf()||e.forEachChild(function(e){c(e)})},this.updateBranchColor=function(e,t){var n=a(e);n.css("border-bottom-color",t),e.isRoot()||c(e,t)},this.updateFontColor=function(e,t){var n=f(e);n.css("color",t)},this.updateNode=function(e){var t=a(e),n=f(e),r=e.text.font;t.css({"font-size":r.size,"border-bottom-color":e.branchColor});var s=i.getTextMetrics(e,this.zoomFactor);n.css({color:r.color,"font-weight":r.weight,"font-style":r.style,"text-decoration":r.decoration}).css(s),this.redrawNodeConnectors(e)},this.positionNode=function(e){var t=a(e);t.css({left:this.zoomFactor*e.offset.x,top:this.zoomFactor*e.offset.y}),c(e)},this.scaleMap=function(){function l(n,r){var s=a(n),o=e.getLineWidth(r);s.css({left:t*n.offset.x,top:t*n.offset.y,"border-bottom-width":o});var u=f(n);u.css({"font-size":t*100+"%"});var h=i.getTextMetrics(n,e.zoomFactor);u.css(h),c(n),n.isLeaf()||n.forEachChild(function(e){l(e,r+1)})}var t=this.zoomFactor,n=this.$getDrawingArea().children().first(),r=n.data("node"),s=this.getLineWidth(0);n.css("border-bottom-width",s);var o=f(r),u=i.getTextMetrics(r,this.zoomFactor);o.css({"font-size":t*100+"%",left:t*-mindmaps.TextMetrics.ROOT_CAPTION_MIN_WIDTH/2}).css(u),r.forEachChild(function(e){l(e,1)})}},mindmaps.DefaultCanvasView.prototype=new mindmaps.CanvasView;
mindmaps.CanvasPresenter=function(e,t,n,r,i){function f(e){r.setZoomFactor(i.DEFAULT_ZOOM);var t=e.dimensions;r.setDimensions(t.x,t.y);var s=e.mindmap;r.drawMap(s),r.center(),n.selectNode(s.root)}function l(){e.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(e,t){f(e)}),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(e){r.clear()}),e.subscribe(mindmaps.Event.NODE_MOVED,function(e){r.positionNode(e)}),e.subscribe(mindmaps.Event.NODE_TEXT_CAPTION_CHANGED,function(e){r.setNodeText(e,e.getCaption()),r.redrawNodeConnectors(e)}),e.subscribe(mindmaps.Event.NODE_CREATED,function(e){r.createNode(e);if(e.shouldEditCaption){delete e.shouldEditCaption;var t=e.getParent();if(t.foldChildren){var i=new mindmaps.action.OpenNodeAction(t);n.executeAction(i)}n.selectNode(e),o.attachToNode(e),r.editNodeCaption(e)}}),e.subscribe(mindmaps.Event.NODE_DELETED,function(e,t){var i=n.selectedNode;(e===i||e.isDescendant(i))&&n.selectNode(t),r.deleteNode(e),t.isLeaf()&&r.removeFoldButton(t)}),e.subscribe(mindmaps.Event.NODE_SELECTED,a),e.subscribe(mindmaps.Event.NODE_OPENED,function(e){r.openNode(e)}),e.subscribe(mindmaps.Event.NODE_CLOSED,function(e){r.closeNode(e)}),e.subscribe(mindmaps.Event.NODE_FONT_CHANGED,function(e){r.updateNode(e)}),e.subscribe(mindmaps.Event.NODE_FONT_COLOR_PREVIEW,function(e,t){r.updateFontColor(e,t)}),e.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_CHANGED,function(e){r.updateNode(e)}),e.subscribe(mindmaps.Event.NODE_BRANCH_COLOR_PREVIEW,function(e,t){r.updateBranchColor(e,t)}),e.subscribe(mindmaps.Event.ZOOM_CHANGED,function(e){r.setZoomFactor(e),r.applyViewZoom(),r.scaleMap()})}var s=this,o=r.getCreator();this.init=function(){var e=t.get(mindmaps.EditNodeCaptionCommand);e.setHandler(this.editNodeCaption.bind(this));var n=t.get(mindmaps.ToggleNodeFoldedCommand);n.setHandler(u)},this.editNodeCaption=function(e){e||(e=n.selectedNode),r.editNodeCaption(e)};var u=function(e){e||(e=n.selectedNode);var t=new mindmaps.action.ToggleNodeFoldAction(e);n.executeAction(t)},a=function(e,t){t&&r.unhighlightNode(t),r.highlightNode(e)};r.mouseWheeled=function(e){r.stopEditNodeCaption(),e>0?i.zoomIn():i.zoomOut()},r.nodeMouseOver=function(e){!r.isNodeDragging()&&!o.isDragging()&&o.attachToNode(e)},r.nodeCaptionMouseOver=function(e){!r.isNodeDragging()&&!o.isDragging()&&o.attachToNode(e)},r.nodeMouseDown=function(e){n.selectNode(e),o.attachToNode(e)},r.nodeDoubleClicked=function(e){r.editNodeCaption(e)},r.nodeDragged=function(e,t){var r=new mindmaps.action.MoveNodeAction(e,t);n.executeAction(r)},r.foldButtonClicked=function(e){u(e)},o.dragStarted=function(e){var t=e.isRoot()?mindmaps.Util.randomColor():e.branchColor;return t},o.dragStopped=function(e,t,r,i){if(i<50)return;var s=new mindmaps.Node;s.branchColor=o.lineColor,s.offset=new mindmaps.Point(t,r),s.shouldEditCaption=!0,n.createNode(s,e)},r.nodeCaptionEditCommitted=function(e,t){var t=$.trim(t);if(!t)return;r.stopEditNodeCaption(),n.changeNodeCaption(e,t)},this.go=function(){r.init()},l(),this.init()};
mindmaps.ApplicationController=function(){function l(){var t=i.getDocument();h();var n=new mindmaps.NewDocumentPresenter(e,i,new mindmaps.NewDocumentView);n.go()}function c(){var t=new mindmaps.SaveDocumentPresenter(e,i,new mindmaps.SaveDocumentView,a,f);t.go()}function h(){var e=i.getDocument();e&&i.setDocument(null)}function p(){var t=new mindmaps.OpenDocumentPresenter(e,i,new mindmaps.OpenDocumentView,f);t.go()}function d(){var t=new mindmaps.ExportMapPresenter(e,i,new mindmaps.ExportMapView);t.go()}var e=new mindmaps.EventBus,t=new mindmaps.ShortcutController,n=new mindmaps.CommandRegistry(t),r=new mindmaps.UndoController(e,n),i=new mindmaps.MindMapModel(e,n,r),s=new mindmaps.ClipboardController(e,n,i),o=new mindmaps.HelpController(e,n),u=new mindmaps.PrintController(e,n,i),a=new mindmaps.AutoSaveController(e,i),f=new mindmaps.FilePicker(e,i);this.init=function(){var t=n.get(mindmaps.NewDocumentCommand);t.setHandler(l),t.setEnabled(!0);var r=n.get(mindmaps.OpenDocumentCommand);r.setHandler(p),r.setEnabled(!0);var i=n.get(mindmaps.SaveDocumentCommand);i.setHandler(c);var s=n.get(mindmaps.CloseDocumentCommand);s.setHandler(h);var o=n.get(mindmaps.ExportCommand);o.setHandler(d),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){i.setEnabled(!1),s.setEnabled(!1),o.setEnabled(!1)}),e.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){i.setEnabled(!0),s.setEnabled(!0),o.setEnabled(!0)})},this.go=function(){var t=new mindmaps.MainViewController(e,i,n);t.go(),l()},this.init()};
mindmaps.MindMapModel=function(e,t,n){var r=this;this.document=null,this.selectedNode=null,this.getDocument=function(){return this.document},this.setDocument=function(t){this.document=t,t?e.publish(mindmaps.Event.DOCUMENT_OPENED,t):e.publish(mindmaps.Event.DOCUMENT_CLOSED)},this.getMindMap=function(){return this.document?this.document.mindmap:null},this.init=function(){var n=t.get(mindmaps.CreateNodeCommand);n.setHandler(this.createNode.bind(this));var r=t.get(mindmaps.CreateSiblingNodeCommand);r.setHandler(this.createSiblingNode.bind(this));var i=t.get(mindmaps.DeleteNodeCommand);i.setHandler(this.deleteNode.bind(this)),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){n.setEnabled(!1),r.setEnabled(!1),i.setEnabled(!1)}),e.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){n.setEnabled(!0),r.setEnabled(!0),i.setEnabled(!0)})},this.deleteNode=function(e){e||(e=this.selectedNode);var t=this.getMindMap(),n=new mindmaps.action.DeleteNodeAction(e,t);this.executeAction(n)},this.createNode=function(e,t){var n=this.getMindMap();if(!e||!t){t=this.selectedNode;var r=new mindmaps.action.CreateAutoPositionedNodeAction(t,n)}else var r=new mindmaps.action.CreateNodeAction(e,t,n);this.executeAction(r)},this.createSiblingNode=function(){var e=this.getMindMap(),t=this.selectedNode,n=t.getParent();if(n===null)return;var r=new mindmaps.action.CreateAutoPositionedNodeAction(n,e);this.executeAction(r)},this.selectNode=function(t){if(t===this.selectedNode)return;var n=this.selectedNode;this.selectedNode=t,e.publish(mindmaps.Event.NODE_SELECTED,t,n)},this.changeNodeCaption=function(e,t){e||(e=this.selectedNode);var n=new mindmaps.action.ChangeNodeCaptionAction(e,t);this.executeAction(n)},this.executeAction=function(t){if(t instanceof mindmaps.action.CompositeAction){var i=this.executeAction.bind(this);t.forEachAction(i);return}var s=t.execute();if(s!==undefined&&!s)return!1;t.event&&(Array.isArray(t.event)||(t.event=[t.event]),e.publish.apply(e,t.event));if(t.undo){var o=function(){r.executeAction(t.undo())};if(t.redo)var u=function(){r.executeAction(t.redo())};n.addUndo(o,u)}},this.saveToLocalStorage=function(){var t=this.document.prepareSave(),n=mindmaps.LocalDocumentStorage.saveDocument(t);return n&&e.publish(mindmaps.Event.DOCUMENT_SAVED,t),n},this.init()};
mindmaps.NewDocumentView=function(){},mindmaps.NewDocumentPresenter=function(e,t,n){this.go=function(){var e=new mindmaps.Document;t.setDocument(e)}};
mindmaps.OpenDocumentView=function(){var e=this,t=$("#template-open").tmpl().dialog({autoOpen:!1,modal:!0,zIndex:5e3,width:550,close:function(){$(this).dialog("destroy"),$(this).remove()}}),n=$("#button-open-cloud").button().click(function(){e.openCloudButtonClicked&&e.openCloudButtonClicked()});t.find(".file-chooser input").bind("change",function(t){e.openExernalFileClicked&&e.openExernalFileClicked(t)});var r=t.find(".localstorage-filelist");r.delegate("a.title","click",function(){if(e.documentClicked){var t=$(this).tmplItem();e.documentClicked(t.data)}}).delegate("a.delete","click",function(){if(e.deleteDocumentClicked){var t=$(this).tmplItem();e.deleteDocumentClicked(t.data)}}),this.render=function(e){var n=$(".document-list",t).empty();$("#template-open-table-item").tmpl(e,{format:function(e){if(!e)return"";var t=e.getDate(),n=e.getMonth()+1,r=e.getFullYear();return t+"/"+n+"/"+r}}).appendTo(n)},this.showOpenDialog=function(e){this.render(e),t.dialog("open")},this.hideOpenDialog=function(){t.dialog("close")},this.showCloudError=function(e){t.find(".cloud-loading").removeClass("loading"),t.find(".cloud-error").text(e)},this.showCloudLoading=function(){t.find(".cloud-error").text(""),t.find(".cloud-loading").addClass("loading")},this.hideCloudLoading=function(){t.find(".cloud-loading").removeClass("loading")}},mindmaps.OpenDocumentPresenter=function(e,t,n,r){n.openCloudButtonClicked=function(e){mindmaps.Util.trackEvent("Clicks","cloud-open"),r.open({load:function(){n.showCloudLoading()},success:function(){n.hideOpenDialog()},error:function(e){n.showCloudError(e)}})},n.openExernalFileClicked=function(r){mindmaps.Util.trackEvent("Clicks","hdd-open");var i=r.target.files,s=i[0],o=new FileReader;o.onload=function(){try{var r=mindmaps.Document.fromJSON(o.result)}catch(i){throw e.publish(mindmaps.Event.NOTIFICATION_ERROR,"File is not a valid mind map!"),new Error("Error while opening map from hdd",i)}t.setDocument(r),n.hideOpenDialog()},o.readAsText(s)},n.documentClicked=function(e){mindmaps.Util.trackEvent("Clicks","localstorage-open"),t.setDocument(e),n.hideOpenDialog()},n.deleteDocumentClicked=function(e){mindmaps.LocalDocumentStorage.deleteDocument(e);var t=mindmaps.LocalDocumentStorage.getDocuments();n.render(t)},this.go=function(){var e=mindmaps.LocalDocumentStorage.getDocuments();e.sort(mindmaps.Document.sortByModifiedDateDescending),n.showOpenDialog(e)}};
mindmaps.SaveDocumentView=function(){var e=this,t=$("#template-save").tmpl().dialog({autoOpen:!1,modal:!0,zIndex:5e3,width:550,close:function(){$(this).dialog("destroy"),$(this).remove()}}),n=$("#button-save-cloudstorage").button().click(function(){e.cloudStorageButtonClicked&&e.cloudStorageButtonClicked()}),r=$("#button-save-localstorage").button().click(function(){e.localStorageButtonClicked&&e.localStorageButtonClicked()}),i=$("#checkbox-autosave-localstorage").click(function(){e.autoSaveCheckboxClicked&&e.autoSaveCheckboxClicked($(this).prop("checked"))}),s=$("#button-save-hdd").button().downloadify({filename:function(){if(e.fileNameRequested)return e.fileNameRequested()},data:function(){if(e.fileContentsRequested)return e.fileContentsRequested()},onComplete:function(){e.saveToHddComplete&&e.saveToHddComplete()},onError:function(){console.log("error while saving to hdd")},swf:"media/downloadify.swf",downloadImage:"img/transparent.png",width:65,height:29,append:!0});this.setAutoSaveCheckboxState=function(e){i.prop("checked",e)},this.showSaveDialog=function(){t.dialog("open")},this.hideSaveDialog=function(){t.dialog("close")},this.showCloudError=function(e){t.find(".cloud-error").text(e)}},mindmaps.SaveDocumentPresenter=function(e,t,n,r,i){n.cloudStorageButtonClicked=function(){mindmaps.Util.trackEvent("Clicks","cloud-save"),i.save({success:function(){n.hideSaveDialog()},error:function(e){n.showCloudError(e)}})},n.localStorageButtonClicked=function(){mindmaps.Util.trackEvent("Clicks","localstorage-save");var r=t.saveToLocalStorage();r?n.hideSaveDialog():e.publish(mindmaps.Event.NOTIFICATION_ERROR,"Error while saving to local storage")},n.autoSaveCheckboxClicked=function(e){e?r.enable():r.disable()},n.fileNameRequested=function(){return mindmaps.Util.trackEvent("Clicks","hdd-save"),t.getMindMap().getRoot().getCaption()+".json"},n.fileContentsRequested=function(){var e=t.getDocument();return e.prepareSave().serialize()},n.saveToHddComplete=function(){var r=t.getDocument();e.publish(mindmaps.Event.DOCUMENT_SAVED,r),n.hideSaveDialog()},this.go=function(){n.setAutoSaveCheckboxState(r.isEnabled()),n.showSaveDialog()}};
mindmaps.CanvasContainer=function(){var e=this,t=$("#canvas-container");this.getContent=function(){return t},this.setSize=function(){var n=$(window).height(),r=$("#topbar").outerHeight(!0),i=$("#bottombar").outerHeight(!0),s=n-r-i;t.height(s);var o=new mindmaps.Point(t.width(),s);e.publish(mindmaps.CanvasContainer.Event.RESIZED,o)},this.acceptFileDrop=function(){function n(e){e.originalEvent.stopPropagation(),e.originalEvent.preventDefault()}function r(e){n(e)}function i(t){n(t);var r=t.originalEvent.dataTransfer.files,i=r[0],s=new FileReader;s.onload=function(){e.receivedFileDrop(s.result)},s.readAsText(i)}t.bind("dragover",r),t.bind("drop",i)},this.init=function(){$(window).resize(function(){e.setSize()}),this.setSize(),this.acceptFileDrop()},this.receivedFileDrop=function(e){}},EventEmitter.mixin(mindmaps.CanvasContainer),mindmaps.CanvasContainer.Event={RESIZED:"ResizedEvent"},mindmaps.MainViewController=function(e,t,n){var r=new mindmaps.ZoomController(e,n),i=new mindmaps.CanvasContainer;i.receivedFileDrop=function(n){try{var r=mindmaps.Document.fromJSON(n);t.setDocument(r)}catch(i){e.publish(mindmaps.Event.NOTIFICATION_ERROR,"Could not read the file."),console.warn("Could not open the mind map via drag and drop.")}},this.go=function(){i.init();var s=new mindmaps.ToolBarView,o=new mindmaps.ToolBarPresenter(e,n,s,t);o.go();var u=new mindmaps.DefaultCanvasView,a=new mindmaps.CanvasPresenter(e,n,t,u,r);a.go();var f=new mindmaps.StatusBarView,l=new mindmaps.StatusBarPresenter(e,f);l.go();var c=new mindmaps.FloatPanelFactory(i),h=new mindmaps.InspectorView,p=new mindmaps.InspectorPresenter(e,t,h);p.go();var d=c.create("Inspector",h.getContent());d.show(),l.addEntry(d);var v=new mindmaps.NavigatorView,m=new mindmaps.NavigatorPresenter(e,v,i,r);m.go();var g=c.create("Navigator",v.getContent());g.show(),l.addEntry(g)}};
mindmaps.LocalStorage=function(){return{put:function(e,t){localStorage.setItem(e,t)},get:function(e){return localStorage.getItem(e)},clear:function(){localStorage.clear()}}}(),mindmaps.SessionStorage=function(){return{put:function(e,t){sessionStorage.setItem(e,t)},get:function(e){return sessionStorage.getItem(e)},clear:function(){sessionStorage.clear()}}}(),mindmaps.LocalDocumentStorage=function(){var e="mindmaps.document.",t=function(e){var t=localStorage.getItem(e);if(t===null)return null;try{return mindmaps.Document.fromJSON(t)}catch(n){return console.error("Error while loading document from local storage",n),null}};return{saveDocument:function(t){try{return localStorage.setItem(e+t.id,t.serialize()),!0}catch(n){return console.error("Error while saving document to local storage",n),!1}},loadDocument:function(n){return t(e+n)},getDocuments:function(){var n=[];for(var r=0,i=localStorage.length;r<i;r++){var s=localStorage.key(r);if(s.indexOf(e)==0){var o=t(s);o&&n.push(o)}}return n},getDocumentIds:function(){var t=[];for(var n=0,r=localStorage.length;n<r;n++){var i=localStorage.key(n);i.indexOf(e)==0&&t.push(i.substring(e.length))}return t},deleteDocument:function(t){localStorage.removeItem(e+t.id)},deleteAllDocuments:function(){this.getDocuments().forEach(this.deleteDocument)}}}();
mindmaps.Event={DOCUMENT_OPENED:"DocumentOpenedEvent",DOCUMENT_SAVED:"DocumentSavedEvent",DOCUMENT_CLOSED:"DocumentClosedEvent",NODE_SELECTED:"NodeSelectedEvent",NODE_DESELECTED:"NodeDeselectedEvent",NODE_MOVED:"NodeMovedEvent",NODE_TEXT_CAPTION_CHANGED:"NodeTextCaptionChangedEvent",NODE_FONT_CHANGED:"NodeFontChangedEvent",NODE_FONT_COLOR_PREVIEW:"NodeFontColorPreviewEvent",NODE_BRANCH_COLOR_CHANGED:"NodeBranchColorChangedEvent",NODE_BRANCH_COLOR_PREVIEW:"NodeBranchColorPreviewEvent",NODE_CREATED:"NodeCreatedEvent",NODE_DELETED:"NodeDeletedEvent",NODE_OPENED:"NodeOpenedEvent",NODE_CLOSED:"NodeClosedEvent",ZOOM_CHANGED:"ZoomChangedEvent",NOTIFICATION_INFO:"NotificationInfoEvent",NOTIFICATION_WARN:"NotificationWarnEvent",NOTIFICATION_ERROR:"NotificationErrorEvent"},mindmaps.EventBus=EventEmitter;if(mindmaps.DEBUG){var old=mindmaps.EventBus.prototype.emit;mindmaps.EventBus.prototype.publish=function(e){var t=this.listeners(e).length;console.log("EventBus > publish: "+e,"(Listeners: "+t+")"),old.apply(this,arguments)}};
mindmaps.Notification=function(e,t){var n=this;t=$.extend({},mindmaps.Notification.Defaults,t);var r=this.$el=$("#template-notification").tmpl(t).css({"max-width":t.maxWidth}).addClass(t.type),i=$(e);if(i.length===0)return this;var s=i.offset(),o=s.left,u=s.top,a=i.outerWidth(),f=i.outerHeight();r.appendTo($("body"));var l=r.outerWidth(),c=r.outerHeight(),h,p,d=t.padding;switch(t.position){case"topLeft":p=u-d-c,h=o;break;case"topMiddle":p=u-d-c,l<a?h=o+(a-l)/2:h=o-(l-a)/2;break;case"topRight":p=u-d-c,h=o+a-l;break;case"rightTop":p=u;break;case"rightMiddle":c<f?p=u+(f-c)/2:p=u-(c-f)/2,h=o+d+a;break;case"rightBottom":p=u+f-c,h=o+d+a;break;case"bottomLeft":p=u+d+f,h=o;break;case"bottomMiddle":p=u+d+f,l<a?h=o+(a-l)/2:h=o-(l-a)/2;break;case"bottomRight":p=u+d+f,h=o+a-l;break;case"leftTop":p=u,h=o-d-l;break;case"leftMiddle":c<f?p=u+(f-c)/2:p=u-(c-f)/2,h=o-d-l;break;case"leftBottom":p=u+f-c,h=o-d-l}r.offset({left:h,top:p}),t.expires&&setTimeout(function(){n.close()},t.expires),t.closeButton&&r.find(".close-button").click(function(){n.close()}),r.fadeIn(600)},mindmaps.Notification.prototype={close:function(){var e=this.$el;e.fadeOut(800,function(){e.remove(),this.removed=!0})},isVisible:function(){return!this.removed},$:function(){return this.$el}},mindmaps.Notification.Defaults={title:null,content:"New Notification",position:"topLeft",padding:10,expires:0,closeButton:!1,maxWidth:500,type:"info"};
mindmaps.StaticCanvasRenderer=function(){function o(e,n){i.save(),s.render(i,e.getDepth(),e.offset.x,e.offset.y,e,n,e.branchColor,t),i.restore()}function u(n){function i(n){var r=mindmaps.CanvasDrawingUtil.getLineWidth(t,n.getDepth()),s=mindmaps.TextMetrics.getTextMetrics(n,t),o={lineWidth:r,textMetrics:s,width:function(){return n.isRoot()?0:s.width},innerHeight:function(){return s.height+e},outerHeight:function(){return s.height+r+e}};$.extend(n,o),n.forEachChild(function(e){i(e)})}var r=n.getRoot().clone();return i(r),r}function a(e){function u(e){var t=e.getPosition(),o=e.textMetrics;t.x<n&&(n=t.x),t.x+o.width>i&&(i=t.x+o.width),t.y<r&&(r=t.y),t.y+e.outerHeight()>s&&(s=t.y+e.outerHeight())}var t=e.getPosition(),n=0,r=0,i=0,s=0,o=50;u(e),e.forEachDescendant(function(e){u(e)});var a=Math.max(Math.abs(i),Math.abs(n)),f=Math.max(Math.abs(s),Math.abs(r));return{width:2*a+o,height:2*f+o}}function f(t){function h(t,n){i.save();var r=t.offset.x,s=t.offset.y;i.translate(r,s),n&&o(t,n);if(!t.isRoot()){i.fillStyle=t.branchColor;var u=t.textMetrics;i.fillRect(0,u.height+e,u.width,t.lineWidth)}t.forEachChild(function(e){h(e,t)}),i.restore()}function p(e){function f(e){var t=i.measureText(e);return t.width<=r.width}i.save();var t=e.offset.x,n=e.offset.y;i.translate(t,n);var r=e.textMetrics,s=e.getCaption(),o=e.text.font;i.font=o.style+" "+o.weight+" "+o.size+"px sans-serif";var u=r.width/2,a=0;e.isRoot()&&(u=0,a=20,i.lineWidth=5,i.strokeStyle="orange",i.fillStyle="white",mindmaps.CanvasDrawingUtil.roundedRect(i,0-r.width/2-4,16,r.width+8,r.height+8,10)),i.strokeStyle=o.color,i.fillStyle=o.color;if(f(s))i.fillText(s,u,a);else{var l=/[^ ]+ */gi,c=s.match(l);console.log("words1",c);var h=[];c.forEach(function(e){if(!f(e)){var t="";for(var n=0;n<e.length;n++){var r=e.charAt(n);if(f(t+r)){t+=r;continue}h.push(t),t=r}h.push(t)}else h.push(e)}),console.log("words2",h);var d=function(e){return i.measureText(e).width},v=[],m="",g=r.width;h.forEach(function(e){m===""?m=e:d(m+" "+e)>g?(v.push(m),m=e):m+=" "+e}),v.push(m),console.log("lines",v);for(var y=0;y<v.length;y++){var m=v[y];i.fillText(m,u,a+y*o.size)}}e.forEachChild(function(e){p(e)}),i.restore()}var n=t.mindmap,s=u(n),f=a(s),l=f.width,c=f.height;r.attr({width:l,height:c}),i.textBaseline="top",i.textAlign="center",i.fillStyle="white",i.fillRect(0,0,l,c),i.translate(l/2,c/2),h(s),p(s)}var e=8,t=1,n=this,r=$("<canvas/>",{"class":"map"}),i=r[0].getContext("2d"),s=new mindmaps.CanvasBranchDrawer;s.beforeDraw=function(e,t,n,r){i.translate(n,r)},this.getImageData=function(e){return f(e),r[0].toDataURL("image/png")},this.renderAsPNG=function(e){var t=this.getImageData(e),n=$("<img/>",{src:t,"class":"map"});return n},this.renderAsCanvas=function(e){return f(e),r}};
mindmaps.PrintController=function(e,t,n){function s(){var e=i.renderAsPNG(n.getDocument());$("#print-area").html(e),window.print()}var r=t.get(mindmaps.PrintCommand);r.setHandler(s);var i=new mindmaps.StaticCanvasRenderer;e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,function(){r.setEnabled(!1)}),e.subscribe(mindmaps.Event.DOCUMENT_OPENED,function(){r.setEnabled(!0)})};
mindmaps.ExportMapView=function(){var e=this,t=$("#template-export-map").tmpl().dialog({autoOpen:!1,modal:!0,zIndex:5e3,width:"auto",height:"auto",close:function(){$(this).dialog("destroy"),$(this).remove()},open:function(){$(this).css({"max-width":$(window).width()*.9,"max-height":$(window).height()*.8}),t.dialog("option","position","center")},buttons:{Ok:function(){$(this).dialog("close")}}});this.showDialog=function(){t.dialog("open")},this.hideDialog=function(){t.dialog("close")},this.setImage=function(e){$("#export-preview").html(e)}},mindmaps.ExportMapPresenter=function(e,t,n){var r=new mindmaps.StaticCanvasRenderer;this.go=function(){var e=r.renderAsPNG(t.getDocument());n.setImage(e),setTimeout(function(){n.showDialog()},30)}};
mindmaps.AutoSaveController=function(e,t){function i(){console.debug("Autosaving..."),t.saveToLocalStorage()}function s(){r||(r=setInterval(i,n))}function o(){r&&(clearInterval(r),r=null)}var n=6e4,r=null;this.enable=function(){s(),t.getDocument().setAutoSave(!0)},this.disable=function(){o(),t.getDocument().setAutoSave(!1)},this.isEnabled=function(){return t.getDocument().isAutoSave()},this.init=function(){e.subscribe(mindmaps.Event.DOCUMENT_OPENED,this.documentOpened.bind(this)),e.subscribe(mindmaps.Event.DOCUMENT_CLOSED,this.documentClosed.bind(this))},this.documentOpened=function(e){this.isEnabled()&&s()},this.documentClosed=function(){o()},this.init()};
mindmaps.FilePicker=function(e,t){if(window.filepicker){var n=window.filepicker;n.setKey("P9tQ4bicRwyIe8ZUsny5");var r="application/json",i={modal:!0,services:[n.SERVICES.GOOGLE_DRIVE,n.SERVICES.DROPBOX,n.SERVICES.BOX,n.SERVICES.URL]},s={modal:!0,services:[n.SERVICES.GOOGLE_DRIVE,n.SERVICES.DROPBOX,n.SERVICES.BOX]}}this.open=function(s){s=s||{};if(!n||!navigator.onLine){s.error&&s.error("Cannot access cloud, it appears you are offline.");return}n.getFile(r,i,function(n,r){s.load&&s.load(),$.ajax({url:n,success:function(n){try{Object.prototype.toString.call(n)=="[object String]"&&(n=JSON.parse(n));var r=mindmaps.Document.fromObject(n)}catch(i){throw e.publish(mindmaps.Event.NOTIFICATION_ERROR,"File is not a valid mind map!"),new Error("Error while parsing map from cloud",i)}t.setDocument(r),s.success&&s.success(r)},error:function(e,t,n){throw s.error&&s.error("Error: Could not open mind map!"),new Error("Error while loading map from filepicker. "+t+" "+n)}})})},this.save=function(i){i=i||{};if(!n||!navigator.onLine){i.error&&i.error("Cannot access cloud, it appears you are offline.");return}var o=t.getDocument(),u=o.prepareSave().serialize(),a=function(t){console.log("saved to:",t),e.publish(mindmaps.Event.DOCUMENT_SAVED,o),i.success&&i.success()};n.getUrlFromData(u,function(e){n.saveAs(e,r,s,a)})}};